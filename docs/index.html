<!DOCTYPE html>
<html lang="vi">
<head>
  <!-- v2.5.6: L·ªõp 3 ‚Äì th√™m B√†i 3 (M√°y t√≠nh v√† em) + ch√®n h√¨nh minh h·ªça (B√†i 3 C6, C8, C15; B√†i 2 C15); no other modules touched. -->
  <!-- v2.5.3: Vietnamese-only TTS override appended. Modules unchanged. -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G·∫•u Con H·ªçc Tin H·ªçc</title>
    <link rel="shortcut icon" href="data/images/logo.jpg" type="image/jpeg">
    <!-- T·∫£i Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Th√™m th∆∞ vi·ªán √¢m thanh Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <!-- Th√™m font Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* CSS t√πy ch·ªânh */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* T√πy ch·ªânh thanh cu·ªôn */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #a0aec0; }

        /* --- Hi·ªáu ·ª©ng chung --- */
        .btn-hover {
            transition: all 0.2s ease-in-out;
        }
        .btn-hover:hover {
            transform: scale(1.03); /* Ph√≥ng to nh·∫π */
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.15); /* ƒê·ªï b√≥ng */
        }
        .btn-hover:active {
            transform: scale(0.98); /* Thu nh·ªè khi nh·∫•n */
        }

        /* --- CSS cho n√∫t ch·ªçn l·ªõp --- */
        .grade-btn {
            background-color: white;
            color: #374151; /* text-gray-700 */
            border: 2px solid white;
            font-weight: 700; /* bold */
            font-size: 1.25rem; /* text-xl */
            border-radius: 1.5rem; /* rounded-3xl */
            padding: 1.25rem; /* p-5 */
            text-align: center;
        }
        .grade-btn.active-grade {
            /* N√∫t ƒë∆∞·ª£c ch·ªçn */
            background-color: #3B82F6; /* bg-blue-600 */
            color: white;
            border-color: #60A5FA; /* border-blue-400 */
            box-shadow: 0 8px 15px -3px rgba(59, 130, 246, 0.4);
        }
        
        /* --- CSS cho n√∫t menu ch√≠nh --- */
        .menu-btn {
            color: white;
            font-weight: 700; /* bold */
            font-size: 1.125rem; /* text-lg */
            border-radius: 1.5rem; /* rounded-3xl */
            padding: 1.5rem; /* p-6 */
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1.4;
        }
        .menu-btn svg, .menu-btn .icon-emoji {
            width: 2.5rem; /* w-10 */
            height: 2.5rem; /* h-10 */
            margin-bottom: 0.75rem; /* mb-3 */
            font-size: 2.5rem; /* C·ª° cho emoji */
            line-height: 1;
        }
        
        /* CSS cho Game ƒêua Xe */
        #race-track {
            background-image: repeating-linear-gradient(
                -45deg,
                #f3f4f6,
                #f3f4f6 10px,
                #e5e7eb 10px,
                #e5e7eb 20px
            );
            border-bottom: 5px dashed #9ca3af;
            position: relative;
        }
        .racer {
            font-size: 3rem; /* 48px */
            transition: transform 0.5s ease-in-out;
            position: absolute;
            bottom: 0;
            left: 0;
        }
        .finish-line {
            font-size: 3rem;
            position: absolute;
            right: 10px;
            bottom: -10px;
        }

        /* T√πy ch·ªânh cho khung video */
        .aspect-video {
            aspect-ratio: 16 / 9;
        }
        
        /* (M·ªöI) Hi·ªáu ·ª©ng L·∫Øc cho th·∫ª quiz */
        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-10px); } 50% { transform: translateX(10px); } 75% { transform: translateX(-10px); } 100% { transform: translateX(0); } }
        .shake { animation: shake 0.5s ease-in-out; }
    
        /* (M·ªöI V2.4) CSS cho Timer */
        .timer-btn { background-color: white; border: 2px solid #3B82F6; color: #3B82F6; }
        .timer-btn.active-timer { background-color: #3B82F6; color: white; }
        @keyframes flash-red { 50% { background-color: #ef4444; color: white; } }
        .flash-warning { animation: flash-red 1s infinite; }

    
/* === Home tiles balance & sizing (v2.5.1 UI tune) === */
:root {
  --home-tile-h: clamp(140px, 19vw, 200px);
  --home-grade-h: clamp(80px, 10vw, 110px);
}
#page-home .menu-btn {
  min-height: var(--home-tile-h);
}
#page-home .grade-btn {
  min-height: var(--home-grade-h);
}
#page-home .menu-btn .icon-emoji,
#page-home .menu-btn svg {
  font-size: clamp(32px, 5vw, 48px);
  width: auto;
  height: auto;
}
/* Ensure equal spacing & full width */
#page-home .flex.flex-col.space-y-6 > .menu-btn,
#page-home .flex.flex-col.space-y-5 > .grade-btn {
  width: 100%;
}
/* Slightly larger title on desktop */
@media (min-width: 1024px){
  #page-home h1 { font-size: 3.25rem; line-height: 1.1; }
}

/* === v2.5.3: Tick + Glow for True/False === */
@keyframes tickPop { 0% {opacity:0; transform: translate(-50%,-50%) scale(0.6);} 30% {opacity:1; transform: translate(-50%,-50%) scale(1);} 100% {opacity:0; transform: translate(-50%,-50%) scale(1.1);} }.click-tick {
  position: absolute; width: 36px; height: 36px; border-radius: 9999px;
  background: #22c55e; color: #fff; display: flex; align-items: center; justify-content: center;
  border: 2px solid #fff;
  box-shadow: 0 10px 26px rgba(34,197,94,.45); pointer-events: none;
  transform: translate(-50%,-50%) scale(0.9); opacity: 0; animation: tickPop 1400ms ease-out forwards;
  font-weight: 900; font-size: 18px; line-height: 1;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, 'Helvetica Neue', Arial, 'Apple Color Emoji', 'Segoe UI Emoji';
}
@keyframes rowGlow { 
  0% { box-shadow: 0 0 0 0 rgba(34,197,94,.7); background-color: #ecfdf5; } 
  100% { box-shadow: 0 0 22px 8px rgba(34,197,94,0); background-color: #ffffff; } 
}.row-glow { animation: rowGlow 900ms ease-out 1; }

/* v2.5.3b: persistent highlight for a chosen row */
.row-selected { background-color: #ecfdf5 !important; }

/* v2.5.3c: persistent tick */
@keyframes tickPopIn { 0% {opacity:0; transform: translate(-50%,-50%) scale(0.6);} 70% {opacity:1; transform: translate(-50%,-50%) scale(1.05);} 100% {opacity:1; transform: translate(-50%,-50%) scale(1);} }
.click-tick-fixed {
  position: absolute; width: 28px; height: 28px; border-radius: 9999px;
  background: #22c55e; color: #fff; display: flex; align-items: center; justify-content: center;
  border: 2px solid #fff; box-shadow: 0 8px 20px rgba(34,197,94,.35); pointer-events: none;
  transform: translate(-50%,-50%); opacity: 1; animation: tickPopIn 260ms ease-out forwards;
  font-weight: 900; font-size: 16px; line-height: 1;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, 'Helvetica Neue', Arial, 'Apple Color Emoji', 'Segoe UI Emoji';
}

/* === v2.5.4: Matching links visuals (animated) === */
@keyframes drawLine { to { stroke-dashoffset: 0; } }
.match-line { stroke:#7c3aed; stroke-width:4; stroke-linecap:round; filter: drop-shadow(0 2px 6px rgba(124,58,237,.35)); }
.match-line-new { stroke-dasharray: 400; stroke-dashoffset: 400; animation: drawLine .6s ease-out forwards; }
.match-dot { fill:#7c3aed; stroke:#fff; stroke-width:2; }
</style>

    <!-- Kids-friendly font for chatbot -->
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400..800&display=swap" rel="stylesheet">
    <style>
      /* === Chatbot UI (v2.7 kids) === */
      .kids-font { font-family: 'Baloo 2', system-ui, -apple-system, 'Segoe UI', Roboto, Inter, sans-serif; }
      #gau-chat-toggle { position: fixed; right: 18px; bottom: 18px; z-index: 60; }
      #gau-chat-panel {
        position: fixed; left: 50%; transform: translateX(-50%);
        bottom: 90px; width: min(860px, 92vw); max-height: min(68vh, 620px);
        background: white; border-radius: 24px; box-shadow: 0 20px 60px rgba(20, 60, 120, .18);
        border: 1px solid rgba(2, 6, 23, .06);
        display: none; overflow: clip; z-index: 60;
      }
      #gau-chat-header { display: flex; align-items: center; justify-content: space-between; padding: 14px 16px;
        background: linear-gradient(90deg, #e0f2fe, #fde68a); border-bottom: 1px solid rgba(2,6,23,.06); }
      #gau-chat-title { display: flex; align-items: center; gap: 10px; font-weight: 800; color: #1d4ed8; }
      #gau-chat-stream { padding: 16px; height: clamp(240px, 48vh, 520px); overflow: auto; background: #f8fafc; }
      .gau-msg { display: flex; gap: 10px; margin: 10px 0; }
      .gau-msg.me { justify-content: flex-end; }
      .gau-bubble {
        max-width: 78%; padding: 10px 14px; border-radius: 18px; font-size: 15px; line-height: 1.5;
        box-shadow: 0 6px 18px rgba(2, 6, 23, .06);
      }
      .gau-msg .me-bubble { background: #3b82f6; color: white; border-bottom-right-radius: 6px; }
      .gau-msg .ai-bubble { background: white; color: #0f172a; border-bottom-left-radius: 6px; border: 1px solid rgba(2,6,23,.06); }
      #gau-chat-inputbar { display: flex; gap: 10px; padding: 12px; border-top: 1px solid rgba(2,6,23,.06); background: white; }
      #gau-input { flex: 1; border: 1px solid #e5e7eb; border-radius: 999px; padding: 12px 16px; outline: none; font-size: 16px; }
      #gau-send { background: #facc15; border: none; border-radius: 999px; padding: 10px 14px; font-weight: 800; color: #0f172a; }
      #gau-send:hover { filter: brightness(0.98); transform: translateY(-1px); }
      #gau-chat-close { border: 0; background: transparent; font-size: 20px; opacity:.7; }
      .gau-meta { font-size: 12px; opacity: .7; margin-top: 6px; }
      .gau-tip { font-size: 12px; color: #475569; }
      .gau-select { border: 1px solid #cbd5e1; background: white; border-radius: 10px; padding: 6px 8px; }
      .typing { opacity: .8; }
    </style>

</head>
<body class="bg-gradient-to-b from-sky-200 to-amber-200 min-h-screen p-4 md:p-8 text-gray-800 overflow-x-hidden">
    <!-- Tr√¨nh ph√°t √¢m thanh ·∫©n cho TTS -->
    <audio id="tts-audio" style="display: none;"></audio>

    <!-- ======================================================= -->
    <!-- ==== TRANG CH·ª¶ (MODULE CH·ªåN L·ªöP & CH·ª®C NƒÇNG) ==== -->
    <!-- ======================================================= -->
    <div id="page-home" class="page-container">
        <!-- 1. Header (Logo v√† Ti√™u ƒë·ªÅ) -->
        <header class="flex flex-col items-center justify-center mb-10">
            <!-- (M·ªöI) Brand Header (Tr∆∞·ªùng TH V√µng La) -->
            <div class="flex items-center gap-3 mb-4">
                <img src="data/images/logo.jpg" class="w-12 h-12 rounded-full border-2 border-white shadow-md" alt="Logo Tr∆∞·ªùng TH V√µng La">
                <span class="text-xl font-bold text-blue-800">Tr∆∞·ªùng Ti·ªÉu H·ªçc V√µng La</span>
            </div>

            <!-- SVG Logo -->
            <svg class="w-24 h-24" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="#FDE047"/>
                <defs><clipPath id="circle-clip"><circle cx="50" cy="50" r="45"/></clipPath></defs>
                <path d="M28 80 Q 50 70, 72 80 V 95 H 28 Z" fill="#3B82F6" clip-path="url(#circle-clip)"/>
                <circle cx="28" cy="28" r="12" fill="#C27803"/><circle cx="72" cy="28" r="12" fill="#C27803"/>
                <circle cx="50" cy="55" r="28" fill="#C27803"/>
                <circle cx="30" cy="30" r="7" fill="#FCD34D"/><circle cx="70" cy="30" r="7" fill="#FCD34D"/>
                <circle cx="42" cy="52" r="3" fill="#1F2937"/><circle cx="58" cy="52" r="3" fill="#1F2937"/>
                <ellipse cx="36" cy="62" rx="5" ry="3" fill="#F472B6" fill-opacity="0.6"/><ellipse cx="64" cy="62" rx="5" ry="3" fill="#F472B6" fill-opacity="0.6"/>
                <path d="M48 62 L 52 62 L 50 65 Z" fill="#1F2937"/>
                <path d="M44 70 Q 50 74, 56 70" stroke="#1F2937" stroke-width="2" fill="none" stroke-linecap="round"/>
            </svg>
            <h1 class="text-3xl md:text-5xl font-extrabold text-blue-700 mt-4 text-center">G·∫•u Con H·ªçc Tin</h1>
            <p class="text-xl md:text-2xl text-blue-600 font-medium text-center">Tr·ª£ l√Ω h·ªçc t·∫≠p th√¥ng minh</p>
            <p class="text-base md:text-lg text-gray-600 mt-1 text-center">C√πng em kh√°m ph√° th·∫ø gi·ªõi Tin h·ªçc l·ªõp 3-4-5</p>
        <!-- Auth Entry Button (added v2.7.3) -->
        <div class="flex justify-center mt-3 mb-1" id="auth-entry-wrap">
          <button id="auth-open-btn"
                  class="px-5 py-2 rounded-full bg-blue-600 hover:bg-blue-700 text-white font-bold shadow btn-hover flex items-center gap-2">
            <span>üîí</span><span>ƒêƒÉng Nh·∫≠p/ƒêƒÉng K√Ω</span>
          </button>
        </div>
<!-- Account area (visible when logged in) -->
<div id="account-area" class="hidden mt-3 flex justify-center">
  <div class="flex items-center gap-3 bg-white/90 backdrop-blur rounded-full shadow px-3 py-2 border border-gray-200">
    <img id="acc-avatar" src="data/images/logo-bear-64.png" alt="avatar" class="w-8 h-8 rounded-full ring-2 ring-blue-100">
    <div class="leading-tight">
      <div id="acc-name" class="font-bold text-gray-800 text-sm">H·ªçc sinh</div>
      <div id="acc-meta" class="text-xs text-gray-600">Kh·ªëi ‚Ä¢ L·ªõp</div>
    </div>
    <button id="acc-settings" class="text-xs ml-1 px-3 py-1 rounded-full bg-indigo-600 text-white hover:bg-indigo-700 focus:outline-none">C√†i ƒë·∫∑t</button>
    <button id="acc-logout" class="text-xs px-3 py-1 rounded-full bg-gray-200 hover:bg-gray-300 focus:outline-none">ƒêƒÉng xu·∫•t</button>
  </div>
</div>


        </header>

        <!-- 2. Main Content Grid -->
        <main class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-7xl mx-auto">
            
            <!-- C·ªôt 1: Ch·ªçn L·ªõp -->
            <div class="flex flex-col space-y-5">
                <button class="grade-btn btn-hover active-grade" data-grade="L·ªõp 3">L·ªöP 3</button>
                <button class="grade-btn btn-hover" data-grade="L·ªõp 4">L·ªöP 4</button>
                <button class="grade-btn btn-hover" data-grade="L·ªõp 5">L·ªöP 5</button>
            </div>

            <!-- C·ªôt 2: N√∫t ch·ª©c nƒÉng 1 -->
            <div class="flex flex-col space-y-6">
                <!-- Video h·ªçc -->
                <button class="menu-btn btn-hover bg-red-400 hover:bg-red-500 shadow-lg shadow-red-200" onclick="showPage('page-video')">
                    <span class="icon-emoji">üìö</span>
                    Video h·ªçc
                </button>
                <!-- Tr√≤ ch∆°i mini -->
                <button class="menu-btn btn-hover bg-green-500 hover:bg-green-600 shadow-lg shadow-green-200" onclick="showPage('page-game')">
                    <span class="icon-emoji">üéØ</span>
                    Tr√≤ ch∆°i mini
                </button>
            </div>

            <!-- C·ªôt 3: N√∫t ch·ª©c nƒÉng 2 -->
            <div class="flex flex-col space-y-6">
                <!-- Phi·∫øu b√†i t·∫≠p -->
                <button class="menu-btn btn-hover bg-yellow-500 hover:bg-yellow-600 shadow-lg shadow-yellow-200" onclick="showPage('page-quiz')">
                    <span class="icon-emoji">üß†</span>
                    Phi·∫øu b√†i t·∫≠p
                </button>
                <!-- K·∫øt qu·∫£ h·ªçc t·∫≠p -->
                <button class="menu-btn btn-hover bg-purple-500 hover:bg-purple-600 shadow-lg shadow-purple-200" onclick="showPage('page-results')">
                    <span class="icon-emoji">üìà</span>
                    K·∫øt qu·∫£ h·ªçc t·∫≠p
                </button>

                <!-- B·∫£ng x·∫øp h·∫°ng -->
                <!-- N√∫t BXH ƒë∆∞·ª£c thi·∫øt k·∫ø ri√™ng: bi·ªÉu t∆∞·ª£ng c√∫p l·ªõn v√† ch·ªØ ƒë·∫≠m d·ªÖ nh√¨n cho h·ªçc sinh ti·ªÉu h·ªçc -->
                <!-- B·∫£ng x·∫øp h·∫°ng: th·∫ª card l·ªõn v·ªõi c√∫p v√† nh√£n. Ch·ªçn m√†u v√†ng t∆∞∆°i v√† bo tr√≤n l·ªõn cho ph√π h·ª£p h·ªçc sinh ti·ªÉu h·ªçc -->
                <button id="p2-scoreboard-card" type="button" onclick="p2ShowLeaderboard()" class="menu-btn btn-hover bg-amber-400 hover:bg-amber-500 shadow-lg shadow-amber-300 rounded-2xl flex flex-col items-center justify-center gap-2 py-6">
                    <span class="text-5xl leading-none">üèÜ</span>
                    <span class="text-xl font-extrabold">B·∫£ng X·∫øp H·∫°ng</span>
                </button>
            </div>
        </main>

        
    </div> <!-- K·∫øt th√∫c page-home -->

    <!-- ======================================================= -->
    <!-- ==== MODULE 1: VIDEO B√ÄI H·ªåC (·∫®N) ==== -->
    <!-- ======================================================= -->
    <div id="page-video" class="page-container hidden max-w-6xl mx-auto">
        <!-- Header c·ªßa module -->
        <header class="flex items-center mb-8">
            <button class="back-btn btn-hover text-3xl md:text-5xl p-2 rounded-full hover:bg-black/10">üëà</button>
            <h1 id="video-page-title" class="text-2xl md:text-4xl font-extrabold text-blue-700 ml-4">üìö Video B√†i H·ªçc</h1>
        </header>
        <!-- L∆∞·ªõi video -->
        <div id="video-grid-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </div> <!-- K·∫øt th√∫c page-video -->

    <!-- ======================================================= -->
    <!-- ==== MODULE 2: PHI·∫æU B√ÄI T·∫¨P (·∫®N) ==== -->
    <!-- ======================================================= -->
    <!-- ======================================================= -->
    <!-- ==== MODULE 2: PHI·∫æU B√ÄI T·∫¨P (V2.5.1 - ·∫®N) ==== -->
    <!-- ======================================================= -->
    <div id="page-quiz" class="page-container hidden max-w-4xl mx-auto">
        <!-- Header c·ªßa module -->
        <header class="flex items-center mb-8">
            <button class="back-btn btn-hover text-3xl md:text-5xl p-2 rounded-full hover:bg-black/10">üëà</button>
            <h1 id="quiz-page-title" class="text-2xl md:text-4xl font-extrabold text-blue-700 ml-4">üß† Phi·∫øu B√†i T·∫≠p</h1>
        </header>

        <!-- (M·ªöI V2.5.1) M√†n h√¨nh ch·ªçn b√†i -->
        <div id="quiz-lesson-selection" class="space-y-4">
            <h2 class="text-2xl font-bold text-center text-blue-800 mb-6">Em h√£y ch·ªçn b√†i h·ªçc:</h2>
            <!-- Danh s√°ch b√†i t·∫≠p s·∫Ω ƒë∆∞·ª£c JS ch√®n v√†o ƒë√¢y -->
        </div>

        <!-- (M·ªöI V2.5.1) Th·∫ª l√†m b√†i (·∫©n ban ƒë·∫ßu) -->
        <div class="bg-white/80 p-4 md:p-6 rounded-3xl shadow-xl backdrop-blur-sm relative hidden" id="quiz-card">
    <!-- Popup B·∫£ng T·ªïng K·∫øt (M·ªöI) -->
    <div id="summary-popup" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center transform scale-100 transition-transform duration-300">
            <h2 class="text-3xl font-extrabold text-blue-700 mb-4">B·∫£ng T·ªïng K·∫øt</h2>
            <p id="summary-popup-content" class="text-xl font-medium p-4 rounded-xl bg-blue-100 text-blue-800 whitespace-pre-line mb-6"></p>
            <button id="summary-popup-close" class="btn-hover w-full p-4 bg-blue-600 text-white rounded-xl font-bold text-lg" onclick="document.getElementById('summary-popup').classList.add('hidden'); updatePageContent('page-quiz');">ƒê√ìNG</button>
        </div>
    </div>
            <!-- Header c·ªßa Th·∫ª B√†i -->
            <div class="mb-4">
                <div class="text-gray-500 font-medium text-sm" id="quiz-topic">B√†i 1: Th√¥ng tin v√† quy·∫øt ƒë·ªãnh</div>
                <div class="w-full bg-gray-200 rounded-full h-2.5 mt-1">
                    <div id="quiz-progress" class="bg-blue-500 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
                <div class="text-blue-600 font-bold text-lg mt-1" id="quiz-level">M·ª®C 1: NH·∫¨N BI·∫æT üéØ</div>
            </div>

            <!-- (M·ªöI V2.5.1) ƒê·ªìng h·ªì b·∫•m gi·ªù (Stopwatch) -->
            <div class="absolute top-4 left-4 text-xl font-bold text-gray-800 bg-white/70 px-4 py-2 rounded-xl shadow-md">
                <span id="quiz-stopwatch">00:00</span>
            </div>

            <!-- N√∫t Loa (Gi·ªØ nguy√™n id) -->
            <button id="speak-button" class="btn-hover absolute top-4 right-4 text-3xl md:text-4xl p-2 rounded-full hover:bg-blue-200">üîà</button>

            <!-- C√¢u h·ªèi ch√≠nh (Gi·ªØ nguy√™n id) -->
            <h2 id="question-text" class="text-2xl md:text-3xl font-bold text-gray-900 my-6 min-h-[4rem]">
                C√¢u h·ªèi s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y
            </h2>

            <!-- Khu v·ª±c ƒê√°p √°n (JS render) -->
            <div id="quiz-answer-area" class="min-h-[240px]"></div>

            <!-- Ph·∫£n h·ªìi -->
            <div id="feedback-message" class="hidden mt-6 text-xl font-medium p-4 rounded-xl"></div>

            <!-- N√∫t C√¢u ti·∫øp theo -->
            <button id="next-question-btn" class="hidden btn-hover mt-6 w-full p-4 bg-blue-600 text-white rounded-xl font-bold text-lg">Ti·∫øp theo ‚ûî</button>
        </div>

        <!-- Hi·ªáu ·ª©ng Ph√°o hoa to√†n m√†n h√¨nh (·∫©n) -->
        <div id="correct-overlay" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm">
            <div class="text-white text-6xl font-bold text-center animate-bounce">
                TUY·ªÜT V·ªúI! ü•≥
                <div class="text-4xl">üéâ‚ú®üéâ</div>
            </div>
        </div>
    </div> <!-- K·∫øt th√∫c page-quiz -->

    <!-- ======================================================= -->
    <!-- ==== MODULE 3: TR√í CH∆†I MINI (·∫®N) ==== -->
    <!-- ======================================================= -->
    
    <!-- ======================================================= -->
    <!-- ==== MODULE 3: TR√í CH∆†I MINI (ƒê√É N√ÇNG C·∫§P) ==== -->
    <!-- ======================================================= -->
    <div id="page-game" class="page-container hidden max-w-5xl mx-auto">
        <!-- Header -->
        <header class="flex items-center mb-6">
            <button class="back-btn btn-hover text-3xl md:text-5xl p-2 rounded-full hover:bg-black/10">üëà</button>
            <h1 id="game-page-title" class="text-2xl md:text-4xl font-extrabold text-blue-700 ml-4">üéØ Mini Game √în T·∫≠p</h1>
        </header>

        <!-- Kh·ªëi ch·ªçn l·ªõp + danh s√°ch game -->
        <div class="bg-white/80 p-6 md:p-8 rounded-3xl shadow-xl backdrop-blur-sm">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4">
                <div>
                    <h3 class="text-xl font-bold">Ch·ªçn mini game theo <span id="game-grade-label" class="text-blue-700">L·ªõp 3</span></h3>
                    <p class="text-sm text-gray-600">B·∫•m v√†o th·∫ª ƒë·ªÉ b·∫Øt ƒë·∫ßu ch∆°i ‚Äì t√≠ch ƒëi·ªÉm & nh·∫≠n sao.</p>
                </div>
                <div class="flex gap-2">
                    <button class="game-grade-btn btn-hover px-4 py-2 rounded-full border-2 border-blue-300 text-blue-700 bg-white" data-grade="L·ªõp 3">L·ªõp 3</button>
                    <button class="game-grade-btn btn-hover px-4 py-2 rounded-full border-2 border-blue-300 text-blue-700 bg-white" data-grade="L·ªõp 4">L·ªõp 4</button>
                    <button class="game-grade-btn btn-hover px-4 py-2 rounded-full border-2 border-blue-300 text-blue-700 bg-white" data-grade="L·ªõp 5">L·ªõp 5</button>
                </div>
            </div>

            <!-- Danh s√°ch game -->
            <div id="game-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>

            <!-- Khu v·ª±c ch∆°i game (·∫©n ban ƒë·∫ßu) -->
            <div id="game-play" class="hidden mt-6">
                <div class="flex items-center justify-between mb-3">
                    <button id="game-back-list" class="btn-hover px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 border">‚Üê Danh s√°ch</button>
                    <div class="flex items-center gap-4 text-sm">
                        <span>ƒêi·ªÉm: <b id="game-score">0</b></span>
                        <span>M·∫°ng: <b id="game-lives">3</b></span>
                        <span>Th·ªùi gian: <b id="game-timer">--</b></span>
                    </div>
                </div>

                <!-- ƒê∆∞·ªùng ƒëua (ch·ªâ d√πng cho game ki·ªÉu ƒëua xe/flash) -->
                <div id="race-wrap" class="mb-4 hidden">
                    <h3 class="text-base font-semibold text-center mb-2">G·∫•u üêª vs Th·ªè üê∞</h3>
                    <div id="race-track" class="w-full h-24 rounded-lg overflow-hidden relative mb-2">
                        <div id="player-bear" class="racer" style="transform: translateX(0px);">üêª</div>
                        <div id="player-rabbit" class="racer" style="transform: translateX(0px);">üê∞</div>
                        <div class="finish-line">üèÅ</div>
                    </div>
                </div>

                <!-- C√¢u h·ªèi -->
                <h2 id="game-question-text" class="text-xl md:text-2xl font-bold text-gray-900 mb-4">C√¢u h·ªèi</h2>

                <!-- S√¢n ch∆°i -->
                <div id="game-stage" class="min-h-[200px]"></div>

                <!-- Ph·∫£n h·ªìi -->
                <div id="game-feedback" class="hidden mt-4 text-lg font-medium p-4 rounded-xl"></div>

                <!-- N√∫t ti·∫øp theo -->
                <button id="game-next" class="hidden btn-hover mt-4 w-full p-3 bg-blue-600 text-white rounded-xl font-bold">C√¢u ti·∫øp theo ‚ûî</button>
            </div>
        </div>

        <!-- Popup T·ªïng k·∫øt -->
        <div id="game-summary" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
            <div class="bg-white w-full max-w-md rounded-3xl p-8 shadow-2xl text-center">
                <h3 class="text-2xl font-extrabold text-blue-700 mb-2">T·ªïng k·∫øt l∆∞·ª£t ch∆°i</h3>
                <p id="game-summary-text" class="text-lg text-gray-700 mb-4 whitespace-pre-line"></p>
                <button id="game-summary-close" class="btn-hover w-full p-3 bg-blue-600 text-white rounded-xl font-bold">ƒê√≥ng</button>
            </div>
        </div>
    </div> <!-- K·∫øt th√∫c page-game -->

    
    <!-- ======================================================= -->
    <!-- ==== MODULE 4: K·∫æT QU·∫¢ H·ªåC T·∫¨P (·∫®N) ==== -->
    <!-- ======================================================= -->
    <div id="page-results" class="page-container hidden max-w-4xl mx-auto">
        <!-- Header c·ªßa module -->
        <header class="flex items-center mb-8">
            <button class="back-btn btn-hover text-3xl md:text-5xl p-2 rounded-full hover:bg-black/10">üëà</button>
            <h1 id="results-page-title" class="text-2xl md:text-4xl font-extrabold text-blue-700 ml-4">üìà K·∫øt Qu·∫£ H·ªçc T·∫≠p</h1>
        </header>

        <!-- L∆∞·ªõi k·∫øt qu·∫£ -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Th·∫ª T·ªïng sao -->
            <div class="flex items-center p-6 bg-gradient-to-r from-yellow-300 to-orange-400 rounded-2xl shadow-lg text-white">
                <span class="text-6xl mr-4">üåü</span>
                <div>
                    <div class="text-5xl font-bold" id="stars-count">125</div>
                    <div class="text-xl font-medium">T·ªïng s·ªë sao</div>
                </div>
            </div>
            <!-- Th·∫ª B√†i ƒë√£ l√†m -->
            <div class="flex items-center p-6 bg-gradient-to-r from-blue-400 to-indigo-500 rounded-2xl shadow-lg text-white">
                <span class="text-6xl mr-4">üìù</span>
                <div>
                    <div class="text-5xl font-bold" id="completed-count">15</div>
                    <div class="text-xl font-medium">B√†i ƒë√£ l√†m</div>
                </div>
            </div>
            <!-- Th·∫ª T·ª∑ l·ªá ƒë√∫ng -->
            <div class="flex items-center p-6 bg-gradient-to-r from-green-400 to-cyan-500 rounded-2xl shadow-lg text-white">
                <span class="text-6xl mr-4">üéØ</span>
                <div>
                    <div class="text-5xl font-bold" id="accuracy-percent">85%</div>
                    <div class="text-xl font-medium">T·ª∑ l·ªá ƒë√∫ng</div>
                </div>
            </div>
            <!-- Th·∫ª Th√†nh t√≠ch -->
            <div class="flex items-center p-6 bg-gradient-to-r from-pink-400 to-red-500 rounded-2xl shadow-lg text-white">
                <span class="text-6xl mr-4">üèÜ</span>
                <div>
                    <div class="text-5xl font-bold" id="trophy-count">3</div>
                    <div class="text-xl font-medium">Th√†nh t√≠ch</div>
                </div>
            </div>
        </div>
    </div> <!-- K·∫øt th√∫c page-results -->


    <!-- ======================= JAVASCRIPT ======================= -->
    
<script>// === v2.5.7-stable runtime guards ===
(function(){
  function panic(e){
    try{
      console.error('[GAU PANIC]', e);
      window.__gauErrs = window.__gauErrs || [];
      window.__gauErrs.push(e && e.stack ? e.stack : (e && e.message ? e.message : String(e)));
      var box = document.getElementById('app-error');
      if (box){
        box.classList.remove('hidden');
        var msgEl = box.querySelector('.msg');
        if (msgEl) msgEl.textContent = (e && e.message) ? e.message : String(e);
      }
    }catch(_){}
  }
  window.__gauPanic = panic;
  window.addEventListener('error', function(ev){ panic(ev.error || ev.message || ev); });
  window.addEventListener('unhandledrejection', function(ev){ panic(ev.reason || ev); });
  window.safeCall = function(fn){
    try{
      return fn && fn.apply ? fn.apply(this, Array.prototype.slice.call(arguments,1)) : null;
    }catch(e){ panic(e); }
  };
})();


// ===============================
// V2.5.1 FIXED - QUIZ B√ÄI 1
// ===============================

// ====== H·ªá th·ªëng l∆∞u ƒëi·ªÉm ======
let userScores = {
  "L·ªõp 3": { totalStars: 0, completedCount: 0, correctAnswers: 0, totalAnswers: 0 },
  "L·ªõp 4": { totalStars: 0, completedCount: 0, correctAnswers: 0, totalAnswers: 0 },
  "L·ªõp 5": { totalStars: 0, completedCount: 0, correctAnswers: 0, totalAnswers: 0 }
};
const SCORE_STORAGE_KEY = 'gauConHocTinScores_v2_5_1';
function saveScores(){ try{ localStorage.setItem(SCORE_STORAGE_KEY, JSON.stringify(userScores)); }catch(e){} }
function loadScores(){ try{ const s = localStorage.getItem(SCORE_STORAGE_KEY); if(s){ userScores = JSON.parse(s); } }catch(e){} }

// ====== √Çm thanh & TTS (c√≥ guard Tone) ======
let audioInitialized=false;
let hoverSound=null, correctSound=null, incorrectSound=null;
try{
  if (window.Tone) {
    hoverSound = new Tone.Synth({ oscillator:{type:'sine'}, envelope:{attack:0.005,decay:0.1,sustain:0,release:0.1} }).toDestination();
    correctSound = new Tone.PolySynth(Tone.Synth, { oscillator:{type:'triangle'}, envelope:{attack:0.01,decay:0.2,sustain:0,release:0.2} }).toDestination();
    incorrectSound = new Tone.Synth({ oscillator:{type:'fmsquare'}, envelope:{attack:0.01,decay:0.3,sustain:0,release:0.1} }).toDestination();
  }
}catch(e){}
function playHover(){ if(audioInitialized&&hoverSound) hoverSound.triggerAttackRelease('G5','16n'); }
function playCorrect(){ if(audioInitialized&&correctSound) correctSound.triggerAttackRelease(['C4','E4','G4'],'8n'); }
function playIncorrect(){ if(audioInitialized&&incorrectSound) incorrectSound.triggerAttackRelease('F#2','4n'); }

const ttsAudio = document.getElementById('tts-audio');
function speakText(txt){
	  if(!audioInitialized || !ttsAudio) return;
	  const shortText = (txt||"").slice(0,200);
	  const url = 'https://translate.google.com/translate_tts?ie=UTF-8&q='+encodeURIComponent(shortText)+'&tl=vi&client=tw-ob';
	  ttsAudio.src = url;
	  ttsAudio.play().then(()=>{ 
	      // S·ª¨A S·ªê 1500 th√†nh 8000
	      setTimeout(()=>{ try{ttsAudio.pause(); ttsAudio.currentTime=0;}catch(e){} }, 8000); 
	  }).catch(()=>{});
	}
function initAudioOnce(){
  if(audioInitialized) return;
  loadScores();
  if (window.Tone && Tone.start) {
    Tone.start().then(()=>{ audioInitialized=true; }).catch(()=>{ audioInitialized=true; });
  } else { audioInitialized=true; }
  if(ttsAudio){ ttsAudio.play().catch(()=>{}); ttsAudio.pause(); ttsAudio.currentTime=0; }
}
document.body.addEventListener('click', initAudioOnce, {once:true});
document.body.addEventListener('touchstart', initAudioOnce, {once:true});

// ====== Logic ƒëa trang ======
let currentGrade = 'L·ªõp 3';
const allPages = document.querySelectorAll('.page-container');
function showPage(pageId){
  allPages.forEach(p=>p.classList.add('hidden'));
  const t=document.getElementById(pageId); if(t){ t.classList.remove('hidden'); updatePageContent(pageId); }
}

const gradeButtons = document.querySelectorAll('.grade-btn');
gradeButtons.forEach(b=> b.addEventListener('click', ()=>{
  gradeButtons.forEach(x=>x.classList.remove('active-grade'));
  b.classList.add('active-grade'); currentGrade=b.dataset.grade; playHover();
}));

document.querySelectorAll('.btn-hover, .gau-submit-btn').forEach(b=> b.addEventListener('mouseenter', playHover));
document.querySelectorAll('.back-btn').forEach(b=> b.addEventListener('click', ()=>{ showPage('page-home'); speakText(''); clearInterval(lessonStopwatchInterval); }));

// ====== Video (gi·ªØ nguy√™n) ======
const LOCAL_VIDEO_MAX = 60;
const pad2 = n=>String(n).padStart(2,'0');
const gradeToFolder = g => (g==='L·ªõp 3'?'lop3':(g==='L·ªõp 4'?'lop4':(g==='L·ªõp 5'?'lop5':'lop3')));
function loadVideoContent(){
  const grid = document.getElementById('video-grid-container'); if(!grid) return;
  grid.innerHTML='';
  const folder = gradeToFolder(currentGrade);
  let any=false;
  for(let i=1;i<=LOCAL_VIDEO_MAX;i++){
    const src='data/'+folder+'/b'+pad2(i)+'.mp4';
    const card=document.createElement('div'); card.className='bg-white rounded-2xl shadow-lg overflow-hidden btn-hover';
    const wrap=document.createElement('div'); wrap.className='w-full aspect-video bg-black/5';
    const v=document.createElement('video'); v.className='w-full h-full object-cover local-video'; v.controls=true; v.preload='metadata'; v.playsInline=true; v.src=src;
    let didError=false; v.onerror=()=>{didError=true; card.remove();};
    setTimeout(()=>{
      if(!didError){
        wrap.appendChild(v);
        const body=document.createElement('div'); body.className='p-4';
        body.innerHTML='<h3 class="font-bold text-lg text-gray-800">B√†i '+i+'</h3><p class="text-gray-600 text-sm">Th∆∞ m·ª•c: '+folder+'</p>';
        card.appendChild(wrap); card.appendChild(body); grid.appendChild(card); any=true;
      }
    },100);
  }
  setTimeout(()=>{ if(!any){ grid.innerHTML='<p class="text-gray-600 text-lg col-span-full text-center">Ch∆∞a t√¨m th·∫•y video trong <code>data/'+folder+'</code>.<br>ƒê·∫∑t file d·∫°ng <b>b01.mp4, b02.mp4...</b></p>'; } },1000);
}

// ====== K·∫øt qu·∫£ h·ªçc t·∫≠p ======
function renderResultsPage(){
  const s = userScores[currentGrade] || {totalStars:0,completedCount:0,correctAnswers:0,totalAnswers:0};
  const acc = s.totalAnswers ? Math.round((s.correctAnswers/s.totalAnswers)*100) : 0;
  const el=id=>document.getElementById(id);
  if(el('stars-count')) el('stars-count').innerText = s.totalStars||0;
  if(el('completed-count')) el('completed-count').innerText = s.completedCount||0;
  if(el('accuracy-percent')) el('accuracy-percent').innerText = acc+'%';
  if(el('trophy-count')) el('trophy-count').innerText = 0;
}

// ====== QUIZ DATA (B√†i 1: 15 c√¢u ‚Äì theo t√†i li·ªáu) ======
const quizData = {
  "L·ªõp 3": {
    "B√†i 1": {
      title: "B√†i 1: Th√¥ng tin v√† quy·∫øt ƒë·ªãnh",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Th√¥ng tin l√† g√¨?', options:[
          {text:'Nh·ªØng g√¨ em nghe, nh√¨n, ƒë·ªçc ƒë∆∞·ª£c gi√∫p em hi·ªÉu bi·∫øt h∆°n', correct:true},
          {text:'M·ªôt lo·∫°i th·ª©c ƒÉn', correct:false},
          {text:'M·ªôt tr√≤ ch∆°i', correct:false},
          {text:'M·ªôt thi·∫øt b·ªã m√°y t√≠nh', correct:false}
        ]},
        { level:1, type:'image-choice', question:'C√¢u 2: Thi·∫øt b·ªã n√†o d∆∞·ªõi ƒë√¢y gi√∫p em nh·∫≠n th√¥ng tin?', options:[
          {text:'A. Chu·ªôt m√°y t√≠nh', correct:false, image:'svg:mouse'},
          {text:'B. M√†n h√¨nh', correct:true, image:'svg:monitor'},
          {text:'C. B√†n ph√≠m', correct:false, image:'svg:keyboard'},
          {text:'D. M√°y in', correct:false, image:'svg:printer'}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Em nh·∫≠n ƒë∆∞·ª£c th√¥ng tin b·∫±ng gi√°c quan n√†o?', options:[
          {text:'M·∫Øt, tai, m≈©i, l∆∞·ª°i, da', correct:true},
          {text:'Tay v√† ch√¢n', correct:false},
          {text:'Ch·ªâ b·∫±ng m·∫Øt', correct:false},
          {text:'B·∫±ng m≈©i', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 4: ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
          {text:'1Ô∏è‚É£ Nghe c√¥ gi√°o gi·∫£ng b√†i l√† nh·∫≠n th√¥ng tin.', correct:true},
          {text:'2Ô∏è‚É£ Em b·∫•m n√∫t m·ªü m√°y t√≠nh l√† g·ª≠i th√¥ng tin.', correct:true}
        ]},
        { level:1, type:'matching', question:'C√¢u 5: N·ªëi c·ªôt A v·ªõi c·ªôt B cho ƒë√∫ng:', columnA:['1. M·∫Øt','2. Tai','3. Tay'], columnB:['a. Nh·∫≠n th√¥ng tin b·∫±ng √¢m thanh','b. Nh·∫≠n th√¥ng tin b·∫±ng h√¨nh ·∫£nh','c. Nh·∫≠n th√¥ng tin b·∫±ng x√∫c gi√°c'], correctMatches:{'1. M·∫Øt':'b. Nh·∫≠n th√¥ng tin b·∫±ng h√¨nh ·∫£nh','2. Tai':'a. Nh·∫≠n th√¥ng tin b·∫±ng √¢m thanh','3. Tay':'c. Nh·∫≠n th√¥ng tin b·∫±ng x√∫c gi√°c'} },
        { level:1, type:'image-question', question:'C√¢u 6: Khi th·∫•y ƒë√®n giao th√¥ng m√†u ƒë·ªè em n√™n:', image:'svg:traffic_red', options:[
          {text:'A. ƒêi qua ƒë∆∞·ªùng', correct:false},
          {text:'B. D·ª´ng l·∫°i', correct:true},
          {text:'C. Ch·∫°y nhanh h∆°n', correct:false},
          {text:'D. B·ªè qua v√¨ kh√¥ng quan tr·ªçng', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 7: V√¨ sao c·∫ßn c√≥ th√¥ng tin?', options:[
          {text:'ƒê·ªÉ hi·ªÉu v√† ra quy·∫øt ƒë·ªãnh ƒë√∫ng', correct:true},
          {text:'ƒê·ªÉ vui ch∆°i', correct:false},
          {text:'ƒê·ªÉ l√†m m·∫•t th·ªùi gian', correct:false},
          {text:'Kh√¥ng c·∫ßn thi·∫øt', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Khi ch·ªçn qu·∫ßn √°o m·∫∑c ph√π h·ª£p v·ªõi th·ªùi ti·∫øt, em ƒë√£ s·ª≠ d·ª•ng th√¥ng tin g√¨?', options:[
          {text:'Th√¥ng tin th·ªùi ti·∫øt', correct:true},
          {text:'Th√¥ng tin th·ªÉ thao', correct:false},
          {text:'Th√¥ng tin tr√≤ ch∆°i', correct:false},
          {text:'Th√¥ng tin √¢m nh·∫°c', correct:false}
        ]},
        { level:2, type:'fill-in-blank', question:'C√¢u 9: Em d√πng m·∫Øt ƒë·ªÉ ‚Ä¶‚Ä¶‚Ä¶ h√¨nh ·∫£nh, d√πng tai ƒë·ªÉ ‚Ä¶‚Ä¶‚Ä¶ √¢m thanh.', sentence:'Em d√πng m·∫Øt ƒë·ªÉ [BLANK] h√¨nh ·∫£nh, d√πng tai ƒë·ªÉ [BLANK] √¢m thanh.', hints:['nh·∫≠n','nghe'], correctAnswers:['nh·∫≠n','nghe'] },
        { level:2, type:'matching', question:'C√¢u 10: N·ªëi t√¨nh hu·ªëng ·ªü c·ªôt A v·ªõi quy·∫øt ƒë·ªãnh ·ªü c·ªôt B:', columnA:['1. Tr·ªùi m∆∞a','2. B·∫°n b·ªã ·ªëm','3. Th·∫•y ·ªï ƒëi·ªán h·ªü'], columnB:['a. Mang √¥ ho·∫∑c √°o m∆∞a','b. ThƒÉm h·ªèi v√† gi√∫p b·∫°n h·ªçc b√†i','c. B√°o cho ng∆∞·ªùi l·ªõn bi·∫øt'], correctMatches:{'1. Tr·ªùi m∆∞a':'a. Mang √¥ ho·∫∑c √°o m∆∞a','2. B·∫°n b·ªã ·ªëm':'b. ThƒÉm h·ªèi v√† gi√∫p b·∫°n h·ªçc b√†i','3. Th·∫•y ·ªï ƒëi·ªán h·ªü':'c. B√°o cho ng∆∞·ªùi l·ªõn bi·∫øt'} },
        { level:2, type:'multiple-choice', question:'C√¢u 11: Khi th·∫•y b·∫£ng ‚ÄúC·∫•m tr√®o‚Äù, em n√™n l√†m g√¨?', options:[
          {text:'Ti·∫øp t·ª•c tr√®o', correct:false},
          {text:'D·ª´ng l·∫°i v√† tu√¢n theo', correct:true},
          {text:'B·ªè qua', correct:false},
          {text:'Ch·ª•p ·∫£nh', correct:false}
        ]},
        { level:2, type:'true-false', question:'C√¢u 12: ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
          {text:'1Ô∏è‚É£ Nh·∫≠n th√¥ng tin ƒë√∫ng gi√∫p ta quy·∫øt ƒë·ªãnh ƒë√∫ng.', correct:true},
          {text:'2Ô∏è‚É£ Kh√¥ng c·∫ßn ki·ªÉm tra th√¥ng tin tr∆∞·ªõc khi h√†nh ƒë·ªông.', correct:false}
        ]},
        { level:3, type:'multiple-choice', question:'C√¢u 13: Khi h·ªçc tr·ª±c tuy·∫øn, em nghe c√¥ gi·∫£ng v√† nh√¨n h√¨nh tr√™n m√†n h√¨nh. ƒê√≥ l√†:', options:[
          {text:'Em ƒëang nh·∫≠n th√¥ng tin b·∫±ng gi√°c quan', correct:true},
          {text:'Em ƒëang g·ª≠i th√¥ng tin', correct:false},
          {text:'Em kh√¥ng nh·∫≠n th√¥ng tin', correct:false},
          {text:'Em ƒëang ch∆°i tr√≤ ch∆°i', correct:false}
        ]},
        { level:3, type:'fill-in-blank-choice', question:'C√¢u 14: Em th·∫•y tr·ªùi nhi·ªÅu m√¢y ƒëen v√† nghe ti·∫øng s·∫•m, em (ch·ªçn)‚Ä¶ Em ƒëi·ªÅn: Em ... v√¨ em ...', sentence:'Em [BLANK] v√¨ em [BLANK].', options:['Mang √¥ ƒëi h·ªçc','Kh√¥ng mang g√¨'], correctChoice:'Mang √¥ ƒëi h·ªçc', correctAnswers:['mang √¥ ƒëi h·ªçc','d·ª± ƒëo√°n tr·ªùi s·∫Ω m∆∞a'] },
        { level:3, type:'matching-image', question:'C√¢u 15: Quan s√°t h√¨nh v√† n·ªëi v·ªõi quy·∫øt ƒë·ªãnh ph√π h·ª£p:', columnA:[{text:'üåû Tr·ªùi n·∫Øng', image:'svg:sun'},{text:'‚òî Tr·ªùi m∆∞a', image:'svg:rain'},{text:'‚ùÑÔ∏è Tr·ªùi l·∫°nh', image:'svg:cold'}], columnB:['a. ƒê·ªôi m≈©, m·∫∑c √°o ch·ªëng n·∫Øng','b. Mang √¥, m·∫∑c √°o m∆∞a','c. M·∫∑c √°o ·∫•m'], correctMatches:{'üåû Tr·ªùi n·∫Øng':'a. ƒê·ªôi m≈©, m·∫∑c √°o ch·ªëng n·∫Øng','‚òî Tr·ªùi m∆∞a':'b. Mang √¥, m·∫∑c √°o m∆∞a','‚ùÑÔ∏è Tr·ªùi l·∫°nh':'c. M·∫∑c √°o ·∫•m'} }
      ]
    },
    
    "B√†i 2": {
      title: "B√†i 2: X·ª≠ l√≠ th√¥ng tin",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: X·ª≠ l√≠ th√¥ng tin l√† g√¨?', options:[
          {text:'A. Nh·∫≠n th√¥ng tin b·∫±ng m·∫Øt, tai', correct:false},
          {text:'B. D√πng th√¥ng tin ƒë√£ c√≥ ƒë·ªÉ so s√°nh, t√≠nh to√°n, s·∫Øp x·∫øp', correct:true},
          {text:'C. G·ª≠i th√¥ng tin cho ng∆∞·ªùi kh√°c', correct:false},
          {text:'D. Kh√¥ng l√†m g√¨ v·ªõi th√¥ng tin', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: Thi·∫øt b·ªã n√†o d∆∞·ªõi ƒë√¢y gi√∫p m√°y t√≠nh x·ª≠ l√≠ th√¥ng tin?', options:[
          {text:'A. M√†n h√¨nh', correct:false},
          {text:'B. B√†n ph√≠m', correct:false},
          {text:'C. B·ªô x·ª≠ l√≠ trung t√¢m (CPU)', correct:true},
          {text:'D. Chu·ªôt', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Ho·∫°t ƒë·ªông n√†o sau ƒë√¢y l√† x·ª≠ l√≠ th√¥ng tin?', options:[
          {text:'A. ƒê·ªçc m·ªôt b√†i b√°o', correct:false},
          {text:'B. T√≠nh ƒëi·ªÉm trung b√¨nh c√°c m√¥n h·ªçc', correct:true},
          {text:'C. Nghe nh·∫°c', correct:false},
          {text:'D. Nh√¨n tranh', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 4: ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
          {text:'1Ô∏è‚É£ Khi em so s√°nh hai b·ª©c tranh ƒë·ªÉ t√¨m ƒëi·ªÉm kh√°c nhau, ƒë√≥ l√† x·ª≠ l√≠ th√¥ng tin.', correct:true},
          {text:'2Ô∏è‚É£ Khi em ch·ªâ nh√¨n tranh m√† kh√¥ng suy nghƒ©, ƒë√≥ l√† x·ª≠ l√≠ th√¥ng tin.', correct:false}
        ]},
        { level:1, type:'matching', question:'C√¢u 5: N·ªëi c·ªôt A v·ªõi c·ªôt B cho ƒë√∫ng:', 
          columnA:['1. Nh·∫≠n th√¥ng tin','2. X·ª≠ l√≠ th√¥ng tin','3. Tr·∫£ k·∫øt qu·∫£'], 
          columnB:['a. Xem k·∫øt qu·∫£ b√†i ki·ªÉm tra','b. T√≠nh ƒëi·ªÉm trung b√¨nh','c. Nghe c√¥ gi√°o gi·∫£ng'], 
          correctMatches:{'1. Nh·∫≠n th√¥ng tin':'c. Nghe c√¥ gi√°o gi·∫£ng','2. X·ª≠ l√≠ th√¥ng tin':'b. T√≠nh ƒëi·ªÉm trung b√¨nh','3. Tr·∫£ k·∫øt qu·∫£':'a. Xem k·∫øt qu·∫£ b√†i ki·ªÉm tra'} 
        },
        { level:1, type:'multiple-choice', question:'C√¢u 6: B·ªô ph·∫≠n n√†o c·ªßa con ng∆∞·ªùi l√†m nhi·ªám v·ª• x·ª≠ l√≠ th√¥ng tin?', options:[
          {text:'A. Ch√¢n tay', correct:false},
          {text:'B. ƒê√¥i tai', correct:false},
          {text:'C. ƒê√¥i m·∫Øt', correct:false},
          {text:'D. B·ªô n√£o', correct:true}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 7: Khi em x·∫øp s√°ch theo m√†u b√¨a, em ƒëang:', options:[
          {text:'A. Nh·∫≠n th√¥ng tin', correct:false},
          {text:'B. G·ª≠i th√¥ng tin', correct:false},
          {text:'C. X·ª≠ l√≠ th√¥ng tin', correct:true},
          {text:'D. Sao ch√©p th√¥ng tin', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Khi xem b·∫£ng ƒëi·ªÉm, em ph√°t hi·ªán m√¥n n√†o m√¨nh h·ªçc t·ªët, ƒë√≥ l√†:', options:[
          {text:'A. Em ƒëang x·ª≠ l√≠ th√¥ng tin ƒë·ªÉ r√∫t ra k·∫øt lu·∫≠n', correct:true},
          {text:'B. Em ƒëang nh·∫≠n th√¥ng tin', correct:false},
          {text:'C. Em ƒëang v·∫Ω tranh', correct:false},
          {text:'D. Em ƒëang sao ch√©p', correct:false}
        ]},
        { level:2, type:'fill-in-blank', question:'C√¢u 9: Khi em so s√°nh, s·∫Øp x·∫øp, t√≠nh to√°n hay ƒë∆∞a ra k·∫øt lu·∫≠n, em ƒëang ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ th√¥ng tin.', 
          sentence:'Khi em so s√°nh, s·∫Øp x·∫øp, t√≠nh to√°n hay ƒë∆∞a ra k·∫øt lu·∫≠n, em ƒëang [BLANK] th√¥ng tin.', 
          hints:['x·ª≠ l√≠'], correctAnswers:['x·ª≠ l√≠'] 
        },
        { level:2, type:'matching', question:'C√¢u 10: N·ªëi ho·∫°t ƒë·ªông v·ªõi lo·∫°i x·ª≠ l√≠ th√¥ng tin t∆∞∆°ng ·ª©ng:', 
          columnA:['1. So s√°nh hai v·∫≠t','2. T√≠nh s·ªë b·∫°n trong l·ªõp','3. Ch·ªçn b·∫°n ƒë·ªôi b√≥ng'], 
          columnB:['a. T√≠nh to√°n','b. So s√°nh','c. Ra quy·∫øt ƒë·ªãnh'], 
          correctMatches:{'1. So s√°nh hai v·∫≠t':'b. So s√°nh','2. T√≠nh s·ªë b·∫°n trong l·ªõp':'a. T√≠nh to√°n','3. Ch·ªçn b·∫°n ƒë·ªôi b√≥ng':'c. Ra quy·∫øt ƒë·ªãnh'} 
        },
        { level:2, type:'multiple-choice', question:'C√¢u 11: V√¨ sao con ng∆∞·ªùi v√† m√°y t√≠nh ƒë·ªÅu c·∫ßn x·ª≠ l√≠ th√¥ng tin?', options:[
          {text:'A. ƒê·ªÉ hi·ªÉu v√† ƒë∆∞a ra quy·∫øt ƒë·ªãnh ƒë√∫ng', correct:true},
          {text:'B. ƒê·ªÉ trang tr√≠ th√¥ng tin', correct:false},
          {text:'C. ƒê·ªÉ l√†m r·ªëi th√¥ng tin', correct:false},
          {text:'D. ƒê·ªÉ kh√¥ng c·∫ßn nh·ªõ g√¨ c·∫£', correct:false}
        ]},
        { level:2, type:'true-false', question:'C√¢u 12: ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
          {text:'1Ô∏è‚É£ M√°y t√≠nh ch·ªâ nh·∫≠n th√¥ng tin m√† kh√¥ng x·ª≠ l√≠.', correct:false},
          {text:'2Ô∏è‚É£ Con ng∆∞·ªùi c≈©ng c√≥ th·ªÉ x·ª≠ l√≠ th√¥ng tin.', correct:true}
        ]},
        { level:3, type:'multiple-choice', question:'C√¢u 13: Em th·∫•y ba b·∫°n c√≥ k·∫øt qu·∫£ nh∆∞ sau: Nam 7 ƒëi·ªÉm, Lan 9 ƒëi·ªÉm, Mai 8 ƒëi·ªÉm. Ai h·ªçc gi·ªèi nh·∫•t?', options:[
          {text:'A. Lan', correct:true},
          {text:'B. Nam', correct:false},
          {text:'C. Mai', correct:false},
          {text:'D. C·∫£ ba nh∆∞ nhau', correct:false}
        ]},
        { level:3, type:'fill-in-blank', question:'C√¢u 14: Khi m·∫π nh√¨n v√†o b·∫£ng gi√° rau v√† ch·ªçn mua lo·∫°i r·∫ª nh·∫•t, m·∫π ƒëang ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ th√¥ng tin ƒë·ªÉ ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ mua h√†ng.', 
          sentence:'Khi m·∫π nh√¨n v√†o b·∫£ng gi√° rau v√† ch·ªçn mua lo·∫°i r·∫ª nh·∫•t, m·∫π ƒëang [BLANK] th√¥ng tin ƒë·ªÉ [BLANK] mua h√†ng.', 
          hints:['x·ª≠ l√≠','ra quy·∫øt ƒë·ªãnh'], correctAnswers:['x·ª≠ l√≠','ra quy·∫øt ƒë·ªãnh'] 
        },
        { level:3, type:'matching-image', question:'C√¢u 15: Quan s√°t v√† n·ªëi v·ªõi h√†nh ƒë·ªông x·ª≠ l√≠ t∆∞∆°ng ·ª©ng:', 
          columnA:[{text:'üßÆ Em t√≠nh s·ªë b√∫t trong h·ªôp', image:'svg:calculator'},{text:'üîç Em t√¨m ƒëi·ªÉm kh√°c nhau trong hai tranh', image:'svg:magnifier'},{text:'üìä Em ch·ªçn b·∫°n c√≥ ƒëi·ªÉm cao nh·∫•t', image:'svg:chart'}], 
          columnB:['a. So s√°nh th√¥ng tin','b. Ra k·∫øt lu·∫≠n','c. T√≠nh to√°n th√¥ng tin'], 
          correctMatches:{'üßÆ Em t√≠nh s·ªë b√∫t trong h·ªôp':'c. T√≠nh to√°n th√¥ng tin','üîç Em t√¨m ƒëi·ªÉm kh√°c nhau trong hai tranh':'a. So s√°nh th√¥ng tin','üìä Em ch·ªçn b·∫°n c√≥ ƒëi·ªÉm cao nh·∫•t':'b. Ra k·∫øt lu·∫≠n'} 
        }
      ]
    },

    
    "B√†i 3": {
      title: "B√†i 3: M√°y t√≠nh v√† em",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: M√°y t√≠nh l√† g√¨?', options:[
          {text:'A. M·ªôt thi·∫øt b·ªã gi√∫p con ng∆∞·ªùi h·ªçc t·∫≠p, l√†m vi·ªác, gi·∫£i tr√≠', correct:true},
          {text:'B. M·ªôt ƒë·ªì ch∆°i th√¥ng th∆∞·ªùng', correct:false},
          {text:'C. M·ªôt chi·∫øc tivi', correct:false},
          {text:'D. M·ªôt chi·∫øc ƒëi·ªán tho·∫°i', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: M√°y t√≠nh g·ªìm nh·ªØng b·ªô ph·∫≠n ch√≠nh n√†o?', options:[
          {text:'A. M√†n h√¨nh, b√†n ph√≠m, chu·ªôt, th√¢n m√°y', correct:true},
          {text:'B. B√†n gh·∫ø, ƒë√®n, qu·∫°t', correct:false},
          {text:'C. M√†n h√¨nh v√† ti vi', correct:false},
          {text:'D. Chu·ªôt v√† ƒëi·ªán tho·∫°i', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Thi·∫øt b·ªã n√†o gi√∫p em nh·∫≠p d·ªØ li·ªáu v√†o m√°y t√≠nh?', options:[
          {text:'A. B√†n ph√≠m v√† chu·ªôt', correct:true},
          {text:'B. M√†n h√¨nh', correct:false},
          {text:'C. Loa', correct:false},
          {text:'D. M√°y in', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 4: ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
          {text:'1Ô∏è‚É£ M√†n h√¨nh gi√∫p em xem k·∫øt qu·∫£ l√†m vi·ªác c·ªßa m√°y t√≠nh.', correct:true},
          {text:'2Ô∏è‚É£ Chu·ªôt d√πng ƒë·ªÉ nghe √¢m thanh.', correct:false}
        ]},
        { level:1, type:'matching', question:'C√¢u 5: N·ªëi c·ªôt A v·ªõi c·ªôt B cho ƒë√∫ng:', 
          columnA:['1. M√†n h√¨nh','2. Chu·ªôt','3. B√†n ph√≠m'], 
          columnB:['a. Nh·∫≠p th√¥ng tin','b. Hi·ªÉn th·ªã th√¥ng tin','c. ƒêi·ªÅu khi·ªÉn con tr·ªè'], 
          correctMatches:{'1. M√†n h√¨nh':'b. Hi·ªÉn th·ªã th√¥ng tin','2. Chu·ªôt':'c. ƒêi·ªÅu khi·ªÉn con tr·ªè','3. B√†n ph√≠m':'a. Nh·∫≠p th√¥ng tin'} 
        },
        { level:1, type:'image-question', image:'svg:child_pc', question:'C√¢u 6: M√°y t√≠nh gi√∫p con ng∆∞·ªùi l√†m vi·ªác g√¨?', options:[
          {text:'A. T√≠nh to√°n, v·∫Ω, h·ªçc t·∫≠p, gi·∫£i tr√≠', correct:true},
          {text:'B. ƒÇn u·ªëng, ng·ªß ngh·ªâ', correct:false},
          {text:'C. N·∫•u ƒÉn', correct:false},
          {text:'D. Ch∆°i b√≥ng', correct:false}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: V√¨ sao c·∫ßn s·ª≠ d·ª•ng m√°y t√≠nh c·∫©n th·∫≠n?', options:[
          {text:'A. ƒê·ªÉ m√°y ho·∫°t ƒë·ªông t·ªët v√† an to√†n', correct:true},
          {text:'B. V√¨ m√°y kh√¥ng quan tr·ªçng', correct:false},
          {text:'C. ƒê·ªÉ nhanh h·ªèng h∆°n', correct:false},
          {text:'D. V√¨ kh√¥ng c·∫ßn quan t√¢m', correct:false}
        ]},
        { level:2, type:'image-question', image:'svg:posture_ok', question:'C√¢u 8: Khi ng·ªìi h·ªçc v·ªõi m√°y t√≠nh, t∆∞ th·∫ø n√†o l√† ƒë√∫ng?', options:[
          {text:'A. Ng·ªìi th·∫≥ng l∆∞ng, m·∫Øt c√°ch m√†n h√¨nh kho·∫£ng 50 cm', correct:true},
          {text:'B. N·∫±m ra b√†n', correct:false},
          {text:'C. C√∫i s√°t m√†n h√¨nh', correct:false},
          {text:'D. Quay l∆∞ng l·∫°i m√°y', correct:false}
        ]},
        { level:2, type:'fill-in-blank', question:'C√¢u 9: M√°y t√≠nh gi√∫p em ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶, ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶, v√† ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ t·ªët h∆°n.', 
          sentence:'M√°y t√≠nh gi√∫p em [BLANK], [BLANK], v√† [BLANK] t·ªët h∆°n.', 
          hints:['h·ªçc t·∫≠p','gi·∫£i tr√≠','t√≠nh to√°n'], correctAnswers:['h·ªçc t·∫≠p','gi·∫£i tr√≠','t√≠nh to√°n'] 
        },
        { level:2, type:'matching', question:'C√¢u 10: N·ªëi ho·∫°t ƒë·ªông c·ªßa em v·ªõi l·ª£i √≠ch c·ªßa m√°y t√≠nh:', 
          columnA:['1. V·∫Ω tranh','2. Xem phim','3. L√†m b√†i To√°n'], 
          columnB:['a. Gi·∫£i tr√≠','b. H·ªçc t·∫≠p','c. T√≠nh to√°n'], 
          correctMatches:{'1. V·∫Ω tranh':'b. H·ªçc t·∫≠p','2. Xem phim':'a. Gi·∫£i tr√≠','3. L√†m b√†i To√°n':'c. T√≠nh to√°n'} 
        },
        { level:2, type:'multiple-choice', question:'C√¢u 11: Khi d√πng m√°y t√≠nh, em kh√¥ng n√™n l√†m g√¨?', options:[
          {text:'A. ƒÇn u·ªëng khi ƒëang h·ªçc', correct:true},
          {text:'B. Gi·ªØ tay s·∫°ch, ng·ªìi ngay ng·∫Øn', correct:false},
          {text:'C. T·∫Øt m√°y khi kh√¥ng s·ª≠ d·ª•ng', correct:false},
          {text:'D. L√†m theo h∆∞·ªõng d·∫´n c·ªßa th·∫ßy c√¥', correct:false}
        ]},
        { level:2, type:'true-false', question:'C√¢u 12: ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
          {text:'1Ô∏è‚É£ M√°y t√≠nh gi√∫p em v·∫Ω tranh, h·ªçc Ti·∫øng Anh.', correct:true},
          {text:'2Ô∏è‚É£ D√πng m√°y t√≠nh l√¢u kh√¥ng c·∫ßn ngh·ªâ ng∆°i.', correct:false}
        ]},

        { level:3, type:'multiple-choice', question:'C√¢u 13: Khi m·∫π nh·ªù em tra th√¥ng tin th·ªùi ti·∫øt tr√™n m√°y t√≠nh, em ƒëang:', options:[
          {text:'A. Nh·∫≠n v√† x·ª≠ l√≠ th√¥ng tin', correct:true},
          {text:'B. Nghe nh·∫°c', correct:false},
          {text:'C. Ch∆°i tr√≤ ch∆°i', correct:false},
          {text:'D. V·∫Ω tranh', correct:false}
        ]},
        { level:3, type:'fill-in-blank', question:'C√¢u 14: Khi s·ª≠ d·ª•ng m√°y t√≠nh, em c·∫ßn ng·ªìi ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ v√† gi·ªØ kho·∫£ng c√°ch ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ ƒë·ªÉ b·∫£o v·ªá m·∫Øt.', 
          sentence:'Khi s·ª≠ d·ª•ng m√°y t√≠nh, em c·∫ßn ng·ªìi [BLANK] v√† gi·ªØ kho·∫£ng c√°ch [BLANK] ƒë·ªÉ b·∫£o v·ªá m·∫Øt.', 
          hints:['ƒë√∫ng t∆∞ th·∫ø','an to√†n'], correctAnswers:['ƒë√∫ng t∆∞ th·∫ø','an to√†n'] 
        },
        { level:3, type:'matching-image', question:'C√¢u 15: Quan s√°t h√¨nh v√† n·ªëi v·ªõi h√†nh ƒë·ªông ƒë√∫ng:', 
          columnA:[{text:'üíª Em t·∫Øt m√°y t√≠nh sau khi h·ªçc', image:'svg:power_off'}, {text:'üßç‚Äç‚ôÄÔ∏è Em ng·ªìi th·∫≥ng l∆∞ng, m·∫Øt c√°ch m√†n h√¨nh 50cm', image:'svg:posture_ok'}, {text:'üôÖ‚Äç‚ôÇÔ∏è Em kh√¥ng ch·∫°m v√†o d√¢y ƒëi·ªán', image:'svg:safety_electric'}], 
          columnB:['a. Gi·ªØ v·ªá sinh v√† ti·∫øt ki·ªám ƒëi·ªán','b. Ng·ªìi h·ªçc ƒë√∫ng t∆∞ th·∫ø','c. Gi·ªØ an to√†n khi d√πng m√°y t√≠nh'], 
          correctMatches:{'üíª Em t·∫Øt m√°y t√≠nh sau khi h·ªçc':'a. Gi·ªØ v·ªá sinh v√† ti·∫øt ki·ªám ƒëi·ªán','üßç‚Äç‚ôÄÔ∏è Em ng·ªìi th·∫≥ng l∆∞ng, m·∫Øt c√°ch m√†n h√¨nh 50cm':'b. Ng·ªìi h·ªçc ƒë√∫ng t∆∞ th·∫ø','üôÖ‚Äç‚ôÇÔ∏è Em kh√¥ng ch·∫°m v√†o d√¢y ƒëi·ªán':'c. Gi·ªØ an to√†n khi d√πng m√°y t√≠nh'} 
        }
      ]
    }
  },
  "L·ªõp 4": {
    "B√†i 1": {
      title: "B√†i 1: Ph·∫ßn c·ª©ng v√† ph·∫ßn m·ªÅm c·ªßa m√°y t√≠nh",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Ph·∫ßn c·ª©ng c·ªßa m√°y t√≠nh l√† g√¨?', options:[
          {text:'A. C√°c ch∆∞∆°ng tr√¨nh ƒëi·ªÅu khi·ªÉn m√°y t√≠nh', correct:false},
          {text:'B. C√°c b·ªô ph·∫≠n c√≥ th·ªÉ s·ªù, c·∫ßm, nh√¨n th·∫•y ƒë∆∞·ª£c', correct:true},
          {text:'C. C√°c t·∫≠p tin trong m√°y', correct:false},
          {text:'D. C√°c ·ª©ng d·ª•ng', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: CPU l√† vi·∫øt t·∫Øt c·ªßa c·ª•m t·ª´ n√†o?', options:[
          {text:'A. Central Process Unit', correct:false},
          {text:'B. Central Processing Unit', correct:true},
          {text:'C. Center Programming Unit', correct:false},
          {text:'D. Control Processing Unit', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: B·ªô ph·∫≠n n√†o gi√∫p hi·ªÉn th·ªã h√¨nh ·∫£nh?', options:[
          {text:'A. B√†n ph√≠m', correct:false},
          {text:'B. M√†n h√¨nh', correct:true},
          {text:'C. Chu·ªôt', correct:false},
          {text:'D. Loa', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: Thi·∫øt b·ªã n√†o l√† ph·∫ßn c·ª©ng nh·∫≠p d·ªØ li·ªáu?', options:[
          {text:'A. M√†n h√¨nh', correct:false},
          {text:'B. M√°y in', correct:false},
          {text:'C. B√†n ph√≠m', correct:true},
          {text:'D. Loa', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
          {text:'Ph·∫ßn m·ªÅm l√† c√°c thi·∫øt b·ªã v·∫≠t l√Ω c·ªßa m√°y t√≠nh.', correct:false},
          {text:'H·ªá ƒëi·ªÅu h√†nh l√† m·ªôt lo·∫°i ph·∫ßn m·ªÅm gi√∫p ƒëi·ªÅu khi·ªÉn ho·∫°t ƒë·ªông c·ªßa m√°y t√≠nh.', correct:true}
        ]},
        { level:1, type:'true-false', question:'C√¢u 6: ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
          {text:'M√†n h√¨nh l√† thi·∫øt b·ªã xu·∫•t d·ªØ li·ªáu.', correct:true},
          {text:'B√†n ph√≠m l√† thi·∫øt b·ªã xu·∫•t d·ªØ li·ªáu.', correct:false}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: Ph·∫ßn m·ªÅm so·∫°n th·∫£o vƒÉn b·∫£n l√†:', options:[
          {text:'A. Paint', correct:false},
          {text:'B. Word', correct:true},
          {text:'C. Excel', correct:false},
          {text:'D. PowerPoint', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Ph·∫ßn m·ªÅm n√†o gi√∫p em v·∫Ω tranh tr√™n m√°y t√≠nh?', options:[
          {text:'A. Paint', correct:true},
          {text:'B. Word', correct:false},
          {text:'C. Excel', correct:false},
          {text:'D. PowerPoint', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: Trong c√°c thi·∫øt b·ªã sau, thi·∫øt b·ªã n√†o l√† ph·∫ßn c·ª©ng xu·∫•t d·ªØ li·ªáu?', options:[
          {text:'A. Chu·ªôt', correct:false},
          {text:'B. M√†n h√¨nh', correct:true},
          {text:'C. B√†n ph√≠m', correct:false},
          {text:'D. USB', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: N·∫øu m√°y t√≠nh kh√¥ng c√≥ ph·∫ßn m·ªÅm, n√≥ s·∫Ω:', options:[
          {text:'A. V·∫´n ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng', correct:false},
          {text:'B. Kh√¥ng th·ªÉ l√†m vi·ªác ƒë∆∞·ª£c', correct:true},
          {text:'C. T·ª± ƒë·ªông t·∫Øt', correct:false},
          {text:'D. Ch·∫°y ch·∫≠m h∆°n', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 11: N·ªëi c·ªôt A v·ªõi c·ªôt B cho ph√π h·ª£p:', 
          columnA:['a. Chu·ªôt','b. M√†n h√¨nh','c. CPU','d. B√†n ph√≠m'],
          columnB:['1. Thi·∫øt b·ªã nh·∫≠p d·ªØ li·ªáu','2. Thi·∫øt b·ªã xu·∫•t d·ªØ li·ªáu','3. X·ª≠ l√Ω d·ªØ li·ªáu','4. Nh·∫≠p vƒÉn b·∫£n'],
          correctMatches:{'a. Chu·ªôt':'1. Thi·∫øt b·ªã nh·∫≠p d·ªØ li·ªáu','b. M√†n h√¨nh':'2. Thi·∫øt b·ªã xu·∫•t d·ªØ li·ªáu','c. CPU':'3. X·ª≠ l√Ω d·ªØ li·ªáu','d. B√†n ph√≠m':'4. Nh·∫≠p vƒÉn b·∫£n'}
        },
        { level:2, type:'matching', question:'C√¢u 12: N·ªëi ph·∫ßn m·ªÅm v·ªõi c√¥ng d·ª•ng ƒë√∫ng:', 
          columnA:['a. Paint','b. Word','c. Excel'],
          columnB:['1. V·∫Ω tranh','2. So·∫°n th·∫£o vƒÉn b·∫£n','3. T√≠nh to√°n, l·∫≠p b·∫£ng'],
          correctMatches:{'a. Paint':'1. V·∫Ω tranh','b. Word':'2. So·∫°n th·∫£o vƒÉn b·∫£n','c. Excel':'3. T√≠nh to√°n, l·∫≠p b·∫£ng'}
        },

        { level:3, type:'fill-in-blank', question:'C√¢u 13: Ph·∫ßn c·ª©ng g·ªìm c√°c b·ªô ph·∫≠n nh∆∞: ________, ________, chu·ªôt v√† CPU.', 
          sentence:'Ph·∫ßn c·ª©ng g·ªìm c√°c b·ªô ph·∫≠n nh∆∞: [BLANK], [BLANK], chu·ªôt v√† CPU.', 
          hints:['m√†n h√¨nh','b√†n ph√≠m'], correctAnswers:['m√†n h√¨nh','b√†n ph√≠m'] 
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 14: Ph·∫ßn m·ªÅm l√† t·∫≠p h·ª£p c√°c ________ gi√∫p m√°y t√≠nh th·ª±c hi·ªán c√¥ng vi·ªác.', 
          sentence:'Ph·∫ßn m·ªÅm l√† t·∫≠p h·ª£p c√°c [BLANK] gi√∫p m√°y t√≠nh th·ª±c hi·ªán c√¥ng vi·ªác.', 
          hints:['ch∆∞∆°ng tr√¨nh','l·ªánh'], correctAnswers:['ch∆∞∆°ng tr√¨nh'], altAnswers:['l·ªánh']
        },
        { level:3, type:'matching', question:'C√¢u 15: N·ªëi ƒë√∫ng theo c·∫∑p ki·∫øn th·ª©c ‚Äì c√¥ng d·ª•ng:', 
          columnA:['1. CPU','2. B√†n ph√≠m','3. M√†n h√¨nh','4. Paint','5. Word'],
          columnB:['a. B·ªô x·ª≠ l√Ω trung t√¢m','b. Nh·∫≠p d·ªØ li·ªáu vƒÉn b·∫£n','c. Hi·ªÉn th·ªã h√¨nh ·∫£nh','d. Ph·∫ßn m·ªÅm v·∫Ω tranh','e. So·∫°n th·∫£o vƒÉn b·∫£n'],
          correctMatches:{'1. CPU':'a. B·ªô x·ª≠ l√Ω trung t√¢m','2. B√†n ph√≠m':'b. Nh·∫≠p d·ªØ li·ªáu vƒÉn b·∫£n','3. M√†n h√¨nh':'c. Hi·ªÉn th·ªã h√¨nh ·∫£nh','4. Paint':'d. Ph·∫ßn m·ªÅm v·∫Ω tranh','5. Word':'e. So·∫°n th·∫£o vƒÉn b·∫£n'}
        }
      ]
    }
,    
"B√†i 2": {
  title: "B√†i 2: G√µ b√†n ph√≠m ƒë√∫ng c√°ch",
  questions: [
    // M·ª®C 1 ‚Äì Nh·∫≠n bi·∫øt (6 c√¢u)
    { level:1, type:'multiple-choice', question:'B·ªô ph·∫≠n n√†o c·ªßa m√°y t√≠nh d√πng ƒë·ªÉ g√µ ch·ªØ v√† s·ªë?', options:[
      {text:'A. Chu·ªôt', correct:false},
      {text:'B. B√†n ph√≠m', correct:true},
      {text:'C. M√†n h√¨nh', correct:false},
      {text:'D. Loa', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Khi g√µ ph√≠m, em c·∫ßn ƒë·∫∑t ng√≥n tay ·ªü h√†ng ph√≠m n√†o ƒë·ªÉ b·∫Øt ƒë·∫ßu?', options:[
      {text:'A. H√†ng ph√≠m s·ªë', correct:false},
      {text:'B. H√†ng ph√≠m gi·ªØa (h√†ng c∆° s·ªü)', correct:true},
      {text:'C. H√†ng ph√≠m tr√™n', correct:false},
      {text:'D. H√†ng ph√≠m d∆∞·ªõi', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Hai ph√≠m c√≥ gai nh·ªè ƒë·ªÉ ƒë·∫∑t ng√≥n tr·ªè tay tr√°i v√† ph·∫£i l√†:', options:[
      {text:'A. A v√† S', correct:false},
      {text:'B. F v√† J', correct:true},
      {text:'C. D v√† K', correct:false},
      {text:'D. E v√† I', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Ph√≠m Enter c√≥ ch·ª©c nƒÉng g√¨?', options:[
      {text:'A. X√≥a ch·ªØ', correct:false},
      {text:'B. Xu·ªëng d√≤ng ho·∫∑c th·ª±c hi·ªán l·ªánh', correct:true},
      {text:'C. Di chuy·ªÉn con tr·ªè', correct:false},
      {text:'D. Vi·∫øt hoa', correct:false}
    ]},
    { level:1, type:'true-false', question:'ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
      {text:'Khi g√µ ph√≠m, em n√™n nh√¨n l√¢u v√†o b√†n ph√≠m ƒë·ªÉ tr√°nh sai.', correct:false},
      {text:'Ng·ªìi th·∫≥ng l∆∞ng, m·∫Øt nh√¨n m√†n h√¨nh, hai tay ƒë·∫∑t ƒë√∫ng v·ªã tr√≠ l√† t∆∞ th·∫ø ƒë√∫ng.', correct:true}
    ]},
    { level:1, type:'multiple-choice', question:'Ph√≠m n√†o c√≥ t√°c d·ª•ng vi·∫øt hoa khi gi·ªØ c√πng v·ªõi ph√≠m ch·ªØ?', options:[
      {text:'A. Shift', correct:true},
      {text:'B. Ctrl', correct:false},
      {text:'C. Alt', correct:false},
      {text:'D. Tab', correct:false}
    ]},

    // M·ª®C 2 ‚Äì Hi·ªÉu (6 c√¢u)
    { level:2, type:'multiple-choice', question:'Khi mu·ªën x√≥a ch·ªØ ph√≠a sau con tr·ªè, em d√πng ph√≠m n√†o?', options:[
      {text:'A. Backspace', correct:false},
      {text:'B. Delete', correct:true},
      {text:'C. Shift', correct:false},
      {text:'D. Ctrl', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'V√¨ sao c·∫ßn h·ªçc g√µ ph√≠m b·∫±ng m∆∞·ªùi ng√≥n?', options:[
      {text:'A. Cho vui', correct:false},
      {text:'B. Ti·∫øt ki·ªám th·ªùi gian v√† b·∫£o v·ªá s·ª©c kh·ªèe', correct:true},
      {text:'C. Kh√¥ng c√≥ l√Ω do', correct:false},
      {text:'D. ƒê·ªÉ l·∫°', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'Khi g√µ ph√≠m, n·∫øu em ƒë·ªÉ tay sai v·ªã tr√≠ s·∫Ω:', options:[
      {text:'A. G√µ nhanh h∆°n', correct:false},
      {text:'B. D·ªÖ g√µ sai v√† m·ªèi tay', correct:true},
      {text:'C. Kh√¥ng ·∫£nh h∆∞·ªüng g√¨', correct:false},
      {text:'D. L√†m m√°y t√≠nh ch·∫≠m', correct:false}
    ]},
    { level:2, type:'matching', question:'N·ªëi t√™n ng√≥n tay v·ªõi ph√≠m ph√π h·ª£p:', 
      columnA:['a. Ng√≥n tr·ªè tr√°i','b. Ng√≥n tr·ªè ph·∫£i','c. Ng√≥n c√°i','d. Ng√≥n √∫t tr√°i'], 
      columnB:['1. F','2. J','3. Ph√≠m c√°ch (Spacebar)','4. Ph√≠m Shift tr√°i'], 
      correctMatches:{'a. Ng√≥n tr·ªè tr√°i':'1. F','b. Ng√≥n tr·ªè ph·∫£i':'2. J','c. Ng√≥n c√°i':'3. Ph√≠m c√°ch (Spacebar)','d. Ng√≥n √∫t tr√°i':'4. Ph√≠m Shift tr√°i'}
    },
    { level:2, type:'matching', question:'N·ªëi h√†nh ƒë·ªông ƒë√∫ng v·ªõi quy t·∫Øc g√µ ph√≠m:', 
      columnA:['a. ƒê·∫∑t tay l√™n h√†ng c∆° s·ªü','b. Ng·ªìi th·∫≥ng l∆∞ng','c. Nh√¨n v√†o m√†n h√¨nh khi g√µ'], 
      columnB:['1. Gi√∫p nh·ªõ v·ªã tr√≠ ph√≠m','2. Gi·ªØ t∆∞ th·∫ø tho·∫£i m√°i','3. T·∫≠p trung v√† g√µ nhanh h∆°n'], 
      correctMatches:{'a. ƒê·∫∑t tay l√™n h√†ng c∆° s·ªü':'1. Gi√∫p nh·ªõ v·ªã tr√≠ ph√≠m','b. Ng·ªìi th·∫≥ng l∆∞ng':'2. Gi·ªØ t∆∞ th·∫ø tho·∫£i m√°i','c. Nh√¨n v√†o m√†n h√¨nh khi g√µ':'3. T·∫≠p trung v√† g√µ nhanh h∆°n'}
    },
    { level:2, type:'multiple-choice', question:'Khi g√µ ch·ªØ hoa, em c·∫ßn k·∫øt h·ª£p ph√≠m n√†o?', options:[
      {text:'A. Shift', correct:true},
      {text:'B. Alt', correct:false},
      {text:'C. Ctrl', correct:false},
      {text:'D. Caps Lock (nh·∫•n gi·ªØ)', correct:false}
    ]},

    // M·ª®C 3 ‚Äì V·∫≠n d·ª•ng (3 c√¢u)
    { level:3, type:'fill-in-blank', question:'Em ƒë·∫∑t hai ng√≥n tr·ªè tay tr√°i v√† tay ph·∫£i l·∫ßn l∆∞·ª£t l√™n ph√≠m ______ v√† ______.', 
      sentence:'Em ƒë·∫∑t hai ng√≥n tr·ªè tay tr√°i v√† tay ph·∫£i l·∫ßn l∆∞·ª£t l√™n ph√≠m [BLANK] v√† [BLANK].', hints:['F','J'], correctAnswers:['F','J']
    },
    { level:3, type:'fill-in-blank', question:'Khi mu·ªën g√µ ch·ªØ c√°i in hoa, em gi·ªØ ph√≠m ______ r·ªìi nh·∫•n ph√≠m ______.', 
      sentence:'Khi mu·ªën g√µ ch·ªØ c√°i in hoa, em gi·ªØ ph√≠m [BLANK] r·ªìi nh·∫•n ph√≠m [BLANK].', hints:['Shift','ch·ªØ c√°i c·∫ßn g√µ'], correctAnswers:['Shift','ch·ªØ c√°i c·∫ßn g√µ']
    },
    { level:3, type:'multiple-choice', question:'T∆∞ th·∫ø ƒë√∫ng khi g√µ ph√≠m l√†:', options:[
      {text:'A. C√∫i s√°t b√†n ph√≠m, tay ƒë·∫∑t t√πy √Ω', correct:false},
      {text:'B. Ng·ªìi th·∫≥ng l∆∞ng, m·∫Øt nh√¨n m√†n h√¨nh, tay ƒë·∫∑t ƒë√∫ng h√†ng c∆° s·ªü', correct:true},
      {text:'C. N·∫±m ra b√†n khi g√µ', correct:false},
      {text:'D. Nh√¨n b√†n ph√≠m li√™n t·ª•c ƒë·ªÉ tr√°nh sai', correct:false}
    ]}
  ]
},
"B√†i 3": {
  title: "B√†i 3: Th√¥ng tin tr√™n trang Web",
  questions: [
    { level:1, type:'multiple-choice', question:'Trang Web l√† g√¨?', options:[
      {text:'A. M·ªôt ph·∫ßn m·ªÅm ch∆°i game', correct:false},
      {text:'B. M·ªôt n∆°i l∆∞u tr·ªØ th√¥ng tin tr√™n Internet', correct:true},
      {text:'C. M·ªôt thi·∫øt b·ªã ph·∫ßn c·ª©ng', correct:false},
      {text:'D. M·ªôt ch∆∞∆°ng tr√¨nh h·ªçc g√µ ph√≠m', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'ƒê·ªÉ xem th√¥ng tin tr√™n trang Web, em c·∫ßn d√πng ph·∫ßn m·ªÅm n√†o?', options:[
      {text:'A. Paint', correct:false},
      {text:'B. Tr√¨nh duy·ªát Web (Chrome, Edge, Firefox)', correct:true},
      {text:'C. Word', correct:false},
      {text:'D. PowerPoint', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Khi truy c·∫≠p m·ªôt trang Web, ta c·∫ßn c√≥:', options:[
      {text:'A. M√°y t√≠nh, k·∫øt n·ªëi Internet v√† tr√¨nh duy·ªát', correct:true},
      {text:'B. B√∫t v√† gi·∫•y', correct:false},
      {text:'C. Chu·ªôt m√°y t√≠nh', correct:false},
      {text:'D. ·ªî ƒëƒ©a CD', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Ph·∫ßn ch·ªØ ho·∫∑c h√¨nh ·∫£nh m√† ta nh·∫•n v√†o ƒë·ªÉ m·ªü trang kh√°c g·ªçi l√†:', options:[
      {text:'A. ƒê∆∞·ªùng d·∫´n (li√™n k·∫øt)', correct:true},
      {text:'B. Thanh c√¥ng c·ª•', correct:false},
      {text:'C. Bi·ªÉu t∆∞·ª£ng', correct:false},
      {text:'D. N√∫t t·∫Øt', correct:false}
    ]},
    { level:1, type:'true-false', question:'ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
      {text:'Tr√¨nh duy·ªát Web d√πng ƒë·ªÉ v·∫Ω h√¨nh.', correct:false},
      {text:'Trang Web c√≥ th·ªÉ ch·ª©a ch·ªØ, h√¨nh, √¢m thanh v√† video.', correct:true}
    ]},
    { level:1, type:'matching', question:'N·ªëi th√¥ng tin cho ƒë√∫ng', 
      columnA:['1. Google Chrome','2. Google','3. https://'],
      columnB:['a. Tr√¨nh duy·ªát Web','b. Trang t√¨m ki·∫øm th√¥ng tin','c. ƒê·∫ßu ƒë·ªãa ch·ªâ c·ªßa m·ªôt trang Web'],
      correctMatches:{'1. Google Chrome':'a. Tr√¨nh duy·ªát Web','2. Google':'b. Trang t√¨m ki·∫øm th√¥ng tin','3. https://':'c. ƒê·∫ßu ƒë·ªãa ch·ªâ c·ªßa m·ªôt trang Web'}
    },

    { level:2, type:'multiple-choice', question:'Trang Web gi√°o d·ª•c gi√∫p em:', options:[
      {text:'A. Ch∆°i game gi·∫£i tr√≠', correct:false},
      {text:'B. H·ªçc v√† t√¨m hi·ªÉu ki·∫øn th·ª©c', correct:true},
      {text:'C. T·∫£i nh·∫°c', correct:false},
      {text:'D. G·ª≠i th∆∞', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'Khi mu·ªën t√¨m th√¥ng tin an to√†n, em n√™n:', options:[
      {text:'A. V√†o trang Web c√≥ ngu·ªìn tin r√µ r√†ng', correct:true},
      {text:'B. V√†o b·∫•t k·ª≥ trang n√†o xu·∫•t hi·ªán ƒë·∫ßu ti√™n', correct:false},
      {text:'C. Nh·∫•n v√†o qu·∫£ng c√°o c√≥ h√¨nh ƒë·∫πp', correct:false},
      {text:'D. H·ªèi ng∆∞·ªùi l·∫° tr√™n m·∫°ng', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'Khi th·∫•y th√¥ng tin kh√¥ng ph√π h·ª£p tr√™n trang Web, em n√™n l√†m g√¨?', options:[
      {text:'A. B·ªè qua v√† ƒë√≥ng trang ƒë√≥', correct:true},
      {text:'B. G·ª≠i link cho b·∫°n b√®', correct:false},
      {text:'C. B√¨nh lu·∫≠n ph·∫£n ƒë·ªëi', correct:false},
      {text:'D. Ch·ª•p l·∫°i v√† ƒëƒÉng m·∫°ng x√£ h·ªôi', correct:false}
    ]},
    { level:2, type:'true-false', question:'ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
      {text:'M·ªçi trang Web ƒë·ªÅu an to√†n v·ªõi tr·∫ª em.', correct:false},
      {text:'C·∫ßn h·ªèi ng∆∞·ªùi l·ªõn khi truy c·∫≠p trang l·∫°.', correct:true}
    ]},
    { level:2, type:'matching', question:'N·ªëi ƒë√∫ng ch·ª©c nƒÉng tr√¨nh duy·ªát', 
      columnA:['1. N√∫t ‚ÄúQuay l·∫°i‚Äù','2. N√∫t ‚ÄúL√†m m·ªõi‚Äù','3. √î ƒë·ªãa ch·ªâ'],
      columnB:['a. M·ªü trang Web m·ªõi','b. Xem l·∫°i trang tr∆∞·ªõc ƒë√≥','c. G√µ ƒë·ªãa ch·ªâ Web c·∫ßn truy c·∫≠p'],
      correctMatches:{'1. N√∫t ‚ÄúQuay l·∫°i‚Äù':'b. Xem l·∫°i trang tr∆∞·ªõc ƒë√≥','2. N√∫t ‚ÄúL√†m m·ªõi‚Äù':'a. M·ªü trang Web m·ªõi','3. √î ƒë·ªãa ch·ªâ':'c. G√µ ƒë·ªãa ch·ªâ Web c·∫ßn truy c·∫≠p'}
    },
    { level:2, type:'fill-in-blank', question:'Ch·ªçn v√† ƒëi·ªÅn t·ª´', 
      sentence:'a) Em d√πng [BLANK] ƒë·ªÉ truy c·∫≠p v√† xem c√°c trang Web. b) M·ªói trang Web c√≥ m·ªôt [BLANK] ri√™ng.',
      hints:['tr√¨nh duy·ªát web','ƒë·ªãa ch·ªâ (URL)'],
      correctAnswers:['tr√¨nh duy·ªát web','ƒë·ªãa ch·ªâ (URL)']
    },

    { level:3, type:'multiple-choice', question:'Khi c·∫ßn t√¨m h√¨nh ·∫£nh v·ªÅ ‚Äúhoa h·ªìng‚Äù tr√™n Internet, em n√™n:', options:[
      {text:'A. G√µ t·ª´ kh√≥a ‚Äúhoa h·ªìng‚Äù v√†o √¥ t√¨m ki·∫øm c·ªßa Google', correct:true},
      {text:'B. V√†o trang b·∫•t k·ª≥', correct:false},
      {text:'C. T·ª± v·∫Ω b·∫±ng Paint', correct:false},
      {text:'D. H·ªèi b·∫°n', correct:false}
    ]},
    { level:3, type:'fill-in-blank', question:'ƒêi·ªÅn t·ª´', 
      sentence:'Khi ƒë·ªçc th√¥ng tin tr√™n Web, em c·∫ßn [BLANK] tr∆∞·ªõc khi tin v√† chia s·∫ª.',
      hints:['ki·ªÉm tra ngu·ªìn ho·∫∑c h·ªèi ng∆∞·ªùi l·ªõn'],
      correctAnswers:['ki·ªÉm tra ngu·ªìn ho·∫∑c h·ªèi ng∆∞·ªùi l·ªõn']
    },
    { level:3, type:'matching', question:'N·ªëi ho·∫°t ƒë·ªông v·ªõi h√†nh ƒë·ªông ƒë√∫ng khi s·ª≠ d·ª•ng Internet', 
      columnA:['1. T√¨m th√¥ng tin h·ªçc t·∫≠p','2. Gi·∫£i tr√≠','3. G·∫∑p th√¥ng tin x·∫•u'],
      columnB:['a. Ch·ªçn trang gi√°o d·ª•c','b. Ch·ªçn tr√≤ ch∆°i ph√π h·ª£p l·ª©a tu·ªïi','c. B√°o v·ªõi cha m·∫π ho·∫∑c th·∫ßy c√¥'],
      correctMatches:{'1. T√¨m th√¥ng tin h·ªçc t·∫≠p':'a. Ch·ªçn trang gi√°o d·ª•c','2. Gi·∫£i tr√≠':'b. Ch·ªçn tr√≤ ch∆°i ph√π h·ª£p l·ª©a tu·ªïi','3. G·∫∑p th√¥ng tin x·∫•u':'c. B√°o v·ªõi cha m·∫π ho·∫∑c th·∫ßy c√¥'}
    }
  ]
},
"B√†i 4": {
  title: "B√†i 4: T√¨m ki·∫øm th√¥ng tin tr√™n Internet",
  questions: [
    { level:1, type:'multiple-choice', question:'Internet l√† g√¨?', options:[
      {text:'A. M·ªôt tr√≤ ch∆°i ƒëi·ªán t·ª≠', correct:false},
      {text:'B. M·ªôt m·∫°ng m√°y t√≠nh to√†n c·∫ßu gi√∫p chia s·∫ª th√¥ng tin', correct:true},
      {text:'C. M·ªôt ch∆∞∆°ng tr√¨nh so·∫°n th·∫£o vƒÉn b·∫£n', correct:false},
      {text:'D. M·ªôt ph·∫ßn c·ª©ng m√°y t√≠nh', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Ph·∫ßn m·ªÅm gi√∫p em t√¨m ki·∫øm th√¥ng tin tr√™n Internet l√†:', options:[
      {text:'A. Microsoft Word', correct:false},
      {text:'B. Google Chrome', correct:true},
      {text:'C. Paint', correct:false},
      {text:'D. PowerPoint', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Em g√µ t·ª´ kh√≥a ƒë·ªÉ t√¨m ki·∫øm ·ªü ƒë√¢u?', options:[
      {text:'A. Tr√™n b√†n ph√≠m', correct:false},
      {text:'B. Trong √¥ t√¨m ki·∫øm c·ªßa trang Google', correct:true},
      {text:'C. Trong ph·∫ßn m·ªÅm v·∫Ω', correct:false},
      {text:'D. Trong √¥ ƒë·ªãa ch·ªâ', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Khi g√µ t·ª´ kh√≥a ‚Äúhoa h·ªìng‚Äù, k·∫øt qu·∫£ hi·ªÉn th·ªã l√†:', options:[
      {text:'A. H√¨nh ·∫£nh, b√†i vi·∫øt, video v·ªÅ hoa h·ªìng', correct:true},
      {text:'B. Tr√≤ ch∆°i hoa h·ªìng', correct:false},
      {text:'C. ·∫¢nh m√®o', correct:false},
      {text:'D. VƒÉn b·∫£n b·∫•t k·ª≥', correct:false}
    ]},
    { level:1, type:'true-false', question:'ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
      {text:'(1) Ch·ªâ c√≥ th·ªÉ t√¨m ki·∫øm th√¥ng tin b·∫±ng ƒëi·ªán tho·∫°i.', correct:false},
      {text:'(2) T√¨m ki·∫øm tr√™n Internet gi√∫p em h·ªçc h·ªèi nhi·ªÅu ƒëi·ªÅu m·ªõi.', correct:true}
    ]},
    { level:1, type:'matching', question:'N·ªëi cho ƒë√∫ng', 
      columnA:['1. Google','2. √î t√¨m ki·∫øm','3. K·∫øt qu·∫£ t√¨m ki·∫øm'],
      columnB:['a. Trang Web t√¨m ki·∫øm th√¥ng tin','b. N∆°i nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm','c. Danh s√°ch th√¥ng tin hi·ªÉn th·ªã sau khi t√¨m'],
      correctMatches:{'1. Google':'a. Trang Web t√¨m ki·∫øm th√¥ng tin','2. √î t√¨m ki·∫øm':'b. N∆°i nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm','3. K·∫øt qu·∫£ t√¨m ki·∫øm':'c. Danh s√°ch th√¥ng tin hi·ªÉn th·ªã sau khi t√¨m'}
    },

    { level:2, type:'multiple-choice', question:'ƒê·ªÉ t√¨m h√¨nh ·∫£nh con m√®o, em n√™n g√µ t·ª´ kh√≥a n√†o?', options:[
      {text:'A. Con ch√≥', correct:false},
      {text:'B. H√¨nh con m√®o', correct:true},
      {text:'C. ƒÇn s√°ng', correct:false},
      {text:'D. M√°y t√≠nh', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'Khi k·∫øt qu·∫£ t√¨m ki·∫øm qu√° nhi·ªÅu, em n√™n:', options:[
      {text:'A. B·ªè qua', correct:false},
      {text:'B. ƒê·ªçc ch·ªçn l·ªçc, xem trang ƒë√°ng tin c·∫≠y', correct:true},
      {text:'C. M·ªü t·∫•t c·∫£ c√°c trang', correct:false},
      {text:'D. Nh·∫•n v√†o qu·∫£ng c√°o', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'ƒê·ªÉ t√¨m b√†i h√°t ‚ÄúQu·ªëc ca Vi·ªát Nam‚Äù, em n√™n:', options:[
      {text:'A. G√µ t·ª´ kh√≥a ‚ÄúQu·ªëc ca Vi·ªát Nam‚Äù v√†o √¥ t√¨m ki·∫øm', correct:true},
      {text:'B. M·ªü ph·∫ßn m·ªÅm Paint', correct:false},
      {text:'C. G√µ t·ª´ kh√≥a ‚Äútr√≤ ch∆°i‚Äù', correct:false},
      {text:'D. Kh√¥ng c·∫ßn g√µ g√¨ c·∫£', correct:false}
    ]},
    { level:2, type:'true-false', question:'ƒêi·ªÅn ƒë√∫ng/sai', statements:[
      {text:'(1) Khi t√¨m ki·∫øm th√¥ng tin, em n√™n ƒë·ªçc k·ªπ ti√™u ƒë·ªÅ tr∆∞·ªõc khi m·ªü.', correct:true},
      {text:'(2) M·ªçi trang Web ƒë·ªÅu ch√≠nh x√°c v√† an to√†n.', correct:false}
    ]},
    { level:2, type:'matching', question:'N·ªëi cho ƒë√∫ng', 
      columnA:['1. Bi·ªÉu t∆∞·ª£ng k√≠nh l√∫p üîç','2. Nh·∫•n Enter','3. T·ª´ kh√≥a'],
      columnB:['a. K·∫øt qu·∫£ t√¨m ki·∫øm xu·∫•t hi·ªán','b. Th·ª±c hi·ªán l·ªánh t√¨m ki·∫øm','c. Ch·ªß ƒë·ªÅ c·∫ßn t√¨m'],
      correctMatches:{'1. Bi·ªÉu t∆∞·ª£ng k√≠nh l√∫p üîç':'b. Th·ª±c hi·ªán l·ªánh t√¨m ki·∫øm','2. Nh·∫•n Enter':'a. K·∫øt qu·∫£ t√¨m ki·∫øm xu·∫•t hi·ªán','3. T·ª´ kh√≥a':'c. Ch·ªß ƒë·ªÅ c·∫ßn t√¨m'}
    },
    { level:2, type:'fill-in-blank', question:'Ch·ªçn v√† ƒëi·ªÅn t·ª´', 
      sentence:'a) Khi mu·ªën t√¨m th√¥ng tin, em nh·∫≠p [BLANK] v√†o √¥ t√¨m ki·∫øm. b) Tr√¨nh duy·ªát Web ph·ªï bi·∫øn l√† [BLANK].',
      hints:['t·ª´ kh√≥a','Google Chrome'],
      correctAnswers:['t·ª´ kh√≥a','Google Chrome']
    },

    { level:3, type:'multiple-choice', question:'Khi mu·ªën t√¨m th√¥ng tin v·ªÅ ‚Äúc√°ch chƒÉm s√≥c c√¢y hoa h·ªìng‚Äù, em n√™n:', options:[
      {text:'A. G√µ t·ª´ kh√≥a ‚ÄúchƒÉm s√≥c hoa h·ªìng‚Äù', correct:true},
      {text:'B. G√µ ‚ÄúchƒÉm s√≥c c√¢y‚Äù', correct:false},
      {text:'C. Ch·ªâ g√µ ‚Äúhoa‚Äù', correct:false},
      {text:'D. Kh√¥ng g√µ g√¨', correct:false}
    ]},
    { level:3, type:'fill-in-blank', question:'Ch·ªçn v√† ƒëi·ªÅn t·ª´', 
      sentence:'Khi th·∫•y trang Web c√≥ n·ªôi dung kh√¥ng ph√π h·ª£p, em n√™n [BLANK].',
      hints:['ƒë√≥ng trang l·∫°i v√† b√°o v·ªõi ng∆∞·ªùi l·ªõn'],
      correctAnswers:['ƒë√≥ng trang l·∫°i v√† b√°o v·ªõi ng∆∞·ªùi l·ªõn']
    },
    { level:3, type:'matching', question:'N·ªëi h√†nh ƒë·ªông v·ªõi vi·ªác l√†m ƒë√∫ng khi t√¨m ki·∫øm th√¥ng tin', 
      columnA:['1. T√¨m ki·∫øm b√†i h·ªçc To√°n','2. G·∫∑p qu·∫£ng c√°o kh√¥ng li√™n quan','3. C·∫ßn h√¨nh ·∫£nh thi√™n nhi√™n'],
      columnB:['a. Ch·ªçn trang gi√°o d·ª•c ƒë√°ng tin c·∫≠y','b. Kh√¥ng b·∫•m v√†o','c. D√πng ph·∫ßn ‚ÄúH√¨nh ·∫£nh‚Äù c·ªßa Google'],
      correctMatches:{'1. T√¨m ki·∫øm b√†i h·ªçc To√°n':'a. Ch·ªçn trang gi√°o d·ª•c ƒë√°ng tin c·∫≠y','2. G·∫∑p qu·∫£ng c√°o kh√¥ng li√™n quan':'b. Kh√¥ng b·∫•m v√†o','3. C·∫ßn h√¨nh ·∫£nh thi√™n nhi√™n':'c. D√πng ph·∫ßn ‚ÄúH√¨nh ·∫£nh‚Äù c·ªßa Google'}
    }
  ]
},
"B√†i 5": {
  title: "B√†i 5: Thao t√°c v·ªõi t·ªáp v√† th∆∞ m·ª•c",
  questions: [
    { level:1, type:'multiple-choice', question:'T·ªáp (file) l√† g√¨?', options:[
      {text:'A. L√† n∆°i l∆∞u tr·ªØ d·ªØ li·ªáu trong m√°y t√≠nh', correct:true},
      {text:'B. L√† thi·∫øt b·ªã nh·∫≠p d·ªØ li·ªáu', correct:false},
      {text:'C. L√† ch∆∞∆°ng tr√¨nh m√°y t√≠nh', correct:false},
      {text:'D. L√† m·∫°ng Internet', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Th∆∞ m·ª•c (folder) d√πng ƒë·ªÉ l√†m g√¨?', options:[
      {text:'A. ƒê·ªÉ g√µ vƒÉn b·∫£n', correct:false},
      {text:'B. ƒê·ªÉ ch·ª©a c√°c t·ªáp tin', correct:true},
      {text:'C. ƒê·ªÉ nghe nh·∫°c', correct:false},
      {text:'D. ƒê·ªÉ k·∫øt n·ªëi m·∫°ng', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Bi·ªÉu t∆∞·ª£ng n√†o th∆∞·ªùng d√πng ƒë·ªÉ m·ªü th∆∞ m·ª•c?', options:[
      {text:'A. üñºÔ∏è', correct:false},
      {text:'B. üìÇ', correct:true},
      {text:'C. üéß', correct:false},
      {text:'D. üíæ', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'ƒê·ªÉ m·ªü m·ªôt t·ªáp, em c·∫ßn th·ª±c hi·ªán thao t√°c n√†o?', options:[
      {text:'A. Nh·∫•n ƒë√∫p chu·ªôt tr√°i v√†o bi·ªÉu t∆∞·ª£ng t·ªáp', correct:true},
      {text:'B. Nh·∫•n chu·ªôt ph·∫£i', correct:false},
      {text:'C. K√©o t·ªáp ra ngo√†i m√†n h√¨nh', correct:false},
      {text:'D. T·∫Øt m√°y', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Khi em mu·ªën x√≥a m·ªôt t·ªáp kh√¥ng c·∫ßn thi·∫øt, em c√≥ th·ªÉ:', options:[
      {text:'A. Nh·∫•n Delete tr√™n b√†n ph√≠m', correct:true},
      {text:'B. Nh·∫•n Enter', correct:false},
      {text:'C. Nh·∫•n Ctrl + C', correct:false},
      {text:'D. Nh·∫•n Shift', correct:false}
    ]},
    { level:1, type:'multiple-choice', question:'Khi t·ªáp b·ªã x√≥a, t·ªáp s·∫Ω t·∫°m th·ªùi ƒë∆∞·ª£c ƒë∆∞a v√†o ƒë√¢u?', options:[
      {text:'A. Th∆∞ m·ª•c Documents', correct:false},
      {text:'B. Th√πng r√°c (Recycle Bin)', correct:true},
      {text:'C. ·ªî ƒëƒ©a D', correct:false},
      {text:'D. M√†n h√¨nh ch√≠nh', correct:false}
    ]},

    { level:2, type:'multiple-choice', question:'M·ª•c ƒë√≠ch c·ªßa vi·ªác t·∫°o th∆∞ m·ª•c m·ªõi l√† g√¨?', options:[
      {text:'A. ƒê·ªÉ l∆∞u t·∫°m', correct:false},
      {text:'B. ƒê·ªÉ s·∫Øp x·∫øp v√† qu·∫£n l√Ω c√°c t·ªáp d·ªÖ d√†ng h∆°n', correct:true},
      {text:'C. ƒê·ªÉ trang tr√≠ m√°y t√≠nh', correct:false},
      {text:'D. ƒê·ªÉ nghe nh·∫°c', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'ƒê·ªÉ ƒë·ªïi t√™n m·ªôt t·ªáp, em ch·ªçn t·ªáp v√† nh·∫•n:', options:[
      {text:'A. F2', correct:true},
      {text:'B. F1', correct:false},
      {text:'C. F5', correct:false},
      {text:'D. Delete', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'Khi sao ch√©p t·ªáp t·ª´ th∆∞ m·ª•c n√†y sang th∆∞ m·ª•c kh√°c, em d√πng t·ªï h·ª£p ph√≠m:', options:[
      {text:'A. Ctrl + X v√† Ctrl + V', correct:false},
      {text:'B. Ctrl + C v√† Ctrl + V', correct:true},
      {text:'C. Ctrl + A', correct:false},
      {text:'D. Shift + Delete', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'T·ªáp vƒÉn b·∫£n th∆∞·ªùng c√≥ ph·∫ßn m·ªü r·ªông l√†:', options:[
      {text:'A. .jpg', correct:false},
      {text:'B. .mp3', correct:false},
      {text:'C. .docx', correct:true},
      {text:'D. .png', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'T·ªáp h√¨nh ·∫£nh th∆∞·ªùng c√≥ ph·∫ßn m·ªü r·ªông l√†:', options:[
      {text:'A. .exe', correct:false},
      {text:'B. .png', correct:true},
      {text:'C. .txt', correct:false},
      {text:'D. .docx', correct:false}
    ]},
    { level:2, type:'multiple-choice', question:'ƒê·ªÉ xem n·ªôi dung c·ªßa m·ªôt t·ªáp, em c·∫ßn l√†m g√¨?', options:[
      {text:'A. Nh·∫•p ƒë√∫p v√†o t·ªáp', correct:true},
      {text:'B. X√≥a t·ªáp', correct:false},
      {text:'C. ƒê·ªïi t√™n t·ªáp', correct:false},
      {text:'D. Sao ch√©p t·ªáp', correct:false}
    ]},

    { level:3, type:'true-false', question:'ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
      {text:'a) Th∆∞ m·ª•c c√≥ th·ªÉ ch·ª©a nhi·ªÅu t·ªáp v√† th∆∞ m·ª•c con.', correct:true},
      {text:'b) Kh√¥ng th·ªÉ t·∫°o th∆∞ m·ª•c m·ªõi trong m√°y t√≠nh.', correct:false}
    ]},
    { level:3, type:'matching', question:'N·ªëi thao t√°c ·ªü c·ªôt A v·ªõi k·∫øt qu·∫£ ·ªü c·ªôt B', 
      columnA:['1. Ctrl + C','2. Ctrl + V','3. Ctrl + X','4. Delete'],
      columnB:['a. X√≥a t·ªáp','b. D√°n t·ªáp','c. Sao ch√©p t·ªáp','d. C·∫Øt t·ªáp'],
      correctMatches:{'1. Ctrl + C':'c. Sao ch√©p t·ªáp','2. Ctrl + V':'b. D√°n t·ªáp','3. Ctrl + X':'d. C·∫Øt t·ªáp','4. Delete':'a. X√≥a t·ªáp'}
    },
    { level:3, type:'fill-in-blank', question:'Ch·ªçn v√† ƒëi·ªÅn t·ª´', 
      sentence:'a) Khi t·∫°o th∆∞ m·ª•c m·ªõi, em ch·ªçn chu·ªôt ph·∫£i ‚Üí ch·ªçn [BLANK] ‚Üí ch·ªçn Folder. b) ƒê·ªÉ ƒë·ªïi t√™n t·ªáp, em c√≥ th·ªÉ nh·∫•n ph√≠m [BLANK] ho·∫∑c ch·ªçn Rename.',
      hints:['New','F2'],
      correctAnswers:['New','F2']
    }
  ]
}

  ,
    "B√†i 6": {
      title: "B√†i 6: S·ª≠ d·ª•ng ph·∫ßn m·ªÅm khi ƒë∆∞·ª£c ph√©p",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Ph·∫ßn m·ªÅm m√°y t√≠nh l√† g√¨?', options:[
          {text:'A. L√† thi·∫øt b·ªã ph·∫ßn c·ª©ng', correct:false},
          {text:'B. L√† t·∫≠p h·ª£p c√°c ch∆∞∆°ng tr√¨nh gi√∫p m√°y t√≠nh l√†m vi·ªác', correct:true},
          {text:'C. L√† tr√≤ ch∆°i ƒëi·ªán t·ª≠', correct:false},
          {text:'D. L√† d·ªØ li·ªáu trong m√°y', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: Khi s·ª≠ d·ª•ng ph·∫ßn m·ªÅm, em c·∫ßn tu√¢n th·ªß ƒëi·ªÅu g√¨?', options:[
          {text:'A. S·ª≠ d·ª•ng tho·∫£i m√°i, kh√¥ng c·∫ßn xin ph√©p', correct:false},
          {text:'B. Chia s·∫ª ph·∫ßn m·ªÅm cho b·∫°n b√®', correct:false},
          {text:'C. S·ª≠ d·ª•ng khi ƒë∆∞·ª£c ph√©p', correct:true},
          {text:'D. T·ª± √Ω c√†i ƒë·∫∑t ph·∫ßn m·ªÅm l·∫°', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Ph·∫ßn m·ªÅm c√≥ b·∫£n quy·ªÅn nghƒ©a l√† g√¨?', options:[
          {text:'A. L√† ph·∫ßn m·ªÅm mi·ªÖn ph√≠', correct:false},
          {text:'B. L√† ph·∫ßn m·ªÅm ph·∫£i tr·∫£ ph√≠ ho·∫∑c ƒë∆∞·ª£c c·∫•p ph√©p m·ªõi d√πng', correct:true},
          {text:'C. L√† ph·∫ßn m·ªÅm ai c≈©ng t·∫£i ƒë∆∞·ª£c', correct:false},
          {text:'D. L√† ph·∫ßn m·ªÅm b·ªã h·ªèng', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: Bi·ªÉu t∆∞·ª£ng c·ªßa b·∫£n quy·ªÅn ph·∫ßn m·ªÅm th∆∞·ªùng c√≥ k√Ω hi·ªáu:', options:[
          {text:'A. üÖ∞Ô∏è', correct:false},
          {text:'B. ¬©', correct:true},
          {text:'C. ¬Æ', correct:false},
          {text:'D. ‚Ñ¢', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 5: Em c√≥ th·ªÉ t·∫£i ph·∫ßn m·ªÅm t·ª´ ƒë√¢u ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n?', options:[
          {text:'A. Trang web ch√≠nh th·ª©c c·ªßa nh√† s·∫£n xu·∫•t', correct:true},
          {text:'B. C√°c trang kh√¥ng r√µ ngu·ªìn', correct:false},
          {text:'C. Qua b·∫°n b√® g·ª≠i', correct:false},
          {text:'D. Tr√™n m·∫°ng x√£ h·ªôi', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 6: Vi·ªác sao ch√©p ph·∫ßn m·ªÅm b·∫£n quy·ªÅn m√† kh√¥ng ƒë∆∞·ª£c ph√©p l√† h√†nh vi:', options:[
          {text:'A. ƒê√∫ng quy ƒë·ªãnh', correct:false},
          {text:'B. Vi ph·∫°m b·∫£n quy·ªÅn', correct:true},
          {text:'C. B√¨nh th∆∞·ªùng', correct:false},
          {text:'D. T·ªët v√¨ gi√∫p ti·∫øt ki·ªám', correct:false}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: V√¨ sao c·∫ßn d√πng ph·∫ßn m·ªÅm khi ƒë∆∞·ª£c ph√©p?', options:[
          {text:'A. V√¨ ƒë√≥ l√† quy ƒë·ªãnh ph√°p lu·∫≠t v√† gi√∫p tr√°nh vi ph·∫°m', correct:true},
          {text:'B. V√¨ ph·∫ßn m·ªÅm ƒë∆∞·ª£c ph√©p ch·∫°y nhanh h∆°n', correct:false},
          {text:'C. V√¨ ph·∫ßn m·ªÅm mi·ªÖn ph√≠ d·ªÖ d√πng h∆°n', correct:false},
          {text:'D. V√¨ b·∫°n b√® ƒë·ªÅu l√†m v·∫≠y', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Khi em mu·ªën c√†i ƒë·∫∑t ph·∫ßn m·ªÅm m·ªõi tr√™n m√°y t√≠nh ·ªü tr∆∞·ªùng, em n√™n l√†m g√¨?', options:[
          {text:'A. T·ª± c√†i ƒë·∫∑t lu√¥n', correct:false},
          {text:'B. H·ªèi √Ω ki·∫øn th·∫ßy c√¥ ho·∫∑c ng∆∞·ªùi ph·ª• tr√°ch', correct:true},
          {text:'C. Nh·ªù b·∫°n gi√∫p', correct:false},
          {text:'D. T·∫£i b·∫•t k·ª≥ ph·∫ßn m·ªÅm n√†o th·∫•y hay', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: N·∫øu ph·∫ßn m·ªÅm y√™u c·∫ßu tr·∫£ ph√≠, em n√™n l√†m g√¨?', options:[
          {text:'A. T√¨m b·∫£n sao mi·ªÖn ph√≠ tr√™n m·∫°ng', correct:false},
          {text:'B. B√°o ng∆∞·ªùi l·ªõn bi·∫øt v√† xin ph√©p tr∆∞·ªõc khi mua', correct:true},
          {text:'C. T·∫£i b·∫£n kh√°c', correct:false},
          {text:'D. B·ªè qua c·∫£nh b√°o', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: Ph·∫ßn m·ªÅm mi·ªÖn ph√≠ (free software) l√† g√¨?', options:[
          {text:'A. L√† ph·∫ßn m·ªÅm ƒë∆∞·ª£c d√πng v√† chia s·∫ª h·ª£p ph√°p', correct:true},
          {text:'B. L√† ph·∫ßn m·ªÅm kh√¥ng c√≥ b·∫£n quy·ªÅn', correct:false},
          {text:'C. L√† ph·∫ßn m·ªÅm ai c≈©ng t·ª± t·∫°o', correct:false},
          {text:'D. L√† ph·∫ßn m·ªÅm kh√¥ng an to√†n', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 11: Khi em sao ch√©p ph·∫ßn m·ªÅm c·ªßa ng∆∞·ªùi kh√°c m√† kh√¥ng xin ph√©p, em ƒë√£:', options:[
          {text:'A. L√†m ƒë√∫ng quy ƒë·ªãnh', correct:false},
          {text:'B. Vi ph·∫°m b·∫£n quy·ªÅn', correct:true},
          {text:'C. Gi√∫p ng∆∞·ªùi kh√°c ti·∫øt ki·ªám', correct:false},
          {text:'D. L√†m vi·ªác t·ªët', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 12: Em c√≥ th·ªÉ nh·∫≠n bi·∫øt ph·∫ßn m·ªÅm kh√¥ng an to√†n qua ƒë√¢u?', options:[
          {text:'A. Ngu·ªìn t·∫£i kh√¥ng r√µ r√†ng, c√≥ c·∫£nh b√°o virus', correct:true},
          {text:'B. C√≥ nhi·ªÅu m√†u s·∫Øc', correct:false},
          {text:'C. C√≥ h√¨nh con m√®o', correct:false},
          {text:'D. C√≥ bi·ªÉu t∆∞·ª£ng ƒë·∫πp', correct:false}
        ]},

        { level:3, type:'true-false', question:'C√¢u 13: ƒê√°nh d·∫•u ƒê√∫ng (ƒê) ho·∫∑c Sai (S)', statements:[
          {text:'a) Em c√≥ th·ªÉ chia s·∫ª ph·∫ßn m·ªÅm b·∫£n quy·ªÅn cho b·∫°n b√® m√† kh√¥ng c·∫ßn xin ph√©p.', correct:false},
          {text:'b) Khi t·∫£i ph·∫ßn m·ªÅm, em n√™n ch·ªçn ngu·ªìn ƒë√°ng tin c·∫≠y.', correct:true}
        ]},
        { level:3, type:'matching', question:'C√¢u 14: H√£y n·ªëi c·ªôt A v√† c·ªôt B sao cho ƒë√∫ng n·ªôi dung.', 
          columnA:['1. Mua ph·∫ßn m·ªÅm b·∫£n quy·ªÅn','2. T·∫£i ph·∫ßn m·ªÅm t·ª´ trang ch√≠nh th·ª©c','3. Sao ch√©p ph·∫ßn m·ªÅm l·∫≠u'],
          columnB:['a. Vi ph·∫°m b·∫£n quy·ªÅn','b. ƒê·∫£m b·∫£o an to√†n','c. Th·ª±c hi·ªán ƒë√∫ng quy ƒë·ªãnh'],
          correctMatches:{'1. Mua ph·∫ßn m·ªÅm b·∫£n quy·ªÅn':'c. Th·ª±c hi·ªán ƒë√∫ng quy ƒë·ªãnh','2. T·∫£i ph·∫ßn m·ªÅm t·ª´ trang ch√≠nh th·ª©c':'b. ƒê·∫£m b·∫£o an to√†n','3. Sao ch√©p ph·∫ßn m·ªÅm l·∫≠u':'a. Vi ph·∫°m b·∫£n quy·ªÅn'}
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 15: ƒêi·ªÅn c√°c t·ª´ th√≠ch h·ª£p v√†o ch·ªó tr·ªëng: (b·∫£n quy·ªÅn, cho ph√©p, ch√≠nh th·ª©c, vi ph·∫°m)', 
          sentence:'a) Ch·ªâ s·ª≠ d·ª•ng ph·∫ßn m·ªÅm khi ƒë∆∞·ª£c ng∆∞·ªùi kh√°c [BLANK]. b) Sao ch√©p ho·∫∑c chia s·∫ª ph·∫ßn m·ªÅm m√† kh√¥ng c√≥ [BLANK] l√† h√†nh vi [BLANK].',
          hints:['cho ph√©p','b·∫£n quy·ªÅn','vi ph·∫°m'], correctAnswers:['cho ph√©p','b·∫£n quy·ªÅn','vi ph·∫°m']
        }
      ]
    },
    "B√†i 7": {
      title: "B√†i 7: T·∫°o b√†i tr√¨nh chi·∫øu",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Ph·∫ßn m·ªÅm th∆∞·ªùng d√πng ƒë·ªÉ t·∫°o b√†i tr√¨nh chi·∫øu l√†:', options:[
          {text:'A. Word', correct:false},
          {text:'B. PowerPoint', correct:true},
          {text:'C. Excel', correct:false},
          {text:'D. Paint', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: M·ªôt b√†i tr√¨nh chi·∫øu g·ªìm nhi·ªÅu:', options:[
          {text:'A. Trang t√≠nh', correct:false},
          {text:'B. Trang v·∫Ω', correct:false},
          {text:'C. Trang chi·∫øu', correct:true},
          {text:'D. T·∫≠p tin', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Ch·ªçn bi·ªÉu t∆∞·ª£ng ph·∫ßn m·ªÅm d√πng ƒë·ªÉ t·∫°o b√†i tr√¨nh chi·∫øu:', options:[
          {text:'A. Word', correct:false},
          {text:'B. Excel', correct:false},
          {text:'C. PowerPoint', correct:true},
          {text:'D. Paint', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: T·∫≠p tin b√†i tr√¨nh chi·∫øu c√≥ ph·∫ßn m·ªü r·ªông l√†:', options:[
          {text:'.docx', correct:false},
          {text:'.pptx', correct:true},
          {text:'.xlsx', correct:false},
          {text:'.jpg', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: M·ªói b√†i tr√¨nh chi·∫øu ch·ªâ c√≥ th·ªÉ ch·ª©a m·ªôt trang chi·∫øu duy nh·∫•t.', statements:[
          {text:'(ƒê/S)', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 6: PowerPoint gi√∫p tr√¨nh b√†y n·ªôi dung b·∫±ng ch·ªØ, h√¨nh ·∫£nh v√† √¢m thanh.', statements:[
          {text:'(ƒê/S)', correct:true}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: Khi mu·ªën th√™m trang chi·∫øu m·ªõi, ta ch·ªçn:', options:[
          {text:'A. Insert ‚Üí New Slide', correct:false},
          {text:'B. Home ‚Üí New Slide', correct:true},
          {text:'C. File ‚Üí New', correct:false},
          {text:'D. View ‚Üí New Slide', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: ƒê·ªÉ thay ƒë·ªïi b·ªë c·ª•c trang chi·∫øu, ta ch·ªçn:', options:[
          {text:'A. Design', correct:false},
          {text:'B. Insert', correct:false},
          {text:'C. Layout', correct:true},
          {text:'D. Home', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: Trong PowerPoint, ƒë·ªÉ ch√®n h√¨nh ·∫£nh v√†o trang chi·∫øu, em ch·ªçn:', options:[
          {text:'A. Insert ‚Üí Picture', correct:true},
          {text:'B. Design ‚Üí Picture', correct:false},
          {text:'C. View ‚Üí Picture', correct:false},
          {text:'D. Slide Show ‚Üí Picture', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: Khi tr√¨nh chi·∫øu, nh·∫•n ph√≠m n√†o ƒë·ªÉ chuy·ªÉn sang trang chi·∫øu ti·∫øp theo?', options:[
          {text:'A. Enter', correct:true},
          {text:'B. Esc', correct:false},
          {text:'C. Space', correct:true},
          {text:'D. Backspace', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 11: N·ªëi c·ªôt A v·ªõi ch·ª©c nƒÉng t∆∞∆°ng ·ª©ng ·ªü c·ªôt B.', 
          columnA:['1. Slide Show','2. Design','3. Insert','4. Transitions'],
          columnB:['a. T·∫°o hi·ªáu ·ª©ng chuy·ªÉn trang chi·∫øu','b. Thay ƒë·ªïi m√†u n·ªÅn, ki·ªÉu tr√¨nh b√†y','c. Th√™m h√¨nh ·∫£nh, ch·ªØ, √¢m thanh','d. Tr√¨nh chi·∫øu b√†i thuy·∫øt tr√¨nh'],
          correctMatches:{'1. Slide Show':'d. Tr√¨nh chi·∫øu b√†i thuy·∫øt tr√¨nh','2. Design':'b. Thay ƒë·ªïi m√†u n·ªÅn, ki·ªÉu tr√¨nh b√†y','3. Insert':'c. Th√™m h√¨nh ·∫£nh, ch·ªØ, √¢m thanh','4. Transitions':'a. T·∫°o hi·ªáu ·ª©ng chuy·ªÉn trang chi·∫øu'}
        },

        { level:3, type:'fill-in-blank', question:'C√¢u 12: Khi mu·ªën l∆∞u l·∫°i b√†i tr√¨nh chi·∫øu, em ch·ªçn ( ‚Ä¶ ) ‚Üí Save.', 
          sentence:'Ch·ªçn [BLANK] ‚Üí Save ƒë·ªÉ l∆∞u b√†i tr√¨nh chi·∫øu.',
          hints:['File'], correctAnswers:['File']
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 13: ƒê·ªÉ ch·∫°y th·ª≠ b√†i tr√¨nh chi·∫øu, em ch·ªçn tab ( ‚Ä¶ ), sau ƒë√≥ nh·∫•n From Beginning.', 
          sentence:'Ch·ªçn tab [BLANK] ‚Üí From Beginning ƒë·ªÉ ch·∫°y th·ª≠ b√†i tr√¨nh chi·∫øu.',
          hints:['Slide Show'], correctAnswers:['Slide Show']
        },
        { level:3, type:'matching', question:'C√¢u 14: N·ªëi c√°c b∆∞·ªõc t·∫°o b√†i tr√¨nh chi·∫øu ƒë∆°n gi·∫£n theo tr√¨nh t·ª± h·ª£p l√Ω.', 
          columnA:['1.','','2.','','3.','','4.','','5.',''],
          columnB:['a. T·∫°o b√†i tr√¨nh chi·∫øu m·ªõi','b. L∆∞u v√† tr√¨nh chi·∫øu b√†i','c. M·ªü ph·∫ßn m·ªÅm PowerPoint','d. Nh·∫≠p ti√™u ƒë·ªÅ, th√™m c√°c trang chi·∫øu','e. Ch√®n h√¨nh ·∫£nh, ch·ªçn m√†u n·ªÅn v√† hi·ªáu ·ª©ng'],
          correctMatches:{'1.':'c. M·ªü ph·∫ßn m·ªÅm PowerPoint','2.':'a. T·∫°o b√†i tr√¨nh chi·∫øu m·ªõi','3.':'d. Nh·∫≠p ti√™u ƒë·ªÅ, th√™m c√°c trang chi·∫øu','4.':'e. Ch√®n h√¨nh ·∫£nh, ch·ªçn m√†u n·ªÅn v√† hi·ªáu ·ª©ng','5.':'b. L∆∞u v√† tr√¨nh chi·∫øu b√†i'}
        },
        { level:3, type:'multiple-choice', question:'C√¢u 15: √ù t∆∞·ªüng b√†i tr√¨nh chi·∫øu n√†o ph√π h·ª£p ƒë·ªÉ t·∫∑ng th·∫ßy c√¥ ho·∫∑c b·∫°n b√®?', options:[
          {text:'A. ‚ÄúL·ªùi tri √¢n th·∫ßy c√¥‚Äù v·ªõi h√¨nh ·∫£nh l·ªõp h·ªçc v√† nh·∫°c n·ªÅn nh·∫π nh√†ng', correct:true},
          {text:'B. ‚ÄúB√†i to√°n h√¨nh h·ªçc kh√≥ l·ªõp 12‚Äù', correct:false},
          {text:'C. ‚ÄúNg√†y h·ªôi ƒë·ªçc s√°ch c·ªßa l·ªõp em‚Äù', correct:true},
          {text:'D. ‚ÄúChuy·∫øn d√£ ngo·∫°i c·ªßa l·ªõp 4A‚Äù', correct:true}
        ]}
      ]
    },
    "B√†i 8": {
      title: "B√†i 8: ƒê·ªãnh d·∫°ng vƒÉn b·∫£n tr√™n trang chi·∫øu",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Ph·∫ßn m·ªÅm th∆∞·ªùng d√πng ƒë·ªÉ ƒë·ªãnh d·∫°ng vƒÉn b·∫£n tr√™n trang chi·∫øu l√†:', options:[
          {text:'A. Word', correct:false},
          {text:'B. PowerPoint', correct:true},
          {text:'C. Excel', correct:false},
          {text:'D. Paint', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: ƒê·ªÉ thay ƒë·ªïi ki·ªÉu/ch·ªØ (font), ta ch·ªçn th·∫ª:', options:[
          {text:'A. Design', correct:false},
          {text:'B. Home', correct:true},
          {text:'C. Icons', correct:false},
          {text:'D. Insert', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: ƒê·ªÉ thay ƒë·ªïi m√†u ch·ªØ, em ch·ªçn n√∫t c√≥ bi·ªÉu t∆∞·ª£ng:', options:[
          {text:'A. Ch·ªØ A c√≥ v·∫°ch m√†u b√™n d∆∞·ªõi', correct:true},
          {text:'B. B', correct:false},
          {text:'C. I', correct:false},
          {text:'D. U', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: ƒê·ªÉ l√†m ch·ªØ ƒë·∫≠m h∆°n, em ch·ªçn bi·ªÉu t∆∞·ª£ng:', options:[
          {text:'A. I', correct:false},
          {text:'B. B', correct:true},
          {text:'C. U', correct:false},
          {text:'D. A', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: Em c√≥ th·ªÉ ch·ªçn nhi·ªÅu d√≤ng vƒÉn b·∫£n r·ªìi ƒë·ªïi m√†u ch·ªØ c√πng l√∫c. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:true}
        ]},
        { level:1, type:'true-false', question:'C√¢u 6: Mu·ªën l√†m ch·ªØ nghi√™ng, ta ch·ªçn bi·ªÉu t∆∞·ª£ng ch·ªØ U. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:false}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: ƒê·ªÉ g·∫°ch ch√¢n ch·ªØ, em ch·ªçn bi·ªÉu t∆∞·ª£ng:', options:[
          {text:'A. I', correct:false},
          {text:'B. U', correct:true},
          {text:'C. B', correct:false},
          {text:'D. A', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Thay ƒë·ªïi c·ª° ch·ªØ gi√∫p vƒÉn b·∫£n tr√™n trang chi·∫øu:', options:[
          {text:'A. Kh√≥ ƒë·ªçc h∆°n', correct:false},
          {text:'B. D·ªÖ nh√¨n h∆°n', correct:true},
          {text:'C. M·∫•t ch·ªØ', correct:false},
          {text:'D. Kh√¥ng thay ƒë·ªïi', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: ƒê·ªïi m√†u n·ªÅn c·ªßa h·ªôp vƒÉn b·∫£n gi√∫p:', options:[
          {text:'A. VƒÉn b·∫£n n·ªïi b·∫≠t h∆°n', correct:true},
          {text:'B. X√≥a ch·ªØ', correct:false},
          {text:'C. M·∫•t n·ªÅn', correct:false},
          {text:'D. Kh√¥ng t√°c d·ª•ng', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: Khi ch·ªçn sai ƒë·ªãnh d·∫°ng, em c√≥ th·ªÉ:', options:[
          {text:'A. Nh·∫•n Ctrl + Z', correct:true},
          {text:'B. Nh·∫•n Delete', correct:false},
          {text:'C. Nh·∫•n Enter', correct:false},
          {text:'D. Nh·∫•n Shift', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 11: N·ªëi bi·ªÉu t∆∞·ª£ng ·ªü c·ªôt A v·ªõi ch·ª©c nƒÉng t∆∞∆°ng ·ª©ng ·ªü c·ªôt B.', 
          columnA:['1. B','2. I','3. U','4. A (m√†u)'],
          columnB:['a. L√†m nghi√™ng ch·ªØ','b. G·∫°ch ch√¢n ch·ªØ','c. L√†m ƒë·∫≠m ch·ªØ','d. Thay ƒë·ªïi m√†u ch·ªØ'],
          correctMatches:{'1. B':'c. L√†m ƒë·∫≠m ch·ªØ','2. I':'a. L√†m nghi√™ng ch·ªØ','3. U':'b. G·∫°ch ch√¢n ch·ªØ','4. A (m√†u)':'d. Thay ƒë·ªïi m√†u ch·ªØ'}
        },

        { level:3, type:'fill-in-blank', question:'C√¢u 12: ƒê·ªÉ tƒÉng k√≠ch th∆∞·ªõc ch·ªØ, em ch·ªçn nh√≥m l·ªánh ( ‚Ä¶ ) tr√™n th·∫ª Home.', 
          sentence:'Ch·ªçn nh√≥m [BLANK] tr√™n th·∫ª Home ƒë·ªÉ tƒÉng k√≠ch th∆∞·ªõc ch·ªØ.',
          hints:['Font'], correctAnswers:['Font']
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 13: Mu·ªën thay ƒë·ªïi m√†u ch·ªØ, em ch·ªçn n√∫t ( ‚Ä¶ ) c√≥ bi·ªÉu t∆∞·ª£ng ch·ªØ A v√† v·∫°ch m√†u b√™n d∆∞·ªõi.', 
          sentence:'Ch·ªçn [BLANK] ƒë·ªÉ ƒë·ªïi m√†u ch·ªØ.',
          hints:['Font Color'], correctAnswers:['Font Color']
        },
        { level:3, type:'matching', question:'C√¢u 14: N·ªëi th·ª© t·ª± c√°c b∆∞·ªõc ƒë·ªãnh d·∫°ng ti√™u ƒë·ªÅ ‚ÄúEm y√™u tr∆∞·ªùng em‚Äù ƒë·ªÉ n·ªïi b·∫≠t.', 
          columnA:['1.','','2.','','3.','','4.',''],
          columnB:['a. Ch·ªçn d√≤ng ch·ªØ ‚ÄúEm y√™u tr∆∞·ªùng em‚Äù','b. V√†o th·∫ª Home, ƒë·ªïi ki·ªÉu ch·ªØ, c·ª° l·ªõn, m√†u ƒë·ªè, l√†m ƒë·∫≠m','c. CƒÉn gi·ªØa ti√™u ƒë·ªÅ','d. Ki·ªÉm tra l·∫°i k·∫øt qu·∫£'],
          correctMatches:{'1.':'a. Ch·ªçn d√≤ng ch·ªØ ‚ÄúEm y√™u tr∆∞·ªùng em‚Äù','2.':'b. V√†o th·∫ª Home, ƒë·ªïi ki·ªÉu ch·ªØ, c·ª° l·ªõn, m√†u ƒë·ªè, l√†m ƒë·∫≠m','3.':'c. CƒÉn gi·ªØa ti√™u ƒë·ªÅ','4.':'d. Ki·ªÉm tra l·∫°i k·∫øt qu·∫£'}
        },
        { level:3, type:'multiple-choice', question:'C√¢u 15: C√°ch n√†o gi√∫p trang tr√≠ vƒÉn b·∫£n tr√™n trang chi·∫øu sinh ƒë·ªông h∆°n?', options:[
          {text:'A. D√πng nhi·ªÅu m√†u ch·ªØ h·ª£p l√Ω', correct:true},
          {text:'B. K·∫øt h·ª£p ch·ªØ ƒë·∫≠m, nghi√™ng, g·∫°ch ch√¢n ph√π h·ª£p', correct:true},
          {text:'C. Ch·ªçn ph√¥ng ngh·ªá thu·∫≠t v√† th√™m h√¨nh minh h·ªça', correct:true},
          {text:'D. D√πng m√†u ch·ªØ tr√πng v·ªõi m√†u n·ªÅn khi·∫øn kh√≥ ƒë·ªçc', correct:false}
        ]}
      ]
    }}, "L·ªõp 5": {
    "B√†i 1": {
      title: "B√†i 1: Em c√≥ th·ªÉ l√†m g√¨ v·ªõi m√°y t√≠nh",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: M√°y t√≠nh g·ªìm nh·ªØng b·ªô ph·∫≠n ch√≠nh n√†o?', options:[
          {text:'A. M√†n h√¨nh, b√†n ph√≠m, chu·ªôt', correct:false},
          {text:'B. CPU, m√†n h√¨nh, b√†n ph√≠m, chu·ªôt', correct:true},
          {text:'C. M√†n h√¨nh, m√°y in', correct:false},
          {text:'D. CPU, m√°y in', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: ƒê·ªÉ so·∫°n th·∫£o vƒÉn b·∫£n, ta c·∫ßn d√πng ph·∫ßn m·ªÅm n√†o?', options:[
          {text:'A. Paint', correct:false},
          {text:'B. Word', correct:true},
          {text:'C. Excel', correct:false},
          {text:'D. Tr√¨nh duy·ªát web', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Ph√≠m n√†o d√πng ƒë·ªÉ x√≥a k√Ω t·ª± ph√≠a tr∆∞·ªõc con tr·ªè?', options:[
          {text:'A. Space', correct:false},
          {text:'B. Backspace', correct:false},
          {text:'C. Delete', correct:true},
          {text:'D. Enter', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: Bi·ªÉu t∆∞·ª£ng n√†o d∆∞·ªõi ƒë√¢y gi√∫p em m·ªü tr√≤ ch∆°i tr√™n m√°y t√≠nh?', options:[
          {text:'A. üåê', correct:false},
          {text:'B. üéÆ', correct:true},
          {text:'C. üñºÔ∏è', correct:false},
          {text:'D. üìÑ', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: M√°y t√≠nh ch·ªâ c√≥ th·ªÉ d√πng ƒë·ªÉ ch∆°i tr√≤ ch∆°i. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 6: Khi s·ª≠ d·ª•ng m√°y t√≠nh, em n√™n ng·ªìi th·∫≥ng l∆∞ng, c√°ch m√†n h√¨nh kho·∫£ng 50 cm. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:true}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: Ho·∫°t ƒë·ªông n√†o sau ƒë√¢y kh√¥ng c·∫ßn s·ª≠ d·ª•ng m√°y t√≠nh?', options:[
          {text:'A. ƒê·ªçc s√°ch gi·∫•y', correct:true},
          {text:'B. So·∫°n th·∫£o vƒÉn b·∫£n', correct:false},
          {text:'C. Nghe nh·∫°c', correct:false},
          {text:'D. V·∫Ω tranh tr√™n m√°y', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Em d√πng chu·ªôt ƒë·ªÉ l√†m g√¨?', options:[
          {text:'A. Xem phim', correct:false},
          {text:'B. ƒêi·ªÅu khi·ªÉn v√† ch·ªçn l·ªánh tr√™n m√†n h√¨nh', correct:true},
          {text:'C. In t√†i li·ªáu', correct:false},
          {text:'D. G√µ vƒÉn b·∫£n', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: Khi mu·ªën l∆∞u b√†i v·∫Ω, em ch·ªçn l·ªánh n√†o?', options:[
          {text:'A. Save', correct:true},
          {text:'B. Open', correct:false},
          {text:'C. Exit', correct:false},
          {text:'D. Print', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: Bi·ªÉu t∆∞·ª£ng h√¨nh th√πng r√°c (üóëÔ∏è) c√≥ t√°c d·ª•ng g√¨?', options:[
          {text:'A. L∆∞u t·ªáp tin', correct:false},
          {text:'B. X√≥a t·ªáp tin', correct:true},
          {text:'C. In t√†i li·ªáu', correct:false},
          {text:'D. T·∫°o th∆∞ m·ª•c', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 11: N·ªëi c·ªôt A v·ªõi c·ªôt B sao cho ph√π h·ª£p.', 
          columnA:['1. So·∫°n th·∫£o vƒÉn b·∫£n','2. M·ªü tr√≤ ch∆°i','3. M·ªü tr√¨nh duy·ªát','4. V·∫Ω h√¨nh'],
          columnB:['a. G√µ ch·ªØ','b. Gi·∫£i tr√≠','c. T√¨m ki·∫øm th√¥ng tin','d. S√°ng t·∫°o ngh·ªá thu·∫≠t'],
          correctMatches:{'1. So·∫°n th·∫£o vƒÉn b·∫£n':'a. G√µ ch·ªØ','2. M·ªü tr√≤ ch∆°i':'b. Gi·∫£i tr√≠','3. M·ªü tr√¨nh duy·ªát':'c. T√¨m ki·∫øm th√¥ng tin','4. V·∫Ω h√¨nh':'d. S√°ng t·∫°o ngh·ªá thu·∫≠t'}
        },

        { level:3, type:'fill-in-blank', question:'C√¢u 12: ƒêi·ªÅn t·ª´ th√≠ch h·ª£p (nghe, xem, h·ªçc).', 
          sentence:'Em d√πng m√°y t√≠nh ƒë·ªÉ [BLANK] b√†i h√°t, [BLANK] phim, v√† [BLANK] b√†i h·ªçc tr√™n m·∫°ng.',
          hints:['nghe','xem','h·ªçc'], correctAnswers:['nghe','xem','h·ªçc']
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 13: ƒêi·ªÅn t·ª´ th√≠ch h·ª£p (b√°o c√¥ gi√°o, ng∆∞·ªùi l·ªõn).', 
          sentence:'Khi m√°y t√≠nh b·ªã treo, em c·∫ßn [BLANK] v√† nh·ªù [BLANK] gi√∫p ƒë·ª°.',
          hints:['b√°o c√¥ gi√°o','ng∆∞·ªùi l·ªõn'], correctAnswers:['b√°o c√¥ gi√°o','ng∆∞·ªùi l·ªõn']
        },
        { level:3, type:'multiple-choice', question:'C√¢u 14: M√°y t√≠nh gi√∫p em h·ªçc t·ªët h∆°n b·∫±ng c√°ch n√†o?', options:[
          {text:'A. Nghe nh·∫°c', correct:false},
          {text:'B. Tra c·ª©u b√†i h·ªçc', correct:true},
          {text:'C. Ch∆°i game', correct:false},
          {text:'D. G·ª≠i th∆∞', correct:false}
        ]},
        { level:3, type:'multiple-choice', question:'C√¢u 15: Khi m√°y t√≠nh g·∫∑p s·ª± c·ªë, em n√™n l√†m g√¨?', options:[
          {text:'A. G·ªçi ng∆∞·ªùi l·ªõn ho·∫∑c gi√°o vi√™n gi√∫p ƒë·ª°', correct:true},
          {text:'B. T·ª± th√°o m√°y ra xem', correct:false},
          {text:'C. ƒê·∫≠p b√†n ph√≠m', correct:false},
          {text:'D. B·ªè m·∫∑c m√°y', correct:false}
        ]}
      ]
    },
    "B√†i 2": {
      title: "B√†i 2: T√¨m ki·∫øm th√¥ng tin tr√™n websites",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Internet ƒë∆∞·ª£c d√πng ƒë·ªÉ l√†m g√¨?', options:[
          {text:'A. Ch∆°i tr√≤ ch∆°i offline', correct:false},
          {text:'B. T√¨m ki·∫øm v√† chia s·∫ª th√¥ng tin', correct:true},
          {text:'C. L∆∞u tr·ªØ t√†i li·ªáu c√° nh√¢n', correct:false},
          {text:'D. V·∫Ω tranh', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: ‚ÄúWebsite‚Äù l√† g√¨?', options:[
          {text:'A. Ph·∫ßn m·ªÅm so·∫°n th·∫£o vƒÉn b·∫£n', correct:false},
          {text:'B. Trang th√¥ng tin tr√™n Internet', correct:true},
          {text:'C. Tr√≤ ch∆°i tr·ª±c tuy·∫øn', correct:false},
          {text:'D. Thi·∫øt b·ªã ngo·∫°i vi', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: ƒê·ªÉ truy c·∫≠p m·ªôt website, em c·∫ßn c√≥:', options:[
          {text:'A. Chu·ªôt v√† b√†n ph√≠m', correct:false},
          {text:'B. Tr√¨nh duy·ªát web v√† k·∫øt n·ªëi Internet', correct:true},
          {text:'C. Ph·∫ßn m·ªÅm so·∫°n th·∫£o', correct:false},
          {text:'D. M√°y in v√† gi·∫•y', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: Bi·ªÉu t∆∞·ª£ng n√†o th∆∞·ªùng ƒë·∫°i di·ªán cho tr√¨nh duy·ªát web?', options:[
          {text:'A. üéÆ', correct:false},
          {text:'B. üåê', correct:true},
          {text:'C. üñ®Ô∏è', correct:false},
          {text:'D. üìÇ', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: Khi t√¨m ki·∫øm th√¥ng tin tr√™n Internet, em n√™n ƒë·ªçc k·ªπ v√† ch·ªçn ngu·ªìn ƒë√°ng tin c·∫≠y. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:true}
        ]},
        { level:1, type:'true-false', question:'C√¢u 6: M·ªçi th√¥ng tin tr√™n Internet ƒë·ªÅu ch√≠nh x√°c v√† c√≥ th·ªÉ chia s·∫ª l·∫°i m√† kh√¥ng c·∫ßn ki·ªÉm tra. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:false}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: ƒê·ªÉ t√¨m ki·∫øm th√¥ng tin nhanh nh·∫•t, em n√™n d√πng:', options:[
          {text:'A. Ph·∫ßn m·ªÅm v·∫Ω tranh', correct:false},
          {text:'B. C√¥ng c·ª• t√¨m ki·∫øm (nh∆∞ Google, C·ªëc C·ªëc)', correct:true},
          {text:'C. Tr√¨nh nghe nh·∫°c', correct:false},
          {text:'D. Tr√≤ ch∆°i tr·ª±c tuy·∫øn', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: T·ª´ kh√≥a trong t√¨m ki·∫øm l√† g√¨?', options:[
          {text:'A. C√¢u h·ªèi d√†i ƒë·∫ßy ƒë·ªß', correct:false},
          {text:'B. Nh·ªØng t·ª´ quan tr·ªçng gi√∫p t√¨m th√¥ng tin', correct:true},
          {text:'C. ƒê·ªãa ch·ªâ email', correct:false},
          {text:'D. M√£ ph·∫ßn m·ªÅm', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: Khi mu·ªën t√¨m h√¨nh ·∫£nh con m√®o, em n√™n g√µ t·ª´ kh√≥a n√†o?', options:[
          {text:'A. ‚ÄúH√¨nh ·∫£nh con m√®o‚Äù', correct:true},
          {text:'B. ‚ÄúT√¥i mu·ªën xem ·∫£nh con m√®o‚Äù', correct:false},
          {text:'C. ‚ÄúT√¥i y√™u m√®o l·∫Øm‚Äù', correct:false},
          {text:'D. ‚Äú·∫¢nh ƒë·∫πp‚Äù', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: Khi truy c·∫≠p m·ªôt website, ph·∫ßn ƒë·ªãa ch·ªâ n·∫±m ·ªü ƒë√¢u?', options:[
          {text:'A. Thanh c√¥ng c·ª•', correct:false},
          {text:'B. Thanh ƒë·ªãa ch·ªâ (Address bar)', correct:true},
          {text:'C. Trang ch·ªß', correct:false},
          {text:'D. B·∫£ng ƒëi·ªÅu khi·ªÉn', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 11: N·ªëi c·ªôt A v·ªõi c·ªôt B cho ƒë√∫ng.', 
          columnA:['1. Google','2. Youtube','3. Wikipedia','4. C·ªëc C·ªëc'],
          columnB:['a. C√¥ng c·ª• t√¨m ki·∫øm','b. Xem v√† chia s·∫ª video','c. Tra c·ª©u ki·∫øn th·ª©c','d. Tr√¨nh duy·ªát c·ªßa Vi·ªát Nam'],
          correctMatches:{'1. Google':'a. C√¥ng c·ª• t√¨m ki·∫øm','2. Youtube':'b. Xem v√† chia s·∫ª video','3. Wikipedia':'c. Tra c·ª©u ki·∫øn th·ª©c','4. C·ªëc C·ªëc':'d. Tr√¨nh duy·ªát c·ªßa Vi·ªát Nam'}
        },
        { level:2, type:'matching', question:'C√¢u 12: N·ªëi bi·ªÉu t∆∞·ª£ng v·ªõi √Ω nghƒ©a.', 
          columnA:['1. üîç','2. üåê','3. ‚è≥','4. üè†'],
          columnB:['a. T√¨m ki·∫øm','b. Truy c·∫≠p Internet','c. ƒêang t·∫£i trang','d. Trang ch·ªß Website'],
          correctMatches:{'1. üîç':'a. T√¨m ki·∫øm','2. üåê':'b. Truy c·∫≠p Internet','3. ‚è≥':'c. ƒêang t·∫£i trang','4. üè†':'d. Trang ch·ªß Website'}
        },

        { level:3, type:'fill-in-blank', question:'C√¢u 13: Khi mu·ªën t√¨m th√¥ng tin v·ªÅ ‚Äúl·ªãch s·ª≠ Vi·ªát Nam‚Äù, em g√µ t·ª´ kh√≥a ‚Äú________‚Äù v√†o √¥ t√¨m ki·∫øm c·ªßa Google.', 
          sentence:'G√µ t·ª´ kh√≥a ‚Äú[BLANK]‚Äù ƒë·ªÉ t√¨m th√¥ng tin v·ªÅ ‚Äúl·ªãch s·ª≠ Vi·ªát Nam‚Äù.',
          hints:['l·ªãch s·ª≠ Vi·ªát Nam'], correctAnswers:['l·ªãch s·ª≠ Vi·ªát Nam']
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 14: Tr∆∞·ªõc khi t·∫£i m·ªôt h√¨nh ·∫£nh t·ª´ Internet v·ªÅ m√°y t√≠nh, em c·∫ßn ________ v√† ________ xem n·ªôi dung c√≥ ph√π h·ª£p kh√¥ng.', 
          sentence:'Tr∆∞·ªõc khi t·∫£i h√¨nh ·∫£nh: h√£y [BLANK] v√† [BLANK] xem n·ªôi dung c√≥ ph√π h·ª£p.',
          hints:['xin ph√©p','ki·ªÉm tra'], correctAnswers:['xin ph√©p','ki·ªÉm tra']
        },
        { level:3, type:'multiple-choice', question:'C√¢u 15: V√≠ d·ª• v·ªÅ s·ª≠ d·ª•ng Internet an to√†n v√† h·ªØu √≠ch trong h·ªçc t·∫≠p l√†:', options:[
          {text:'A. T·∫£i ph·∫ßn m·ªÅm l·∫° t·ª´ trang kh√¥ng r√µ ngu·ªìn g·ªëc', correct:false},
          {text:'B. T√¨m b√†i h·ªçc tr√™n m·ªôt n·ªÅn t·∫£ng gi√°o d·ª•c d√†nh cho tr·∫ª em', correct:true},
          {text:'C. Chia s·∫ª th√¥ng tin ch∆∞a ki·ªÉm ch·ª©ng', correct:false},
          {text:'D. Truy c·∫≠p trang ng∆∞·ªùi l·ªõn', correct:false}
        ]}
      ]
    },
    "B√†i 3": {
      title: "B√†i 3: T√¨m ki·∫øm th√¥ng tin trong gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Khi g·∫∑p m·ªôt v·∫•n ƒë·ªÅ c·∫ßn gi·∫£i quy·∫øt, vi·ªác ƒë·∫ßu ti√™n em n√™n l√†m l√†:', options:[
          {text:'A. T√¨m ngay c√¢u tr·∫£ l·ªùi tr√™n m·∫°ng', correct:false},
          {text:'B. X√°c ƒë·ªãnh r√µ v·∫•n ƒë·ªÅ c·∫ßn t√¨m hi·ªÉu', correct:true},
          {text:'C. Sao ch√©p th√¥ng tin t·ª´ b·∫°n b√®', correct:false},
          {text:'D. H·ªèi ng∆∞·ªùi l·ªõn m√† kh√¥ng t√¨m hi·ªÉu g√¨', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: T√¨m ki·∫øm th√¥ng tin gi√∫p em:', options:[
          {text:'A. Gi·∫£i tr√≠ m·ªói ng√†y', correct:false},
          {text:'B. Nhanh ch√≥ng c√≥ nhi·ªÅu ki·∫øn th·ª©c h∆°n', correct:false},
          {text:'C. Gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ h·ªçc t·∫≠p v√† ƒë·ªùi s·ªëng', correct:true},
          {text:'D. Kh√¥ng c·∫ßn suy nghƒ©', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Khi g√µ t·ª´ kh√≥a t√¨m ki·∫øm, em n√™n:', options:[
          {text:'A. G√µ th·∫≠t d√†i v√† c√≥ d·∫•u ch·∫•m c√¢u', correct:false},
          {text:'B. G√µ c√°c t·ª´ kh√≥a ch√≠nh li√™n quan ƒë·∫øn v·∫•n ƒë·ªÅ', correct:true},
          {text:'C. G√µ c·∫£ c√¢u h·ªèi', correct:false},
          {text:'D. G√µ t·ª´ kh√¥ng li√™n quan', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: Bi·ªÉu t∆∞·ª£ng n√†o d∆∞·ªõi ƒë√¢y l√† c·ªßa tr√¨nh duy·ªát web?', options:[
          {text:'A. üñ•Ô∏è', correct:false},
          {text:'B. üåê', correct:true},
          {text:'C. üìÑ', correct:false},
          {text:'D. üíæ', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: Khi t√¨m ki·∫øm th√¥ng tin, ch·ªâ c·∫ßn ch·ªçn k·∫øt qu·∫£ ƒë·∫ßu ti√™n l√† ƒë·ªß.', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 6: Google, Bing, C·ªëc C·ªëc l√† c√°c c√¥ng c·ª• t√¨m ki·∫øm ph·ªï bi·∫øn.', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:true}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: V√¨ sao c·∫ßn x√°c ƒë·ªãnh m·ª•c ti√™u t√¨m ki·∫øm tr∆∞·ªõc khi tra c·ª©u?', options:[
          {text:'A. ƒê·ªÉ kh√¥ng t·ªën th·ªùi gian v√†o n·ªôi dung kh√¥ng c·∫ßn thi·∫øt', correct:true},
          {text:'B. ƒê·ªÉ g√µ t·ª´ kh√≥a ng·∫Øn h∆°n', correct:false},
          {text:'C. V√¨ trang web y√™u c·∫ßu', correct:false},
          {text:'D. V√¨ kh√¥ng c√≥ m·∫°ng', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Khi ƒë·ªçc th√¥ng tin tr√™n m·∫°ng, em n√™n:', options:[
          {text:'A. Tin t·∫•t c·∫£ c√°c n·ªôi dung hi·ªÉn th·ªã', correct:false},
          {text:'B. Ki·ªÉm tra ngu·ªìn th√¥ng tin v√† ƒë·ªëi chi·∫øu t·ª´ nhi·ªÅu trang', correct:true},
          {text:'C. Ch·ªâ xem h√¨nh ·∫£nh', correct:false},
          {text:'D. B·ªè qua n·ªôi dung d√†i', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: T·ª´ kh√≥a n√†o ph√π h·ª£p nh·∫•t khi mu·ªën t√¨m hi·ªÉu v·ªÅ ‚ÄúB·∫£o v·ªá m√¥i tr∆∞·ªùng‚Äù?', options:[
          {text:'A. ‚ÄúT·∫°i sao ph·∫£i b·∫£o v·ªá m√¥i tr∆∞·ªùng ·ªü Vi·ªát Nam‚Äù', correct:false},
          {text:'B. ‚ÄúM√¥i tr∆∞·ªùng‚Äù', correct:false},
          {text:'C. ‚ÄúC√°ch b·∫£o v·ªá m√¥i tr∆∞·ªùng‚Äù', correct:true},
          {text:'D. ‚ÄúH·ªçc sinh l√†m g√¨ ƒë·ªÉ b·∫£o v·ªá m√¥i tr∆∞·ªùng‚Äù', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: Khi em mu·ªën t√¨m h√¨nh ·∫£nh, em n√™n ch·ªçn:', options:[
          {text:'A. M·ª•c ‚ÄúVideo‚Äù', correct:false},
          {text:'B. M·ª•c ‚ÄúH√¨nh ·∫£nh‚Äù', correct:true},
          {text:'C. M·ª•c ‚ÄúTin t·ª©c‚Äù', correct:false},
          {text:'D. M·ª•c ‚ÄúT·∫•t c·∫£‚Äù', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 11: N·ªëi c·ªôt A v·ªõi c·ªôt B sao cho ƒë√∫ng.', 
          columnA:['1. T·ª´ kh√≥a','2. Tr√¨nh duy·ªát','3. K·∫øt qu·∫£ t√¨m ki·∫øm'],
          columnB:['a. D√≤ng ch·ªØ m√¥ t·∫£ n·ªôi dung t√¨m ki·∫øm','b. Ph·∫ßn m·ªÅm d√πng ƒë·ªÉ truy c·∫≠p Internet','c. C√°c trang web hi·ªÉn th·ªã sau khi tra c·ª©u'],
          correctMatches:{'1. T·ª´ kh√≥a':'a. D√≤ng ch·ªØ m√¥ t·∫£ n·ªôi dung t√¨m ki·∫øm','2. Tr√¨nh duy·ªát':'b. Ph·∫ßn m·ªÅm d√πng ƒë·ªÉ truy c·∫≠p Internet','3. K·∫øt qu·∫£ t√¨m ki·∫øm':'c. C√°c trang web hi·ªÉn th·ªã sau khi tra c·ª©u'}
        },
        { level:2, type:'matching', question:'C√¢u 12: N·ªëi lo·∫°i th√¥ng tin v·ªõi c√°ch s·ª≠ d·ª•ng ph√π h·ª£p.', 
          columnA:['1. VƒÉn b·∫£n','2. H√¨nh ·∫£nh','3. Video'],
          columnB:['a. Xem h∆∞·ªõng d·∫´n ho·∫∑c tin t·ª©c','b. Quan s√°t minh h·ªça, v√≠ d·ª• tr·ª±c quan','c. Xem c√°ch th·ª±c hi·ªán ho·∫∑c th√≠ nghi·ªám'],
          correctMatches:{'1. VƒÉn b·∫£n':'a. Xem h∆∞·ªõng d·∫´n ho·∫∑c tin t·ª©c','2. H√¨nh ·∫£nh':'b. Quan s√°t minh h·ªça, v√≠ d·ª• tr·ª±c quan','3. Video':'c. Xem c√°ch th·ª±c hi·ªán ho·∫∑c th√≠ nghi·ªám'}
        },

        { level:3, type:'fill-in-blank', question:'C√¢u 13: Khi mu·ªën t√¨m th√¥ng tin ch√≠nh x√°c, em n√™n s·ª≠ d·ª•ng (‚Ä¶‚Ä¶‚Ä¶) r√µ r√†ng v√† ng·∫Øn g·ªçn.', 
          sentence:'Em n√™n d√πng [BLANK] r√µ r√†ng v√† ng·∫Øn g·ªçn khi t√¨m ki·∫øm.',
          hints:['t·ª´ kh√≥a'], correctAnswers:['t·ª´ kh√≥a']
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 14: N·∫øu th·∫•y hai trang web c√≥ th√¥ng tin kh√°c nhau, em c·∫ßn (‚Ä¶‚Ä¶‚Ä¶) v√† (‚Ä¶‚Ä¶‚Ä¶) ƒë·ªÉ ch·ªçn th√¥ng tin ƒë√∫ng.', 
          sentence:'Khi hai trang web kh√°c nhau, h√£y [BLANK] v√† [BLANK] ngu·ªìn ƒë·ªÉ ch·ªçn th√¥ng tin ƒë√∫ng.',
          hints:['ƒë·ªëi chi·∫øu','ki·ªÉm tra'], correctAnswers:['ƒë·ªëi chi·∫øu','ki·ªÉm tra']
        },
        { level:3, type:'multiple-choice', question:'C√¢u 15: Ch·ªçn c√°ch l√†m t·ªët nh·∫•t khi t√¨m th√¥ng tin v·ªÅ ‚ÄúBi·∫øn ƒë·ªïi kh√≠ h·∫≠u‚Äù.', options:[
          {text:'A. T√¨m v·ªõi t·ª´ kh√≥a ‚ÄúBi·∫øn ƒë·ªïi kh√≠ h·∫≠u l√† g√¨‚Äù v√† ch·ªçn trang c·ªßa B·ªô T√†i nguy√™n v√† M√¥i tr∆∞·ªùng', correct:true},
          {text:'B. M·ªü trang b·∫•t k·ª≥ c√≥ nhi·ªÅu h√¨nh ·∫£nh', correct:false},
          {text:'C. Ch·ªâ h·ªèi b·∫°n b√®', correct:false},
          {text:'D. Ch·ªçn k·∫øt qu·∫£ ƒë·∫ßu ti√™n kh√¥ng c·∫ßn ƒë·ªçc', correct:false}
        ]}
      ]
    },
    "B√†i 4": {
      title: "B√†i 4: C√¢y th∆∞ m·ª•c",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Th∆∞ m·ª•c l√† g√¨?', options:[
          {text:'A. M·ªôt lo·∫°i ph·∫ßn m·ªÅm tr√™n m√°y t√≠nh', correct:false},
          {text:'B. N∆°i l∆∞u tr·ªØ v√† s·∫Øp x·∫øp c√°c t·ªáp tin, th∆∞ m·ª•c con', correct:true},
          {text:'C. M·ªôt t·∫≠p tin ch·ª©a h√¨nh ·∫£nh', correct:false},
          {text:'D. M·ªôt tr√¨nh duy·ªát web', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: C√¢y th∆∞ m·ª•c l√† g√¨?', options:[
          {text:'A. C√°ch v·∫Ω s∆° ƒë·ªì c√¢y trong Word', correct:false},
          {text:'B. S∆° ƒë·ªì th·ªÉ hi·ªán m·ªëi quan h·ªá gi·ªØa c√°c th∆∞ m·ª•c v√† t·ªáp tin', correct:true},
          {text:'C. Danh s√°ch c√°c ph·∫ßn m·ªÅm tr√™n m√°y', correct:false},
          {text:'D. H√¨nh ·∫£nh minh h·ªça c√¢y th·ª±c v·∫≠t', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Trong c√¢y th∆∞ m·ª•c, th∆∞ m·ª•c l·ªõn nh·∫•t ƒë∆∞·ª£c g·ªçi l√†:', options:[
          {text:'A. Th∆∞ m·ª•c g·ªëc', correct:true},
          {text:'B. Th∆∞ m·ª•c con', correct:false},
          {text:'C. Th∆∞ m·ª•c m·∫π', correct:false},
          {text:'D. Th∆∞ m·ª•c ch·ª©a', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: M·ªôt th∆∞ m·ª•c c√≥ th·ªÉ ch·ª©a:', options:[
          {text:'A. Ch·ªâ m·ªôt t·ªáp tin', correct:false},
          {text:'B. Nhi·ªÅu t·ªáp tin v√† th∆∞ m·ª•c con', correct:true},
          {text:'C. Ch·ªâ th∆∞ m·ª•c con', correct:false},
          {text:'D. Ch·ªâ h√¨nh ·∫£nh', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: Trong c√¢y th∆∞ m·ª•c, th∆∞ m·ª•c m·∫π ch·ª©a c√°c th∆∞ m·ª•c con. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:true}
        ]},
        { level:1, type:'true-false', question:'C√¢u 6: M·ªói t·ªáp tin ch·ªâ c√≥ th·ªÉ n·∫±m trong nhi·ªÅu th∆∞ m·ª•c kh√°c nhau. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:false}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: C√¢y th∆∞ m·ª•c gi√∫p em:', options:[
          {text:'A. Xem phim v√† ch∆°i game d·ªÖ h∆°n', correct:false},
          {text:'B. S·∫Øp x·∫øp, qu·∫£n l√Ω d·ªØ li·ªáu khoa h·ªçc', correct:true},
          {text:'C. TƒÉng t·ªëc ƒë·ªô m·∫°ng Internet', correct:false},
          {text:'D. Ch·∫°y ch∆∞∆°ng tr√¨nh nhanh h∆°n', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Trong ƒë∆∞·ªùng d·∫´n ‚ÄúD:\\HOC TAP\\TIN HOC\\Bai 4.docx‚Äù, th∆∞ m·ª•c con l√†:', options:[
          {text:'A. D:\\', correct:false},
          {text:'B. HOC TAP', correct:false},
          {text:'C. TIN HOC', correct:true},
          {text:'D. Bai 4.docx', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: Th∆∞ m·ª•c con c·ªßa th∆∞ m·ª•c ‚ÄúHinhAnh‚Äù c√≥ th·ªÉ l√†:', options:[
          {text:'A. HinhAnh.docx', correct:false},
          {text:'B. HinhAnh2', correct:true},
          {text:'C. HinhAnh.jpg', correct:false},
          {text:'D. HinhAnh.txt', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: Trong c√¢y th∆∞ m·ª•c, c√°c th∆∞ m·ª•c con c√πng c·∫•p th∆∞·ªùng ƒë∆∞·ª£c g·ªçi l√†:', options:[
          {text:'A. Th∆∞ m·ª•c cha', correct:false},
          {text:'B. Th∆∞ m·ª•c anh em', correct:true},
          {text:'C. Th∆∞ m·ª•c ch√≠nh', correct:false},
          {text:'D. Th∆∞ m·ª•c g·ªëc', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 11: N·ªëi kh√°i ni·ªám ·ªü c·ªôt A v·ªõi m√¥ t·∫£ ·ªü c·ªôt B.', 
          columnA:['1. Th∆∞ m·ª•c g·ªëc','2. Th∆∞ m·ª•c m·∫π','3. Th∆∞ m·ª•c con'],
          columnB:['a. Ch·ª©a c√°c th∆∞ m·ª•c con, l√† th∆∞ m·ª•c cao nh·∫•t','b. L√† th∆∞ m·ª•c ch·ª©a c√°c th∆∞ m·ª•c nh·ªè h∆°n','c. N·∫±m trong th∆∞ m·ª•c m·∫π'],
          correctMatches:{'1. Th∆∞ m·ª•c g·ªëc':'a. Ch·ª©a c√°c th∆∞ m·ª•c con, l√† th∆∞ m·ª•c cao nh·∫•t','2. Th∆∞ m·ª•c m·∫π':'b. L√† th∆∞ m·ª•c ch·ª©a c√°c th∆∞ m·ª•c nh·ªè h∆°n','3. Th∆∞ m·ª•c con':'c. N·∫±m trong th∆∞ m·ª•c m·∫π'}
        },
        { level:2, type:'matching', question:'C√¢u 12: N·ªëi bi·ªÉu t∆∞·ª£ng v·ªõi √Ω nghƒ©a t∆∞∆°ng ·ª©ng.', 
          columnA:['1. üìÅ','2. üñºÔ∏è','3. üìÑ'],
          columnB:['a. Th∆∞ m·ª•c','b. T·ªáp h√¨nh ·∫£nh','c. T·ªáp vƒÉn b·∫£n'],
          correctMatches:{'1. üìÅ':'a. Th∆∞ m·ª•c','2. üñºÔ∏è':'b. T·ªáp h√¨nh ·∫£nh','3. üìÑ':'c. T·ªáp vƒÉn b·∫£n'}
        },

        { level:3, type:'fill-in-blank', question:'C√¢u 13: Trong ƒë∆∞·ªùng d·∫´n ‚ÄúC:\\HocTap\\Toan‚Äù, ‚ÄúC:‚Äù l√† (‚Ä¶‚Ä¶‚Ä¶..), ‚ÄúHocTap‚Äù l√† (‚Ä¶‚Ä¶‚Ä¶..).', 
          sentence:'‚ÄúC:‚Äù l√† [BLANK], ‚ÄúHocTap‚Äù l√† [BLANK].',
          hints:['·ªï ƒëƒ©a','th∆∞ m·ª•c m·∫π'], correctAnswers:['·ªï ƒëƒ©a','th∆∞ m·ª•c m·∫π']
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 14: T·∫°o th∆∞ m·ª•c m·ªõi: b·∫•m chu·ªôt ph·∫£i ‚Üí ch·ªçn (‚Ä¶‚Ä¶‚Ä¶..) ‚Üí (‚Ä¶‚Ä¶‚Ä¶..).', 
          sentence:'Chu·ªôt ph·∫£i ‚Üí [BLANK] ‚Üí [BLANK] ƒë·ªÉ t·∫°o th∆∞ m·ª•c m·ªõi.',
          hints:['New','Folder'], correctAnswers:['New','Folder']
        },
        { level:3, type:'multiple-choice', question:'C√¢u 15: Ch·ªçn c√°ch s·∫Øp x·∫øp th∆∞ m·ª•c h·ªçc t·∫≠p h·ª£p l√Ω nh·∫•t.', options:[
          {text:'A. D:\\HocTap\\Toan\\Bai1.docx; D:\\HocTap\\TinHoc\\Bai3.docx; D:\\HocTap\\TiengViet\\Bai2.docx', correct:true},
          {text:'B. D:\\HocTap\\Bai1.docx; D:\\HinhAnh\\Bai2.docx; D:\\Game\\Bai3.docx', correct:false},
          {text:'C. D:\\Bai1.docx; D:\\Bai2.docx; D:\\Bai3.docx', correct:false},
          {text:'D. D:\\HocTap\\Toan.docx; D:\\HocTap\\TinHoc.docx (ƒë·∫∑t t·∫•t c·∫£ b√†i v√†o 2 t·ªáp l·ªõn)', correct:false}
        ]}
      ]
    },
    "B√†i 5": {
      title: "B√†i 5: B·∫£n quy·ªÅn n·ªôi dung th√¥ng tin",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: ‚ÄúB·∫£n quy·ªÅn‚Äù l√† g√¨?', options:[
          {text:'A. Quy·ªÅn s·ª≠ d·ª•ng m√°y t√≠nh c√° nh√¢n', correct:false},
          {text:'B. Quy·ªÅn c·ªßa ng∆∞·ªùi s√°ng t·∫°o ra n·ªôi dung ho·∫∑c s·∫£n ph·∫©m', correct:true},
          {text:'C. Quy·ªÅn t·∫£i ph·∫ßn m·ªÅm mi·ªÖn ph√≠', correct:false},
          {text:'D. Quy·ªÅn c·ªßa ng∆∞·ªùi xem th√¥ng tin', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: Khi mu·ªën s·ª≠ d·ª•ng h√¨nh ·∫£nh c·ªßa ng∆∞·ªùi kh√°c, em n√™n l√†m g√¨?', options:[
          {text:'A. T·∫£i v·ªÅ v√† d√πng lu√¥n', correct:false},
          {text:'B. H·ªèi √Ω ki·∫øn v√† ghi r√µ ngu·ªìn g·ªëc', correct:true},
          {text:'C. Sao ch√©p m√† kh√¥ng c·∫ßn xin ph√©p', correct:false},
          {text:'D. S·ª≠a l·∫°i m·ªôt ch√∫t r·ªìi s·ª≠ d·ª•ng', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: H√†nh vi n√†o sau ƒë√¢y l√† vi ph·∫°m b·∫£n quy·ªÅn?', options:[
          {text:'A. T·ª± s√°ng t·∫°o b√†i h√°t c·ªßa m√¨nh', correct:false},
          {text:'B. T·∫£i phim c√≥ b·∫£n quy·ªÅn t·ª´ trang l·∫≠u', correct:true},
          {text:'C. Ghi r√µ ngu·ªìn khi tr√≠ch d·∫´n', correct:false},
          {text:'D. Mua ph·∫ßn m·ªÅm b·∫£n quy·ªÅn', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: K√Ω hi·ªáu n√†o th∆∞·ªùng th·ªÉ hi·ªán n·ªôi dung c√≥ b·∫£n quy·ªÅn?', options:[
          {text:'A. ‚ÑπÔ∏è', correct:false},
          {text:'B. üÖøÔ∏è', correct:false},
          {text:'C. ¬©', correct:true},
          {text:'D. ‚Ñ¢', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: S·ª≠ d·ª•ng ph·∫ßn m·ªÅm mi·ªÖn ph√≠ th√¨ kh√¥ng c·∫ßn quan t√¢m ƒë·∫øn b·∫£n quy·ªÅn. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 6: Khi ƒëƒÉng ·∫£nh b·∫°n b√® l√™n m·∫°ng, em c·∫ßn ƒë∆∞·ª£c s·ª± ƒë·ªìng √Ω c·ªßa h·ªç. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:true}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: V√¨ sao c·∫ßn t√¥n tr·ªçng b·∫£n quy·ªÅn n·ªôi dung th√¥ng tin?', options:[
          {text:'A. ƒê·ªÉ b·∫£o v·ªá quy·ªÅn l·ª£i ng∆∞·ªùi s√°ng t·∫°o v√† khuy·∫øn kh√≠ch s√°ng t·∫°o', correct:true},
          {text:'B. ƒê·ªÉ d√πng Internet nhanh h∆°n', correct:false},
          {text:'C. V√¨ lu·∫≠t ph√°p b·∫Øt bu·ªôc', correct:false},
          {text:'D. ƒê·ªÉ tr√°nh virus m√°y t√≠nh', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Khi em ch√©p m·ªôt ƒëo·∫°n vƒÉn tr√™n m·∫°ng v√†o b√†i l√†m, em c·∫ßn:', options:[
          {text:'A. X√≥a t√™n t√°c gi·∫£', correct:false},
          {text:'B. Kh√¥ng c·∫ßn ghi ngu·ªìn', correct:false},
          {text:'C. Ghi r√µ ngu·ªìn tr√≠ch d·∫´n', correct:true},
          {text:'D. Sao ch√©p to√†n b·ªô m√† kh√¥ng ch·ªânh s·ª≠a', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: Trong c√°c ph·∫ßn m·ªÅm sau, ph·∫ßn m·ªÅm n√†o c·∫ßn mua b·∫£n quy·ªÅn?', options:[
          {text:'A. Microsoft Word', correct:true},
          {text:'B. Paint', correct:false},
          {text:'C. Notepad', correct:false},
          {text:'D. Calculator', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: Khi mu·ªën chia s·∫ª m·ªôt b√†i h√°t l√™n m·∫°ng, em n√™n:', options:[
          {text:'A. Ghi r√µ t√™n ca sƒ© v√† nh·∫°c sƒ©', correct:true},
          {text:'B. Ghi ‚ÄúS∆∞u t·∫ßm tr√™n m·∫°ng‚Äù l√† ƒë·ªß', correct:false},
          {text:'C. D√πng t√†i kho·∫£n ·∫©n danh', correct:false},
          {text:'D. Kh√¥ng c·∫ßn ghi ngu·ªìn', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 11: N·ªëi n·ªôi dung ·ªü c·ªôt A v·ªõi h√†nh ƒë·ªông ph√π h·ª£p ·ªü c·ªôt B.', 
          columnA:['1. S·ª≠ d·ª•ng h√¨nh ·∫£nh ng∆∞·ªùi kh√°c','2. Vi·∫øt b√†i s√°ng t·∫°o c·ªßa ri√™ng m√¨nh','3. Sao ch√©p b√†i vi·∫øt tr√™n m·∫°ng'],
          columnB:['a. Xin ph√©p v√† ghi ngu·ªìn','b. T√¥n tr·ªçng b·∫£n quy·ªÅn','c. C·∫ßn tr√≠ch d·∫´n r√µ ngu·ªìn'],
          correctMatches:{'1. S·ª≠ d·ª•ng h√¨nh ·∫£nh ng∆∞·ªùi kh√°c':'a. Xin ph√©p v√† ghi ngu·ªìn','2. Vi·∫øt b√†i s√°ng t·∫°o c·ªßa ri√™ng m√¨nh':'b. T√¥n tr·ªçng b·∫£n quy·ªÅn','3. Sao ch√©p b√†i vi·∫øt tr√™n m·∫°ng':'c. C·∫ßn tr√≠ch d·∫´n r√µ ngu·ªìn'}
        },
        { level:2, type:'matching', question:'C√¢u 12: N·ªëi bi·ªÉu t∆∞·ª£ng v·ªõi √Ω nghƒ©a ƒë√∫ng.', 
          columnA:['1. ¬©','2. ‚Ñ¢','3. ‚ÑπÔ∏è'],
          columnB:['a. B·∫£n quy·ªÅn','b. Th∆∞∆°ng hi·ªáu','c. Th√¥ng tin'],
          correctMatches:{'1. ¬©':'a. B·∫£n quy·ªÅn','2. ‚Ñ¢':'b. Th∆∞∆°ng hi·ªáu','3. ‚ÑπÔ∏è':'c. Th√¥ng tin'}
        },

        { level:3, type:'fill-in-blank', question:'C√¢u 13: Khi mu·ªën s·ª≠ d·ª•ng n·ªôi dung tr√™n m·∫°ng, em c·∫ßn ________ v√† ________ ngu·ªìn r√µ r√†ng.', 
          sentence:'Em c·∫ßn [BLANK] v√† [BLANK] ngu·ªìn r√µ r√†ng khi s·ª≠ d·ª•ng n·ªôi dung tr√™n m·∫°ng.',
          hints:['xin ph√©p','ghi'], correctAnswers:['xin ph√©p','ghi']
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 14: N·∫øu th·∫•y b·∫°n chia s·∫ª phim c√≥ b·∫£n quy·ªÅn m√† kh√¥ng ƒë∆∞·ª£c ph√©p, em n√™n ________ ho·∫∑c ________.', 
          sentence:'N·∫øu th·∫•y b·∫°n chia s·∫ª phim c√≥ b·∫£n quy·ªÅn, h√£y [BLANK] ho·∫∑c [BLANK].',
          hints:['nh·∫Øc b·∫°n d·ª´ng l·∫°i','b√°o v·ªõi ng∆∞·ªùi l·ªõn'], correctAnswers:['nh·∫Øc b·∫°n d·ª´ng l·∫°i','b√°o v·ªõi ng∆∞·ªùi l·ªõn']
        },
        { level:3, type:'multiple-choice', question:'C√¢u 15: V√≠ d·ª• n√†o th·ªÉ hi·ªán em t√¥n tr·ªçng b·∫£n quy·ªÅn?', options:[
          {text:'A. Ghi r√µ ngu·ªìn ·∫£nh khi l√†m b√†i thuy·∫øt tr√¨nh', correct:true},
          {text:'B. T·∫£i ph·∫ßn m·ªÅm l·∫≠u ƒë·ªÉ d√πng t·∫°m', correct:false},
          {text:'C. Chia s·∫ª b√†i h√°t b·∫£n quy·ªÅn m√† kh√¥ng ghi ngu·ªìn', correct:false},
          {text:'D. ƒêƒÉng ·∫£nh b·∫°n b√® m√† kh√¥ng xin ph√©p', correct:false}
        ]}
      ]
    },
    "B√†i 6": {
      title: "B√†i 6: ƒê·ªãnh d·∫°ng k√Ω t·ª± v√† b·ªë tr√≠ h√¨nh ·∫£nh vƒÉn b·∫£n",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: ƒê·ªÉ in ƒë·∫≠m ch·ªØ trong vƒÉn b·∫£n, em ch·ªçn n√∫t l·ªánh n√†o?', options:[
          {text:'A. I', correct:false},
          {text:'B. B', correct:true},
          {text:'C. U', correct:false},
          {text:'D. A', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: Ph√≠m t·∫Øt Ctrl + I d√πng ƒë·ªÉ:', options:[
          {text:'A. In ƒë·∫≠m ch·ªØ', correct:false},
          {text:'B. In nghi√™ng ch·ªØ', correct:true},
          {text:'C. G·∫°ch ch√¢n ch·ªØ', correct:false},
          {text:'D. TƒÉng c·ª° ch·ªØ', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Mu·ªën thay ƒë·ªïi c·ª° ch·ªØ, em th·ª±c hi·ªán trong nh√≥m l·ªánh n√†o?', options:[
          {text:'A. Paragraph', correct:false},
          {text:'B. Clipboard', correct:false},
          {text:'C. Font', correct:true},
          {text:'D. Insert', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 4: a) N√∫t l·ªánh B d√πng ƒë·ªÉ in nghi√™ng ch·ªØ.  b) C√≥ th·ªÉ ch·ªçn nhi·ªÅu ki·ªÉu ƒë·ªãnh d·∫°ng c√πng l√∫c cho m·ªôt ƒëo·∫°n vƒÉn b·∫£n. (ƒê/S)', statements:[
          {text:'a) N√∫t l·ªánh B d√πng ƒë·ªÉ in nghi√™ng ch·ªØ.', correct:false},
          {text:'b) C√≥ th·ªÉ ch·ªçn nhi·ªÅu ki·ªÉu ƒë·ªãnh d·∫°ng c√πng l√∫c cho m·ªôt ƒëo·∫°n vƒÉn b·∫£n.', correct:true}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 5: Ch·ª©c nƒÉng c·ªßa n√∫t l·ªánh U l√† g√¨?', options:[
          {text:'A. G·∫°ch ch√¢n ch·ªØ', correct:true},
          {text:'B. In ƒë·∫≠m ch·ªØ', correct:false},
          {text:'C. In nghi√™ng ch·ªØ', correct:false},
          {text:'D. T√¥ m√†u ch·ªØ', correct:false}
        ]},
        { level:1, type:'fill-in-blank', question:'C√¢u 6: Khi mu·ªën thay ƒë·ªïi m√†u ch·ªØ, ta ch·ªçn n√∫t l·ªánh c√≥ bi·ªÉu t∆∞·ª£ng ch·ªØ A v√† m·ªôt ______ ·ªü d∆∞·ªõi.', 
          sentence:'Ch·ªçn n√∫t A c√≥ v·∫°ch [BLANK] ·ªü d∆∞·ªõi ƒë·ªÉ ƒë·ªïi m√†u ch·ªØ.',
          hints:['m√†u s·∫Øc'], correctAnswers:['m√†u s·∫Øc']
        },

        { level:2, type:'multiple-choice', question:'C√¢u 7: ƒê·ªÉ ch√®n h√¨nh ·∫£nh v√†o vƒÉn b·∫£n, ta ch·ªçn th·∫ª l·ªánh n√†o trong Word?', options:[
          {text:'A. Home', correct:false},
          {text:'B. Insert', correct:true},
          {text:'C. Layout', correct:false},
          {text:'D. Design', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Sau khi ch√®n h√¨nh ·∫£nh, mu·ªën di chuy·ªÉn h√¨nh ƒë·∫øn v·ªã tr√≠ kh√°c, ta c·∫ßn:', options:[
          {text:'A. Nh·∫•n chu·ªôt ph·∫£i ‚Üí Copy h√¨nh', correct:false},
          {text:'B. Nh·∫•n chu·ªôt tr√°i v√† k√©o h√¨nh ƒë·∫øn ch·ªó m·ªõi', correct:true},
          {text:'C. Nh·∫•n Enter ƒë·ªÉ h√¨nh t·ª± di chuy·ªÉn', correct:false},
          {text:'D. Kh√¥ng th·ªÉ di chuy·ªÉn h√¨nh', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 9: N·ªëi ch·ª©c nƒÉng ·ªü c·ªôt A v·ªõi n√∫t l·ªánh t∆∞∆°ng ·ª©ng ·ªü c·ªôt B.', 
          columnA:['1. In nghi√™ng ch·ªØ','2. G·∫°ch ch√¢n ch·ªØ','3. In ƒë·∫≠m ch·ªØ'],
          columnB:['a. U','b. B','c. I'],
          correctMatches:{'1. In nghi√™ng ch·ªØ':'c. I','2. G·∫°ch ch√¢n ch·ªØ':'a. U','3. In ƒë·∫≠m ch·ªØ':'b. B'}
        },
        { level:2, type:'multiple-choice', question:'C√¢u 10: Ch·ª©c nƒÉng Wrap Text d√πng ƒë·ªÉ:', options:[
          {text:'A. Ch√®n h√¨nh ·∫£nh', correct:false},
          {text:'B. CƒÉn/b·ªë tr√≠ h√¨nh ·∫£nh so v·ªõi vƒÉn b·∫£n', correct:true},
          {text:'C. T√¥ m√†u ch·ªØ', correct:false},
          {text:'D. Sao ch√©p h√¨nh', correct:false}
        ]},
        { level:2, type:'true-false', question:'C√¢u 11: a) H√¨nh ·∫£nh trong vƒÉn b·∫£n kh√¥ng th·ªÉ ph√≥ng to ho·∫∑c thu nh·ªè.  b) C√≥ th·ªÉ b·ªë tr√≠ h√¨nh ·∫£nh n·∫±m b√™n tr√°i, ph·∫£i ho·∫∑c gi·ªØa vƒÉn b·∫£n. (ƒê/S)', statements:[
          {text:'a) H√¨nh ·∫£nh kh√¥ng th·ªÉ ph√≥ng to ho·∫∑c thu nh·ªè.', correct:false},
          {text:'b) C√≥ th·ªÉ b·ªë tr√≠ h√¨nh ·∫£nh tr√°i/ph·∫£i/gi·ªØa vƒÉn b·∫£n.', correct:true}
        ]},
        { level:2, type:'fill-in-blank', question:'C√¢u 12: Khi mu·ªën h√¨nh ·∫£nh n·∫±m gi·ªØa vƒÉn b·∫£n, ta ch·ªçn ki·ªÉu b·ªë tr√≠ ‚Ä¶‚Ä¶ trong c√¥ng c·ª• Wrap Text.', 
          sentence:'Ch·ªçn ki·ªÉu [BLANK] trong Wrap Text ƒë·ªÉ h√¨nh ·ªü gi·ªØa vƒÉn b·∫£n.',
          hints:['Centered'], correctAnswers:['Centered']
        },

        { level:3, type:'multiple-choice', question:'C√¢u 13: Em c√≥ m·ªôt b·ª©c ·∫£nh ch√®n v√†o vƒÉn b·∫£n b·ªã qu√° to, l√†m l·ªách b·ªë c·ª•c trang. Em n√™n l√†m g√¨?', options:[
          {text:'A. Xo√° h√¨nh ƒëi', correct:false},
          {text:'B. K√©o c√°c g√≥c c·ªßa h√¨nh ƒë·ªÉ thu nh·ªè l·∫°i', correct:true},
          {text:'C. Ch√®n l·∫°i ·∫£nh kh√°c', correct:false},
          {text:'D. ƒê·ªïi m√†u h√¨nh', correct:false}
        ]},
        { level:3, type:'matching', question:'C√¢u 14: N·ªëi t√¨nh hu·ªëng v·ªõi thao t√°c ph√π h·ª£p.', 
          columnA:['1. Mu·ªën l√†m n·ªïi b·∫≠t ti√™u ƒë·ªÅ','2. Mu·ªën vƒÉn b·∫£n bao quanh h√¨nh','3. Mu·ªën h√¨nh ·∫£nh n·∫±m gi·ªØa ƒëo·∫°n'],
          columnB:['a. Ch·ªçn Wrap Text ‚Üí Square','b. Ch·ªçn n√∫t B trong nh√≥m Font','c. CƒÉn gi·ªØa (Align Center)'],
          correctMatches:{'1. Mu·ªën l√†m n·ªïi b·∫≠t ti√™u ƒë·ªÅ':'b. Ch·ªçn n√∫t B trong nh√≥m Font','2. Mu·ªën vƒÉn b·∫£n bao quanh h√¨nh':'a. Ch·ªçn Wrap Text ‚Üí Square','3. Mu·ªën h√¨nh ·∫£nh n·∫±m gi·ªØa ƒëo·∫°n':'c. CƒÉn gi·ªØa (Align Center)'}
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 15: Ho√†n th√†nh h∆∞·ªõng d·∫´n: Insert ‚Üí ‚Ä¶‚Ä¶ ‚Üí This Device ‚Üí ch·ªçn ·∫£nh ‚Üí Insert.', 
          sentence:'Insert ‚Üí [BLANK] ‚Üí This Device ‚Üí ch·ªçn ·∫£nh ‚Üí Insert.',
          hints:['Picture'], correctAnswers:['Picture']
        }
      ]
    },
    "B√†i 7": {
      title: "B√†i 7: Th·ª±c h√†nh so·∫°n th·∫£o vƒÉn b·∫£n",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Ph·∫ßn m·ªÅm n√†o d√πng ƒë·ªÉ so·∫°n th·∫£o vƒÉn b·∫£n?', options:[
          {text:'A. Paint', correct:false},
          {text:'B. Word', correct:true},
          {text:'C. Excel', correct:false},
          {text:'D. PowerPoint', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: ƒê·ªÉ g√µ ch·ªØ hoa nhanh, em nh·∫•n ph√≠m n√†o c√πng l√∫c v·ªõi ch·ªØ?', options:[
          {text:'A. Tab', correct:false},
          {text:'B. Shift', correct:true},
          {text:'C. Ctrl', correct:false},
          {text:'D. Alt', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Ph√≠m Enter c√≥ t√°c d·ª•ng:', options:[
          {text:'A. T·∫°o d√≤ng m·ªõi', correct:true},
          {text:'B. X√≥a k√Ω t·ª±', correct:false},
          {text:'C. CƒÉn l·ªÅ', correct:false},
          {text:'D. L∆∞u vƒÉn b·∫£n', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: ƒê·ªÉ l∆∞u vƒÉn b·∫£n, em ch·ªçn:', options:[
          {text:'A. File ‚Üí Save', correct:true},
          {text:'B. File ‚Üí New', correct:false},
          {text:'C. File ‚Üí Open', correct:false},
          {text:'D. File ‚Üí Print', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: N√™n ƒë·∫∑t t√™n t·ªáp c√≥ d·∫•u ti·∫øng Vi·ªát cho d·ªÖ ƒë·ªçc. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 6: C√≥ th·ªÉ d√πng chu·ªôt ƒë·ªÉ b√¥i ƒëen (ch·ªçn) m·ªôt ƒëo·∫°n vƒÉn b·∫£n. (ƒê/S)', statements:[
          {text:'(ƒê√∫ng/Sai)', correct:true}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: Khi mu·ªën s·ª≠a l·ªói ch√≠nh t·∫£, em c√≥ th·ªÉ:', options:[
          {text:'A. Nh·∫•n Delete ƒë·ªÉ x√≥a k√Ω t·ª± sai', correct:true},
          {text:'B. D√πng c√¥ng c·ª• v·∫Ω h√¨nh', correct:false},
          {text:'C. Ch√®n ·∫£nh', correct:false},
          {text:'D. T·∫°o th∆∞ m·ª•c m·ªõi', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Khi sai ch√≠nh t·∫£, th∆∞·ªùng xu·∫•t hi·ªán g·∫°ch ch√¢n m√†u g√¨ d∆∞·ªõi ch·ªØ?', options:[
          {text:'A. ƒê·ªè', correct:true},
          {text:'B. Xanh', correct:false},
          {text:'C. V√†ng', correct:false},
          {text:'D. X√°m', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: Ch·ªçn to√†n b·ªô vƒÉn b·∫£n l√† t·ªï h·ª£p:', options:[
          {text:'A. Ctrl + X', correct:false},
          {text:'B. Ctrl + C', correct:false},
          {text:'C. Ctrl + A', correct:true},
          {text:'D. Ctrl + V', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 10: In ƒë·∫≠m ƒëo·∫°n vƒÉn b·∫£n b·∫±ng t·ªï h·ª£p:', options:[
          {text:'A. Ctrl + U', correct:false},
          {text:'B. Ctrl + I', correct:false},
          {text:'C. Ctrl + B', correct:true},
          {text:'D. Ctrl + D', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 11: N·ªëi thao t√°c v·ªõi ch·ª©c nƒÉng t∆∞∆°ng ·ª©ng.', 
          columnA:['1. Ctrl + S','2. Ctrl + C','3. Ctrl + V','4. Ctrl + X'],
          columnB:['a. L∆∞u vƒÉn b·∫£n','b. Sao ch√©p ƒëo·∫°n ch·ªçn','c. D√°n n·ªôi dung ƒë√£ sao ch√©p','d. C·∫Øt ƒëo·∫°n vƒÉn b·∫£n'],
          correctMatches:{'1. Ctrl + S':'a. L∆∞u vƒÉn b·∫£n','2. Ctrl + C':'b. Sao ch√©p ƒëo·∫°n ch·ªçn','3. Ctrl + V':'c. D√°n n·ªôi dung ƒë√£ sao ch√©p','4. Ctrl + X':'d. C·∫Øt ƒëo·∫°n vƒÉn b·∫£n'}
        },
        { level:2, type:'matching', question:'C√¢u 12: N·ªëi bi·ªÉu t∆∞·ª£ng v·ªõi √Ω nghƒ©a trong Word.', 
          columnA:['1. B','2. I','3. U'],
          columnB:['a. In nghi√™ng ch·ªØ','b. G·∫°ch ch√¢n ch·ªØ','c. In ƒë·∫≠m ch·ªØ'],
          correctMatches:{'1. B':'c. In ƒë·∫≠m ch·ªØ','2. I':'a. In nghi√™ng ch·ªØ','3. U':'b. G·∫°ch ch√¢n ch·ªØ'}
        },

        { level:3, type:'fill-in-blank', question:'C√¢u 13: ƒê·ªÉ g√µ ti·∫øng Vi·ªát c√≥ d·∫•u, em b·∫≠t ph·∫ßn m·ªÅm ( ‚Ä¶ ) v√† ch·ªçn ki·ªÉu g√µ ( ‚Ä¶ ).', 
          sentence:'B·∫≠t [BLANK] v√† ch·ªçn [BLANK] ƒë·ªÉ g√µ ti·∫øng Vi·ªát c√≥ d·∫•u.',
          hints:['Unikey','Telex'], correctAnswers:['Unikey','Telex']
        },
        { level:3, type:'fill-in-blank', question:'C√¢u 14: Khi ho√†n th√†nh vƒÉn b·∫£n, em n√™n ( ‚Ä¶ ) ƒë·ªÉ l∆∞u l·∫°i v√† ( ‚Ä¶ ) ƒë·ªÉ n·ªôp b√†i.', 
          sentence:'Nh·∫•n [BLANK] ƒë·ªÉ l∆∞u b√†i v√† [BLANK] ƒë·ªÉ n·ªôp cho gi√°o vi√™n.',
          hints:['Ctrl + S','g·ª≠i qua th∆∞ ho·∫∑c USB'], correctAnswers:['Ctrl + S','g·ª≠i qua th∆∞ ho·∫∑c USB']
        },
        { level:3, type:'multiple-choice', question:'C√¢u 15: V√≠ d·ª• n√†o sau ƒë√¢y th·ªÉ hi·ªán vi·ªác em s·ª≠ d·ª•ng k·ªπ nƒÉng so·∫°n th·∫£o vƒÉn b·∫£n trong h·ªçc t·∫≠p?', options:[
          {text:'A. Vi·∫øt b·∫£n b√°o c√°o v√† ch√®n h√¨nh ·∫£nh minh h·ªça', correct:true},
          {text:'B. Ch∆°i tr√≤ ch∆°i tr√™n m√°y t√≠nh', correct:false},
          {text:'C. V·∫Ω tranh tr√™n gi·∫•y', correct:false},
          {text:'D. Xem video gi·∫£i tr√≠', correct:false}
        ]}
      ]
    },
    "B√†i 8": {
      title: "B√†i 8: L√†m quen v·ªõi ph·∫ßn m·ªÅm ƒë·ªì h·ªça",
      questions: [
        { level:1, type:'multiple-choice', question:'C√¢u 1: Ph·∫ßn m·ªÅm ƒë·ªì h·ªça l√† g√¨?', options:[
          {text:'A. Ph·∫ßn m·ªÅm ƒë·ªÉ nghe nh·∫°c.', correct:false},
          {text:'B. Ph·∫ßn m·ªÅm ƒë·ªÉ v·∫Ω, thi·∫øt k·∫ø h√¨nh ·∫£nh.', correct:true},
          {text:'C. Ph·∫ßn m·ªÅm ƒë·ªÉ g√µ vƒÉn b·∫£n.', correct:false},
          {text:'D. Ph·∫ßn m·ªÅm ƒë·ªÉ ch∆°i game.', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 2: Ph·∫ßn m·ªÅm ƒë·ªì h·ªça th∆∞·ªùng d√πng ƒë·ªÉ:', options:[
          {text:'A. So·∫°n th·∫£o vƒÉn b·∫£n.', correct:false},
          {text:'B. T·∫°o v√† ch·ªânh s·ª≠a h√¨nh ·∫£nh.', correct:true},
          {text:'C. G·ª≠i email.', correct:false},
          {text:'D. L∆∞u tr·ªØ d·ªØ li·ªáu.', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 3: Trong c√°c ph·∫ßn m·ªÅm sau, ƒë√¢u l√† ph·∫ßn m·ªÅm ƒë·ªì h·ªça?', options:[
          {text:'A. Paint', correct:true},
          {text:'B. Word', correct:false},
          {text:'C. Excel', correct:false},
          {text:'D. PowerPoint', correct:false}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 4: C√¥ng c·ª• b√∫t ch√¨ (Pencil) trong ph·∫ßn m·ªÅm ƒë·ªì h·ªça d√πng ƒë·ªÉ:', options:[
          {text:'A. T√¥ m√†u v√πng ch·ªçn', correct:false},
          {text:'B. Vi·∫øt ch·ªØ', correct:false},
          {text:'C. V·∫Ω ƒë∆∞·ªùng n√©t t·ª± do', correct:true},
          {text:'D. X√≥a h√¨nh', correct:false}
        ]},
        { level:1, type:'true-false', question:'C√¢u 5: a) Ph·∫ßn m·ªÅm ƒë·ªì h·ªça ch·ªâ d√πng ƒë·ªÉ xem ·∫£nh.  b) Ta c√≥ th·ªÉ t·∫°o h√¨nh v·∫Ω m·ªõi trong ph·∫ßn m·ªÅm ƒë·ªì h·ªça. (ƒê/S)', statements:[
          {text:'a) Ph·∫ßn m·ªÅm ƒë·ªì h·ªça ch·ªâ d√πng ƒë·ªÉ xem ·∫£nh.', correct:false},
          {text:'b) Ta c√≥ th·ªÉ t·∫°o h√¨nh v·∫Ω m·ªõi trong ph·∫ßn m·ªÅm ƒë·ªì h·ªça.', correct:true}
        ]},
        { level:1, type:'multiple-choice', question:'C√¢u 6: ƒê·ªÉ m·ªü ph·∫ßn m·ªÅm Paint, em ch·ªçn:', options:[
          {text:'A. Start ‚Üí Accessories ‚Üí Paint', correct:true},
          {text:'B. Start ‚Üí Documents', correct:false},
          {text:'C. Start ‚Üí Settings', correct:false},
          {text:'D. Start ‚Üí Music', correct:false}
        ]},

        { level:2, type:'multiple-choice', question:'C√¢u 7: C√¥ng c·ª• Fill with color (th√πng s∆°n) c√≥ ch·ª©c nƒÉng:', options:[
          {text:'A. T√¥ m√†u cho v√πng ƒë∆∞·ª£c ch·ªçn.', correct:true},
          {text:'B. X√≥a h√¨nh v·∫Ω.', correct:false},
          {text:'C. Di chuy·ªÉn h√¨nh.', correct:false},
          {text:'D. Vi·∫øt ch·ªØ.', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 8: Mu·ªën v·∫Ω m·ªôt h√¨nh tr√≤n ƒë·ªÅu trong Paint, ta ph·∫£i:', options:[
          {text:'A. Gi·ªØ ph√≠m Shift khi k√©o chu·ªôt v·ªõi c√¥ng c·ª• elip.', correct:true},
          {text:'B. Gi·ªØ ph√≠m Ctrl khi k√©o chu·ªôt.', correct:false},
          {text:'C. Gi·ªØ ph√≠m Alt khi k√©o chu·ªôt.', correct:false},
          {text:'D. Ch·ªâ c·∫ßn nh·∫•p chu·ªôt m·ªôt l·∫ßn.', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 9: Bi·ªÉu t∆∞·ª£ng ch·ªØ A trong Paint d√πng ƒë·ªÉ:', options:[
          {text:'A. Vi·∫øt ch·ªØ l√™n h√¨nh.', correct:true},
          {text:'B. V·∫Ω ƒë∆∞·ªùng th·∫≥ng.', correct:false},
          {text:'C. T√¥ m√†u.', correct:false},
          {text:'D. Ph√≥ng to h√¨nh.', correct:false}
        ]},
        { level:2, type:'matching', question:'C√¢u 10: N·ªëi c√¥ng c·ª• v·ªõi ch·ª©c nƒÉng t∆∞∆°ng ·ª©ng.', 
          columnA:['1. Eraser','2. Pencil','3. Fill color'],
          columnB:['a. T√¥ m√†u','b. X√≥a n√©t v·∫Ω','c. V·∫Ω t·ª± do'],
          correctMatches:{'1. Eraser':'b. X√≥a n√©t v·∫Ω','2. Pencil':'c. V·∫Ω t·ª± do','3. Fill color':'a. T√¥ m√†u'}
        },
        { level:2, type:'true-false', question:'C√¢u 11: a) Ta c√≥ th·ªÉ l∆∞u h√¨nh v·∫Ω th√†nh t·ªáp ·∫£nh.  b) Khi v·∫Ω sai, kh√¥ng th·ªÉ quay l·∫°i b∆∞·ªõc tr∆∞·ªõc. (ƒê/S)', statements:[
          {text:'a) Ta c√≥ th·ªÉ l∆∞u h√¨nh v·∫Ω th√†nh t·ªáp ·∫£nh.', correct:true},
          {text:'b) Khi v·∫Ω sai, kh√¥ng th·ªÉ quay l·∫°i b∆∞·ªõc tr∆∞·ªõc.', correct:false}
        ]},
        { level:2, type:'multiple-choice', question:'C√¢u 12: ƒê·ªÉ l∆∞u h√¨nh v·∫Ω trong ph·∫ßn m·ªÅm ƒë·ªì h·ªça, ta ch·ªçn:', options:[
          {text:'A. File ‚Üí Save', correct:true},
          {text:'B. Home ‚Üí Copy', correct:false},
          {text:'C. Edit ‚Üí Paste', correct:false},
          {text:'D. File ‚Üí Print', correct:false}
        ]},

        { level:3, type:'multiple-choice', question:'C√¢u 13: Khi mu·ªën t√¥ m√†u h√¨nh v·∫Ω, em ch·ªçn c√¥ng c·ª• n√†o?', options:[
          {text:'A. B√∫t ch√¨', correct:false},
          {text:'B. Th√πng s∆°n', correct:true},
          {text:'C. T·∫©y', correct:false}
        ]},
        { level:3, type:'multiple-choice', question:'C√¢u 14: ƒê·ªÉ vi·∫øt ch·ªØ v√†o h√¨nh v·∫Ω, em ch·ªçn c√¥ng c·ª• c√≥ bi·ªÉu t∆∞·ª£ng ch·ªØ n√†o?', options:[
          {text:'A. A', correct:true},
          {text:'B. T', correct:false},
          {text:'C. B√∫t', correct:false}
        ]},
        { level:3, type:'multiple-choice', question:'C√¢u 15: Khi v·∫Ω m·ªôt t·∫•m thi·ªáp ch√∫c m·ª´ng trong ph·∫ßn m·ªÅm ƒë·ªì h·ªça, em n√™n:', options:[
          {text:'A. D√πng c√¥ng c·ª• v·∫Ω h√¨nh ƒë·ªÉ t·∫°o khung.', correct:false},
          {text:'B. D√πng c√¥ng c·ª• ch·ªØ ƒë·ªÉ vi·∫øt l·ªùi ch√∫c.', correct:false},
          {text:'C. D√πng c√¥ng c·ª• m√†u ƒë·ªÉ t√¥ cho ƒë·∫πp.', correct:false},
          {text:'D. Th·ª±c hi·ªán t·∫•t c·∫£ c√°c thao t√°c tr√™n.', correct:true}
        ]}
      ]
    }
  }
};

// ====== Helper c·∫•p ƒë·ªô ======
function getLevelLabel(level){
  if(level===1) return 'M·ª®C 1: NH·∫¨N BI·∫æT üéØ';
  if(level===2) return 'M·ª®C 2: TH√îNG HI·ªÇU üí°';
  return 'M·ª®C 3: V·∫¨N D·ª§NG üöÄ';
}

// ====== Bi·∫øn tr·∫°ng th√°i ======
let currentLessonKey=null, currentLessonQuestions=[], currentQuizIndex=0, lessonCorrectAnswers=0;
let lessonStopwatchInterval=null, lessonStartTime=0, currentQuestionData={};

// ===== Scoring (Phi·∫øu b√†i t·∫≠p) ‚Äì th√™m m·ªõi =====
// C√°c bi·∫øn runId v√† quizId s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ theo d√µi l∆∞·ª£t l√†m b√†i v√† g·ª≠i ƒëi·ªÉm l√™n server
let lessonRunId = null;
let lessonQuizId = null;

/**
 * Tr·ªôn ng·∫´u nhi√™n m·ªôt m·∫£ng b·∫±ng thu·∫≠t to√°n Durstenfeld.
 * H√†m n√†y tr·∫£ v·ªÅ m·∫£ng ƒë√£ ƒë∆∞·ª£c x√°o tr·ªôn, ƒë·ªìng th·ªùi kh√¥ng l√†m thay ƒë·ªïi m·∫£ng g·ªëc.
 * @param {Array} arr - m·∫£ng c·∫ßn x√°o tr·ªôn
 * @returns {Array} - m·∫£ng sau khi x√°o tr·ªôn
 */
function p2Shuffle(arr){
  for(let i = arr.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

/**
 * G·ªçi API start_run n·∫øu ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p v√† ƒë√£ c√≥ quiz_id.
 * Tr·∫£ v·ªÅ run_id n·∫øu th√†nh c√¥ng ho·∫∑c null n·∫øu th·∫•t b·∫°i.
 */
async function p2StartRunIfPossible(){
  try{
    const me = getAuth() || {};
    if(!me.token || !lessonQuizId) return null;
    const r = await apiPost('start_run', { token: me.token, quiz_id: lessonQuizId, ua: 'web' });
    return (r && r.ok) ? r.run_id : null;
  }catch(e){
    return null;
  }
}

/**
 * G·ª≠i k·∫øt qu·∫£ l√†m b√†i (submit_run) l√™n server n·∫øu c√≥ ƒë·ªß th√¥ng tin.
 * correct: s·ªë c√¢u ƒë√∫ng, total: t·ªïng c√¢u h·ªèi, maxScore: ƒëi·ªÉm t·ªëi ƒëa (m·∫∑c ƒë·ªãnh 5 ƒëi·ªÉm m·ªói c√¢u).
 * Tr·∫£ v·ªÅ ph·∫£n h·ªìi t·ª´ m√°y ch·ªß ho·∫∑c null n·∫øu kh√¥ng g·ª≠i ƒë∆∞·ª£c.
 */
async function p2SubmitRunIfPossible({correct, total, maxScore}){
  try{
    const me = getAuth() || {};
    if(!me.token || !lessonRunId || !lessonQuizId) return null;
    const r = await apiPost('submit_run', {
      token: me.token,
      run_id: lessonRunId,
      quiz_id: lessonQuizId,
      correct: correct,
      q_count: total,
      max_score: maxScore || (total * 5), // gi·ªØ thang gi·ªëng ‚Äúsao‚Äù c≈©: 5 ƒëi·ªÉm / c√¢u ƒë√∫ng
      difficulty: 'normal'
    });
    return r;
  }catch(e){
    return null;
  }
}

// ====== Ph·∫ßn t·ª≠ ======
const qText = document.getElementById('question-text');
const topicEl = document.getElementById('quiz-topic');
const levelEl = document.getElementById('quiz-level');
const progressEl = document.getElementById('quiz-progress');
const feedbackEl = document.getElementById('feedback-message');
const nextBtn = document.getElementById('next-question-btn');
const speakBtn = document.getElementById('speak-button');
const answerArea = ()=>document.getElementById('quiz-answer-area');
if(speakBtn) speakBtn.addEventListener('click', ()=>speakText(qText.innerText));
if(qText) qText.addEventListener('mouseenter', ()=>speakText(qText.innerText));

// ====== Update trang ======
function updatePageContent(pageId){
  switch(pageId){
    case 'page-video':
      document.getElementById('video-page-title').innerText = 'üìö Video B√†i H·ªçc - '+currentGrade;
      loadVideoContent();
      break;
    case 'page-quiz':
      document.getElementById('quiz-page-title').innerText = 'üß† Phi·∫øu B√†i T·∫≠p - '+currentGrade;
      document.getElementById('quiz-card').classList.add('hidden');
      document.getElementById('quiz-lesson-selection').classList.remove('hidden');
      clearInterval(lessonStopwatchInterval);
      loadLessonList();
      break;
    case 'page-results':
      document.getElementById('results-page-title').innerText = 'üìà K·∫øt Qu·∫£ - '+currentGrade;
      renderResultsPage();
      break;
    case 'page-game':
      document.getElementById('game-page-title').innerText = 'üéØ ƒêua Xe Ki·∫øn Th·ª©c - '+currentGrade;
      resetGame();
      break;
  }
}

// ====== Lesson list ======
function loadLessonList(){
  const box = document.getElementById('quiz-lesson-selection'); if(!box) return;
  box.innerHTML = '<h2 class="text-2xl font-bold text-center text-blue-800 mb-6">Em h√£y ch·ªçn b√†i h·ªçc:</h2>';
  const lessons = quizData[currentGrade]||{};
  const keys = Object.keys(lessons);
  if(!keys.length){ box.innerHTML += '<p class="text-center text-gray-700">Ch∆∞a c√≥ b√†i cho l·ªõp n√†y.</p>'; return; }
  keys.forEach(k=>{
    const btn = document.createElement('button');
    btn.className='btn-hover w-full p-6 bg-white rounded-2xl shadow-lg text-left';
    const count = (lessons[k].questions||[]).length;
    btn.innerHTML='<h3 class="text-xl font-bold text-blue-700">'+(lessons[k].title||k)+'</h3><p class="text-gray-600">'+count+' c√¢u h·ªèi</p>';
    btn.addEventListener('click', ()=>startLesson(k));
    box.appendChild(btn);
  });
}

async function startLesson(lessonKey){
  // ƒê·∫∑t kh√≥a b√†i hi·ªán t·∫°i
  currentLessonKey = lessonKey;
  // Gi·ªØ nguy√™n ph·∫ßn gom c√¢u h·ªèi cho b√†i h·ªçc
  currentLessonQuestions = (quizData[currentGrade][lessonKey] || {questions:[]}).questions;
  // ƒê·∫∑t l·∫°i ch·ªâ s·ªë v√† s·ªë c√¢u ƒë√∫ng
  currentQuizIndex = 0;
  lessonCorrectAnswers = 0;

  // ·∫®n danh s√°ch b√†i v√† hi·ªÉn th·ªã th·∫ª c√¢u h·ªèi
  document.getElementById('quiz-lesson-selection').classList.add('hidden');
  document.getElementById('quiz-card').classList.remove('hidden');

  // Kh·ªüi ƒë·ªông ƒë·ªìng h·ªì b·∫•m gi·ªù nh∆∞ c≈©
  lessonStartTime = Date.now();
  // startStopwatch c√≥ th·ªÉ b·ªè qua tham s·ªë nh∆∞ng truy·ªÅn 0 ƒë·ªÉ t∆∞∆°ng th√≠ch
  startStopwatch(0);

  // G√°n quiz_id chu·∫©n h√≥a d·ª±a tr√™n l·ªõp hi·ªán t·∫°i v√† kh√≥a b√†i
  try{
    const me = getAuth() || {};
    // Tr√≠ch xu·∫•t s·ªë l·ªõp t·ª´ thu·ªôc t√≠nh grade (v√≠ d·ª• 'L·ªõp 3' ‚Üí '3').
    let g = 'NA';
    if(me && me.grade){
      // Chuy·ªÉn gi√° tr·ªã l·ªõp th√†nh chu·ªói v√† lo·∫°i b·ªè k√Ω t·ª± kh√¥ng ph·∫£i s·ªë
      const digits = String(me.grade).match(/\d+/);
      if(digits && digits[0]){
        g = digits[0];
      }
    }
    lessonQuizId = `quiz:${g}:${String(lessonKey || 'unknown')}`;
  }catch(_){
    lessonQuizId = `quiz:NA:${String(lessonKey || 'unknown')}`;
  }

  // Kh·ªüi t·∫°o run tr√™n server (n·∫øu c√≥ token)
  lessonRunId = await p2StartRunIfPossible();

  // Hi·ªÉn th·ªã c√¢u h·ªèi ƒë·∫ßu ti√™n
  loadNewQuizQuestion();
}

// ====== Stopwatch ======
function formatTime(ms){
  const sec = Math.floor(ms/1000);
  const m = Math.floor(sec/60), s = sec%60;
  return String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
}
function startStopwatch(){
  clearInterval(lessonStopwatchInterval);
  const d = document.getElementById('quiz-stopwatch'); if(!d) return;
  lessonStartTime = Date.now(); d.innerText='00:00';
  lessonStopwatchInterval = setInterval(()=>{ d.innerText = formatTime(Date.now()-lessonStartTime); }, 1000);
}

// ====== RENDER ======
function clearQA(){
  feedbackEl.className='hidden mt-6 text-xl font-medium p-4 rounded-xl';
  feedbackEl.innerText='';
  nextBtn.classList.add('hidden');
  answerArea().innerHTML='';
}

function renderMultipleChoice(q){
  const wrap=document.createElement('div'); wrap.className='grid grid-cols-1 md:grid-cols-2 gap-4';
  q.options.forEach(opt=>{
    const btn=document.createElement('button');
    btn.className='btn-answer text-left text-lg p-5 bg-white rounded-2xl shadow border-2 border-transparent hover:border-blue-500 transition transform active:scale-95';
    btn.innerText=opt.text;
    btn.addEventListener('click',()=>{ btn.classList.add('ring','ring-blue-400'); handleResult(!!opt.correct, btn); });
    wrap.appendChild(btn);
  });
  answerArea().appendChild(wrap);
}

function svgIcon(kind){
  if(kind==='mouse') return '<svg viewBox="0 0 120 120" class="w-full h-28 mx-auto"><rect x="40" y="15" width="40" height="90" rx="20" fill="#ddd" stroke="#666"/><line x1="60" y1="15" x2="60" y2="55" stroke="#666" stroke-width="2"/></svg>';
  if(kind==='monitor') return '<svg viewBox="0 0 160 120" class="w-full h-28 mx-auto"><rect x="10" y="10" width="140" height="85" rx="6" fill="#1f2937"/><rect x="16" y="16" width="128" height="73" fill="#93c5fd"/><rect x="60" y="95" width="40" height="10" fill="#6b7280"/></svg>';
  if(kind==='keyboard') return '<svg viewBox="0 0 160 80" class="w-full h-28 mx-auto"><rect x="10" y="10" width="140" height="60" rx="6" fill="#e5e7eb" stroke="#9ca3af"/><g fill="#9ca3af"><rect x="15" y="15" width="14" height="14" rx="2"/><rect x="33" y="15" width="14" height="14" rx="2"/><rect x="51" y="15" width="14" height="14" rx="2"/><rect x="69" y="15" width="14" height="14" rx="2"/><rect x="87" y="15" width="14" height="14" rx="2"/><rect x="105" y="15" width="14" height="14" rx="2"/><rect x="123" y="15" width="14" height="14" rx="2"/><rect x="15" y="33" width="14" height="14" rx="2"/><rect x="33" y="33" width="14" height="14" rx="2"/><rect x="51" y="33" width="14" height="14" rx="2"/><rect x="69" y="33" width="14" height="14" rx="2"/><rect x="87" y="33" width="14" height="14" rx="2"/><rect x="105" y="33" width="14" height="14" rx="2"/><rect x="123" y="33" width="14" height="14" rx="2"/><rect x="15" y="51" width="14" height="14" rx="2"/><rect x="33" y="51" width="14" height="14" rx="2"/><rect x="51" y="51" width="14" height="14" rx="2"/><rect x="69" y="51" width="14" height="14" rx="2"/><rect x="87" y="51" width="14" height="14" rx="2"/><rect x="105" y="51" width="14" height="14" rx="2"/><rect x="123" y="51" width="14" height="14" rx="2"/></g></svg>';
  if(kind==='printer') return '<svg viewBox="0 0 160 120" class="w-full h-28 mx-auto"><rect x="30" y="40" width="100" height="50" rx="6" fill="#9ca3af"/><rect x="40" y="20" width="80" height="30" rx="4" fill="#d1d5db"/><rect x="50" y="65" width="60" height="20" fill="#111827"/><rect x="55" y="85" width="50" height="15" fill="#e5e7eb"/></svg>';
  if(kind==='traffic_red') return '<svg viewBox="0 0 80 160" class="w-16 h-32 mx-auto"><rect x="20" y="10" width="40" height="120" rx="10" fill="#111827"/><circle cx="40" cy="35" r="15" fill="#ef4444"/><circle cx="40" cy="75" r="15" fill="#4b5563"/><circle cx="40" cy="115" r="15" fill="#4b5563"/></svg>';
  if(kind==='sun') return '<svg viewBox="0 0 120 120" class="w-20 h-20 mx-auto"><circle cx="60" cy="60" r="20" fill="#fbbf24"/><g stroke="#f59e0b" stroke-width="4"><line x1="60" y1="5" x2="60" y2="20"/><line x1="60" y1="100" x2="60" y2="115"/><line x1="5" y1="60" x2="20" y2="60"/><line x1="100" y1="60" x2="115" y2="60"/><line x1="25" y1="25" x2="35" y2="35"/><line x1="85" y1="85" x2="95" y2="95"/><line x1="25" y1="95" x2="35" y2="85"/><line x1="85" y1="35" x2="95" y2="25"/></g></svg>';
  if(kind==='rain') return '<svg viewBox="0 0 120 120" class="w-20 h-20 mx-auto"><ellipse cx="60" cy="40" rx="30" ry="18" fill="#9ca3af"/><g stroke="#60a5fa" stroke-width="4"><line x1="30" y1="60" x2="25" y2="85"/><line x1="40" y1="60" x2="35" y2="85"/><line x1="50" y1="60" x2="45" y2="85"/><line x1="70" y1="60" x2="65" y2="85"/><line x1="80" y1="60" x2="75" y2="85"/><line x1="90" y1="60" x2="85" y2="85"/></g></svg>';
  if(kind==='cold') return '<svg viewBox="0 0 120 120" class="w-20 h-20 mx-auto"><g stroke="#60a5fa" stroke-width="5"><line x1="60" y1="20" x2="60" y2="100"/><line x1="60" y1="60" x2="95" y2="35"/><line x1="60" y1="60" x2="25" y2="35"/><line x1="60" y1="60" x2="95" y2="85"/><line x1="60" y1="60" x2="25" y2="85"/></g></svg>';
  
  if(kind==='child_pc') return '<svg viewBox="0 0 160 120" class="w-28 h-28 mx-auto"><rect x="20" y="20" width="120" height="70" rx="8" fill="#93c5fd"/><rect x="40" y="35" width="80" height="40" rx="4" fill="#fff"/><circle cx="60" cy="60" r="8" fill="#60a5fa"/><rect x="65" y="85" width="30" height="8" rx="2" fill="#6b7280"/><rect x="55" y="95" width="50" height="6" rx="3" fill="#9ca3af"/></svg>';
  if(kind==='posture_ok') return '<svg viewBox="0 0 160 120" class="w-28 h-28 mx-auto"><rect x="10" y="70" width="90" height="30" rx="6" fill="#d1d5db"/><rect x="100" y="50" width="40" height="40" rx="6" fill="#374151"/><circle cx="45" cy="40" r="10" fill="#f59e0b"/><path d="M35 55 Q45 50 55 55 L55 75" stroke="#111827" stroke-width="6" fill="none" stroke-linecap="round"/><path d="M55 62 L85 62" stroke="#111827" stroke-width="6" stroke-linecap="round"/></svg>';
  if(kind==='power_off') return '<svg viewBox="0 0 120 120" class="w-20 h-20 mx-auto"><circle cx="60" cy="60" r="45" fill="#111827"/><path d="M60 25 L60 60" stroke="#ef4444" stroke-width="10" stroke-linecap="round"/><path d="M35 40 A30 30 0 1 0 85 40" stroke="#ef4444" stroke-width="10" fill="none" stroke-linecap="round"/></svg>';
  if(kind==='safety_electric') return '<svg viewBox="0 0 120 120" class="w-20 h-20 mx-auto"><polygon points="60,10 110,110 10,110" fill="#fde68a" stroke="#f59e0b" stroke-width="4"/><path d="M60 35 L50 65 H70 L60 95" stroke="#b45309" stroke-width="6" fill="none" stroke-linecap="round"/></svg>';
  if(kind==='calculator') return '<svg viewBox="0 0 120 140" class="w-20 h-20 mx-auto"><rect x="20" y="10" width="80" height="120" rx="10" fill="#9ca3af"/><rect x="30" y="20" width="60" height="20" rx="4" fill="#374151"/><g fill="#e5e7eb"><rect x="30" y="50" width="20" height="20" rx="4"/><rect x="50" y="50" width="20" height="20" rx="4"/><rect x="70" y="50" width="20" height="20" rx="4"/><rect x="30" y="70" width="20" height="20" rx="4"/><rect x="50" y="70" width="20" height="20" rx="4"/><rect x="70" y="70" width="20" height="20" rx="4"/><rect x="30" y="90" width="20" height="20" rx="4"/><rect x="50" y="90" width="20" height="20" rx="4"/><rect x="70" y="90" width="20" height="20" rx="4"/></g></svg>';
  if(kind==='magnifier') return '<svg viewBox="0 0 140 140" class="w-20 h-20 mx-auto"><circle cx="60" cy="60" r="35" fill="#93c5fd" stroke="#1f2937" stroke-width="6"/><rect x="85" y="85" width="40" height="12" rx="6" transform="rotate(45 85 85)" fill="#1f2937"/></svg>';
  if(kind==='chart') return '<svg viewBox="0 0 160 120" class="w-20 h-20 mx-auto"><rect x="20" y="20" width="120" height="80" rx="6" fill="#e5e7eb" stroke="#9ca3af"/><rect x="35" y="70" width="20" height="20" fill="#60a5fa"/><rect x="65" y="55" width="20" height="35" fill="#34d399"/><rect x="95" y="40" width="20" height="50" fill="#f59e0b"/></svg>';

  return '';
}

function renderImageChoice(q){
  const wrap=document.createElement('div'); wrap.className='grid grid-cols-2 gap-4';
  q.options.forEach(opt=>{
    const btn=document.createElement('button');
    btn.className='btn-answer text-left text-lg p-3 bg-white rounded-2xl shadow border-2 border-transparent hover:border-blue-500 transition transform active:scale-95';
    let icon='';
    if(typeof opt.image==='string' && opt.image.indexOf('svg:')===0){ icon = svgIcon(opt.image.split(':')[1]); }
    btn.innerHTML = icon + '<p class="font-medium mt-2">'+opt.text+'</p>';
    btn.addEventListener('click',()=>{ btn.classList.add('ring','ring-blue-400'); handleResult(!!opt.correct, btn); });
    wrap.appendChild(btn);
  });
  answerArea().appendChild(wrap);
}

function renderTrueFalse(q){
  const wrap=document.createElement('div'); wrap.className='space-y-3';
  (q.statements||[]).forEach(st=>{
    const row=document.createElement('div'); row.className='flex items-center justify-between bg-white rounded-xl shadow p-3 gap-3';
    const txt=document.createElement('div'); txt.className='text-lg font-medium text-gray-800 pr-3'; txt.innerText=st.text;
    const btnWrap=document.createElement('div'); btnWrap.className='flex gap-2';
    const bT=document.createElement('button'); bT.className='btn-answer px-4 py-2 rounded-xl bg-green-500 text-white text-lg font-bold'; bT.innerText='ƒê√∫ng';
    const bF=document.createElement('button'); bF.className='btn-answer px-4 py-2 rounded-xl bg-red-500 text-white text-lg font-bold'; bF.innerText='Sai';
    bT.addEventListener('click',(e)=>{ 
      // NgƒÉn ch·∫∑n ch·ªçn l·∫°i sau khi ƒë√£ ch·ªçn
      row.dataset.selected = 'true';
      bT.classList.remove('bg-green-500', 'text-white');
      bT.classList.add('bg-green-600', 'ring-2', 'ring-green-400', 'text-white');
      bF.classList.remove('bg-red-600', 'ring-2', 'ring-red-400');
      bF.classList.add('bg-red-500', 'text-white');
      try{ txt.classList.add('font-bold','text-gray-900'); row.classList.add('row-selected'); }catch(_e){}
      if(e && e.clientX!=null){ try{ window.__setPermanentTick(row, e.clientX, e.clientY); }catch(_e){} } 
      try{ row.classList.add('row-glow'); setTimeout(function(){ row.classList.remove('row-glow'); }, 1000); }catch(_e){}
      handleInlineRowResult(st.correct===true, row); 
    });
    bF.addEventListener('click',(e)=>{ 
      // NgƒÉn ch·∫∑n ch·ªçn l·∫°i sau khi ƒë√£ ch·ªçn
      row.dataset.selected = 'true';
      bF.classList.remove('bg-red-500', 'text-white');
      bF.classList.add('bg-red-600', 'ring-2', 'ring-red-400', 'text-white');
      bT.classList.remove('bg-green-600', 'ring-2', 'ring-green-400');
      bT.classList.add('bg-green-500', 'text-white');
      try{ txt.classList.add('font-bold','text-gray-900'); row.classList.add('row-selected'); }catch(_e){}
      if(e && e.clientX!=null){ try{ window.__setPermanentTick(row, e.clientX, e.clientY); }catch(_e){} } 
      try{ row.classList.add('row-glow'); setTimeout(function(){ row.classList.remove('row-glow'); }, 1000); }catch(_e){}
      handleInlineRowResult(st.correct===false, row); 
    });
    btnWrap.appendChild(bT); btnWrap.appendChild(bF); row.appendChild(txt); row.appendChild(btnWrap); wrap.appendChild(row);
  });
  const check=document.createElement('button'); check.className='btn-hover mt-4 w-full p-4 bg-blue-600 text-white rounded-xl font-bold text-lg'; check.innerText='Ki·ªÉm tra ƒë√°p √°n';
  check.addEventListener('click',()=>{
    const rows=[...wrap.querySelectorAll('.checked-row')];
    const total=(q.statements||[]).length;
    const correct=rows.filter(r=>r.dataset.rowCorrect==='true').length;
    const ok=(correct===total)&&(rows.length===total);
    handleResult(ok, check);
  });
  wrap.appendChild(check); answerArea().appendChild(wrap);
}

function renderMatching(q){
  const container=document.createElement('div'); container.className='relative bg-white rounded-2xl shadow p-4 md:p-6';
  const grid=document.createElement('div'); grid.className='grid grid-cols-2 gap-12 md:gap-16'; // tƒÉng kho·∫£ng c√°ch
  const colA=document.createElement('div'); const colB=document.createElement('div');
  colA.innerHTML='<div class="font-bold text-blue-700 mb-2">C·ªôt A</div>'; colB.innerHTML='<div class="font-bold text-blue-700 mb-2">C·ªôt B</div>';
  const listA=document.createElement('div'); listA.className='space-y-4';
  const listB=document.createElement('div'); listB.className='space-y-4';
  (q.columnA||[]).forEach(txt=>{ const it=document.createElement('button'); it.className='btn-answer w-full text-left p-3 bg-sky-50 hover:bg-sky-100 rounded-xl border border-sky-200'; it.innerText=txt; it.dataset.key=txt; listA.appendChild(it); });
  (q.columnB||[]).forEach(txt=>{ const it=document.createElement('button'); it.className='btn-answer w-full text-left p-3 bg-rose-50 hover:bg-rose-100 rounded-xl border border-rose-200'; it.innerText=txt; it.dataset.key=txt; listB.appendChild(it); });
  colA.appendChild(listA); colB.appendChild(listB); grid.appendChild(colA); grid.appendChild(colB); container.appendChild(grid);

  const svg=document.createElementNS('http://www.w3.org/2000/svg','svg');
  svg.setAttribute('class','absolute inset-0 pointer-events-none'); container.appendChild(svg);

  let selectedA=null, selectedB=null; const links=[];
  function getCenterRight(el){ const r=el.getBoundingClientRect(), p=container.getBoundingClientRect(); return {x:r.left-p.left+r.width, y:r.top-p.top+r.height/2}; }
  function getCenterLeft(el){ const r=el.getBoundingClientRect(), p=container.getBoundingClientRect(); return {x:r.left-p.left, y:r.top-p.top+r.height/2}; }
  function redraw(){
    while(svg.firstChild) svg.removeChild(svg.firstChild);
    links.forEach(link=>{
      const aEl=[...listA.children].find(n=>n.dataset.key===link.aKey);
      const bEl=[...listB.children].find(n=>n.dataset.key===link.bKey);
      if(!aEl||!bEl) return;
      const p1=getCenterRight(aEl), p2=getCenterLeft(bEl);
      const path=document.createElementNS('http://www.w3.org/2000/svg','path');
      const d='M '+p1.x+' '+p1.y+' C '+(p1.x+60)+' '+p1.y+', '+(p2.x-60)+' '+p2.y+', '+p2.x+' '+p2.y;
      path.setAttribute('d', d); path.setAttribute('fill','none'); path.setAttribute('stroke','#60a5fa'); path.setAttribute('stroke-width','4'); path.setAttribute('stroke-linecap','round');
      svg.appendChild(path);
    });
  }
  window.addEventListener('resize',()=>{ if(!document.getElementById('page-quiz').classList.contains('hidden')) redraw(); });

  listA.querySelectorAll('button').forEach(btn=> btn.addEventListener('click', ()=>{
    // X√≥a li√™n k·∫øt c≈© n·∫øu c√≥
	    const existingLinkIndex = links.findIndex(l => l.aKey === btn.dataset.key);
	    if (existingLinkIndex !== -1) {
	        links.splice(existingLinkIndex, 1);
	    }
	    
	    // N·∫øu ƒëang ch·ªçn A n√†y, th√¨ b·ªè ch·ªçn
	    if(selectedA === btn.dataset.key){
	        selectedA = null;
	        btn.classList.remove('ring','ring-4','ring-blue-400', 'bg-sky-200');
	        redraw();
	        return;
	    }
	
	    selectedA=btn.dataset.key; 
	    listA.querySelectorAll('button').forEach(b=>b.classList.remove('ring','ring-4','ring-blue-400', 'bg-sky-200')); 
	    btn.classList.add('ring','ring-4','ring-blue-400', 'bg-sky-200');
	    
	    // N·∫øu ƒë√£ c√≥ B ƒë∆∞·ª£c ch·ªçn, th·ª±c hi·ªán n·ªëi ngay
	    if(selectedB){
	      // X√≥a n·ªëi c≈© c·ªßa B
	      const oldLinkIndex = links.findIndex(l => l.bKey === selectedB);
	      if (oldLinkIndex !== -1) {
	          links.splice(oldLinkIndex, 1);
	      }
	      
	      links.push({aKey:selectedA, bKey:selectedB});
	      selectedA=null; selectedB=null; 
	      listA.querySelectorAll('button').forEach(b=>b.classList.remove('ring','ring-4','ring-blue-400', 'bg-sky-200')); 
	      listB.querySelectorAll('button').forEach(b=>b.classList.remove('ring','ring-4','ring-red-400', 'bg-rose-200')); 
	      redraw();
	    }
  }));
  
  listB.querySelectorAll('button').forEach(btn=> btn.addEventListener('click', ()=>{
    // X√≥a li√™n k·∫øt c≈© n·∫øu c√≥
	    const existingLinkIndex = links.findIndex(l => l.bKey === btn.dataset.key);
	    if (existingLinkIndex !== -1) {
	        links.splice(existingLinkIndex, 1);
	    }
	    
	    // N·∫øu ƒëang ch·ªçn B n√†y, th√¨ b·ªè ch·ªçn
	    if(selectedB === btn.dataset.key){
	        selectedB = null;
	        btn.classList.remove('ring','ring-4','ring-red-400', 'bg-rose-200');
	        redraw();
	        return;
	    }
	    
	    selectedB=btn.dataset.key;
	    listB.querySelectorAll('button').forEach(b=>b.classList.remove('ring','ring-4','ring-red-400', 'bg-rose-200')); 
	    btn.classList.add('ring','ring-4','ring-red-400', 'bg-rose-200');
	    
	    // N·∫øu ƒë√£ c√≥ A ƒë∆∞·ª£c ch·ªçn, th·ª±c hi·ªán n·ªëi ngay
	    if(selectedA){
	      // X√≥a n·ªëi c≈© c·ªßa A
	      const oldLinkIndex = links.findIndex(l => l.aKey === selectedA);
	      if (oldLinkIndex !== -1) {
	          links.splice(oldLinkIndex, 1);
	      }
	      
	      links.push({aKey:selectedA, bKey:selectedB});
	      selectedA=null; selectedB=null; 
	      listA.querySelectorAll('button').forEach(b=>b.classList.remove('ring','ring-4','ring-blue-400', 'bg-sky-200')); 
	      listB.querySelectorAll('button').forEach(b=>b.classList.remove('ring','ring-4','ring-red-400', 'bg-rose-200')); 
	      redraw();
	    }
  }));
  
  // Th√™m n√∫t x√≥a n·ªëi
  const clearBtn = document.createElement('button');
  clearBtn.className='btn-hover mt-4 w-full p-2 bg-gray-300 text-gray-800 rounded-xl font-bold text-sm'; 
  clearBtn.innerText='X√≥a t·∫•t c·∫£ c√°c n·ªëi';
  clearBtn.addEventListener('click', ()=>{
    links.length = 0; // X√≥a t·∫•t c·∫£ c√°c n·ªëi
    selectedA=null; selectedB=null;
    listA.querySelectorAll('button').forEach(b=>b.classList.remove('ring','ring-4','ring-blue-400', 'bg-sky-200')); 
	    listB.querySelectorAll('button').forEach(b=>b.classList.remove('ring','ring-4','ring-red-400', 'bg-rose-200')); 
	    redraw();
  });
  container.appendChild(clearBtn);

  const check=document.createElement('button'); check.className='btn-hover mt-6 w-full p-4 bg-blue-600 text-white rounded-xl font-bold text-lg'; check.innerText='Ki·ªÉm tra ƒë√°p √°n';
  check.addEventListener('click', ()=>{
    const ok = Object.keys(q.correctMatches||{}).every(k=>{
      const t=q.correctMatches[k]; const found=links.find(l=>l.aKey===k && l.bKey===t);
      return !!found;
    });
    handleResult(ok, check);
  });
  container.appendChild(check);
  answerArea().appendChild(container);
  setTimeout(redraw,60);
}

function renderFillInBlank(q){
  const wrap=document.createElement('div'); wrap.className='space-y-4';
  const sent=document.createElement('div'); sent.className='text-lg bg-white rounded-2xl shadow p-4 leading-relaxed';
  const parts=q.sentence.split('[BLANK]'); const inputs=[];
  parts.forEach((p,i)=>{
    sent.appendChild(document.createTextNode(p));
    if(i<parts.length-1){ const inp=document.createElement('input'); inp.type='text'; inp.className='mx-2 px-3 py-2 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400'; inputs.push(inp); sent.appendChild(inp); }
  });
  wrap.appendChild(sent);
  if(q.hints && q.hints.length){
    const hint=document.createElement('div'); hint.className='flex flex-wrap gap-2';
    q.hints.forEach(h=>{ const tag=document.createElement('button'); tag.className='btn-hover px-3 py-1.5 rounded-full bg-amber-100 text-amber-800 border border-amber-200'; tag.innerText=h; tag.addEventListener('click',()=>{ const t=inputs.find(i=>!i.value); if(t){ t.value=h; t.focus(); } }); hint.appendChild(tag); });
    wrap.appendChild(hint);
  }
  const check=document.createElement('button'); check.className='btn-hover mt-2 w-full p-4 bg-blue-600 text-white rounded-xl font-bold text-lg'; check.innerText='Ki·ªÉm tra ƒë√°p √°n';
  check.onclick=()=>{
    const filled=inputs.map(i=>i.value.trim().toLowerCase());
    const correct=(q.correctAnswers||[]).map(s=>s.trim().toLowerCase());
    const ok = filled.length===correct.length && filled.every((v,i)=> v===correct[i]);
    handleResult(ok, check);
  };
  wrap.appendChild(check);
  answerArea().appendChild(wrap);
}

function renderFillInBlankChoice(q){
  const wrap=document.createElement('div'); wrap.className='space-y-4';
  const choice=document.createElement('div'); choice.className='flex justify-center gap-4 mb-4';
  (q.options||[]).forEach(text=>{
    const b=document.createElement('button'); b.className='btn-answer text-lg p-3 px-6 bg-white rounded-xl shadow border-2 border-transparent hover:border-blue-500';
    b.innerText=text; b.dataset.choice=text;
    b.addEventListener('click',()=>{ choice.querySelectorAll('button').forEach(x=>x.classList.remove('bg-blue-500','text-white','ring','ring-blue-400')); b.classList.add('bg-blue-500','text-white','ring','ring-blue-400'); });
    choice.appendChild(b);
  });
  wrap.appendChild(choice);

  const sent=document.createElement('div'); sent.className='text-lg bg-white rounded-2xl shadow p-4 leading-relaxed';
  const parts=q.sentence.split('[BLANK]'); const inputs=[];
  parts.forEach((p,i)=>{
    sent.appendChild(document.createTextNode(p));
    if(i<parts.length-1){ const inp=document.createElement('input'); inp.type='text'; inp.className='mx-2 px-3 py-2 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400'; inputs.push(inp); sent.appendChild(inp); }
  });
  wrap.appendChild(sent);

  const check=document.createElement('button'); check.className='btn-hover mt-2 w-full p-4 bg-blue-600 text-white rounded-xl font-bold text-lg'; check.innerText='Ki·ªÉm tra ƒë√°p √°n';
  check.onclick=()=>{
    const sel=choice.querySelector('.bg-blue-500'); const choiceOk = !!sel && sel.dataset.choice===q.correctChoice;
    const filled=inputs.map(i=>i.value.trim().toLowerCase());
    const correct=(q.correctAnswers||[]).map(s=>s.trim().toLowerCase());
    const fillOk = filled.length===correct.length && filled.every((v,i)=> v===correct[i]);
    handleResult(choiceOk && fillOk, check);
  };
  wrap.appendChild(check);
  answerArea().appendChild(wrap);
}

function renderMatchingImage(q){
  const transformed={...q, columnA:(q.columnA||[]).map(it=>it.text)};
  renderMatching(transformed);
  // g·∫Øn svg c·ªôt A
  const colA = document.querySelector('#quiz-answer-area .space-y-4');
  if(colA){
    (q.columnA||[]).forEach((item,idx)=>{
      const btn = colA.children[idx];
      if(btn && item.image && item.image.indexOf('svg:')===0){
        const holder=document.createElement('div'); holder.innerHTML = svgIcon(item.image.split(':')[1]);
        btn.prepend(holder.firstChild);
      }
    });
  }
}

// ====== N·∫°p c√¢u h·ªèi ======
// Th√™m h√†m speakText ƒë·ªÉ x·ª≠ l√Ω TTS
function speakText(text){
  if(!text) return;
  // S·ª≠ d·ª•ng API TTS c·ªßa tr√¨nh duy·ªát
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'vi-VN';
  speechSynthesis.cancel(); // H·ªßy b·ªè b·∫•t k·ª≥ l·ªùi n√≥i n√†o ƒëang di·ªÖn ra
  speechSynthesis.speak(utterance);
}
if(nextBtn) nextBtn.addEventListener('click', ()=>{
  const list=currentLessonQuestions;
  if(currentQuizIndex>=list.length-1){ showLessonSummary(); } else { currentQuizIndex++; loadNewQuizQuestion(); }
});

function loadNewQuizQuestion(){
  // X√≥a c√°c l·ª±a ch·ªçn ƒê√∫ng/Sai ƒë√£ ch·ªçn tr∆∞·ªõc ƒë√≥
  document.querySelectorAll('.checked-row').forEach(row => {
    row.classList.remove('checked-row', 'bg-green-50', 'bg-red-50');
    row.removeAttribute('data-row-correct');
    row.removeAttribute('data-selected');
    row.querySelectorAll('.btn-answer').forEach(btn => {
      btn.classList.remove('bg-green-600', 'ring-2', 'ring-green-400', 'bg-red-600', 'ring-2', 'ring-red-400');
      // ƒê·∫∑t l·∫°i m√†u m·∫∑c ƒë·ªãnh cho n√∫t ƒê√∫ng/Sai
      if(btn.innerText === 'ƒê√∫ng') {
        btn.classList.add('bg-green-500', 'text-white');
      } else if (btn.innerText === 'Sai') {
        btn.classList.add('bg-red-500', 'text-white');
      }
    });
  });
  const list=currentLessonQuestions;
  if(!list || !list.length){
    topicEl.innerText = currentLessonKey || '';
    qText.innerText = 'Ch∆∞a c√≥ d·ªØ li·ªáu.';
    answerArea().innerHTML = '';
    return;
  }
  if(currentQuizIndex>=list.length) currentQuizIndex=0;
  currentQuestionData = list[currentQuizIndex];
  // N·∫øu c√¢u h·ªèi c√≥ m·∫£ng options, x√°o tr·ªôn ƒë·ªÉ tr√°nh thu·ªôc v·ªã tr√≠ ƒë√°p √°n
  if (Array.isArray(currentQuestionData.options)) {
    // T·∫°o b·∫£n sao tr∆∞·ªõc khi shuffle ƒë·ªÉ kh√¥ng ph√° d·ªØ li·ªáu g·ªëc
    currentQuestionData.options = p2Shuffle([...currentQuestionData.options]);
  }
  topicEl.innerText = (quizData[currentGrade][currentLessonKey]||{}).title || currentLessonKey;
  levelEl.innerText = getLevelLabel(currentQuestionData.level||1);
  qText.innerText = currentQuestionData.question || '';
  const progress = Math.round(((currentQuizIndex+1)/list.length)*100); progressEl.style.width = progress + '%';
  clearQA();

  if(currentQuestionData.type==='image-question' && typeof currentQuestionData.image==='string' && currentQuestionData.image.indexOf('svg:')===0){
    const box=document.createElement('div'); box.className='my-2 flex justify-center'; box.innerHTML = svgIcon(currentQuestionData.image.split(':')[1]);
    answerArea().appendChild(box);
  }

  switch(currentQuestionData.type){
    case 'multiple-choice':
    case 'image-question': renderMultipleChoice(currentQuestionData); break;
    case 'image-choice': renderImageChoice(currentQuestionData); break;
    case 'true-false': renderTrueFalse(currentQuestionData); break;
    case 'matching': renderMatching(currentQuestionData); break;
    case 'matching-image': renderMatchingImage(currentQuestionData); break;
    case 'fill-in-blank': renderFillInBlank(currentQuestionData); break;
    case 'fill-in-blank-choice': renderFillInBlankChoice(currentQuestionData); break;
    default: answerArea().innerHTML = '<div class="text-gray-600">(Ch∆∞a h·ªó tr·ª£ lo·∫°i c√¢u h·ªèi n√†y)</div>';
  }
  speakText(currentQuestionData.question||'');
}

// ====== K·∫øt qu·∫£ ======
function showCorrectEffect(){
  const overlay=document.getElementById('correct-overlay'); if(!overlay) return;
  overlay.classList.remove('hidden');
  playCorrect();
  setTimeout(()=>overlay.classList.add('hidden'), 1200);
}
function showIncorrectEffect(){
  playIncorrect();
  const card=document.getElementById('quiz-card'); if(card){ card.classList.add('shake'); setTimeout(()=>card.classList.remove('shake'), 500); }
}
function handleResult(isCorrect, triggerBtn){
  document.querySelectorAll('#quiz-answer-area button').forEach(b=>b.disabled=true);
  if(triggerBtn){ triggerBtn.classList.add(isCorrect?'bg-green-500':'bg-red-500','text-white'); }
  if(isCorrect){
    lessonCorrectAnswers++;
    showCorrectEffect();
    feedbackEl.innerText='Ch√≠nh x√°c! ü•≥';
    feedbackEl.className='mt-6 text-xl font-medium p-4 rounded-xl bg-green-100 text-green-800';
  } else {
    showIncorrectEffect();
    feedbackEl.innerText='Sai r·ªìi! üò•';
    feedbackEl.className='mt-6 text-xl font-medium p-4 rounded-xl bg-red-100 text-red-800';
  }
  const list=currentLessonQuestions;
  nextBtn.innerText = (currentQuizIndex>=list.length-1) ? 'HO√ÄN TH√ÄNH B√ÄI üèÅ' : 'C√¢u ti·∫øp theo ‚ûî';
  feedbackEl.classList.remove('hidden'); nextBtn.classList.remove('hidden');
}
function handleInlineRowResult(ok, rowEl){
  rowEl.classList.add('checked-row'); rowEl.dataset.rowCorrect = ok?'true':'false';
  rowEl.classList.toggle('bg-green-50', ok);
  rowEl.classList.toggle('bg-red-50', !ok);
}
async function showLessonSummary(){
  try{
    // D·ª´ng ƒë·ªìng h·ªì b·∫•m gi·ªù
    clearInterval(lessonStopwatchInterval);
    const total = currentLessonQuestions.length || 0;
    const correct = lessonCorrectAnswers || 0;

    // 1) G·ª≠i submit_run n·∫øu c√≥ run_id + token
    let awarded = 0, serverMsg = '';
    try{
      const r = await p2SubmitRunIfPossible({
        correct: correct,
        total: total,
        maxScore: total * 5 // c√πng thang ‚Äúsao‚Äù c≈©: 5 ƒëi·ªÉm / c√¢u ƒë√∫ng
      });
      if(r && r.ok){
        awarded = Number(r.awarded_points || 0);
        serverMsg = `( +${awarded} ƒëi·ªÉm h√¥m nay )`;
      }else if(r && r.error){
        serverMsg = `(kh√¥ng c·ªông ƒëi·ªÉm: ${r.error})`;
      }
    }catch(_){
      /* offline ho·∫∑c ch∆∞a ƒëƒÉng nh·∫≠p */
    }

    // 2) V·∫´n c·∫≠p nh·∫≠t ‚ÄúK·∫øt qu·∫£ h·ªçc t·∫≠p‚Äù c·ª•c b·ªô ƒë·ªÉ UI c≈© ch·∫°y b√¨nh th∆∞·ªùng
    try{
      const me = getAuth() || {};
      const g  = me.grade || 'NA';
      const s  = (window.userScores && window.userScores[g]) || null;
      if (s){
        // Gi·ªØ logic sao c≈© (n·∫øu b·∫°n v·∫´n mu·ªën hi·ªÉn th·ªã sao trong ph·∫ßn K·∫øt qu·∫£ h·ªçc t·∫≠p c≈©)
        const stars = Math.round((correct / Math.max(1, total)) * 3);
        s.totalStars = (s.totalStars || 0) + stars;
        s.completedCount = (s.completedCount || 0) + 1;
        s.correctAnswers = (s.correctAnswers || 0) + correct;
        s.totalAnswers   = (s.totalAnswers || 0) + total;
        window.saveScores && window.saveScores();
      }
    }catch(_){}

    // 3) Hi·ªÉn th·ªã popup t·ªïng k·∫øt nh∆∞ c≈©, ch·ªâ b·ªï sung d√≤ng ƒëi·ªÉm server (n·∫øu c√≥)
    // S·ª≠ d·ª•ng khung popup m·∫∑c ƒë·ªãnh (#summary-popup) v√† ph·∫ßn n·ªôi dung (#summary-popup-content)
    const popup = document.getElementById('summary-popup');
    const popupContent = document.getElementById('summary-popup-content');
    if(popupContent){
      // T·∫°o chu·ªói t√≥m t·∫Øt v·ªõi k·∫øt qu·∫£ v√† th√¥ng ƒëi·ªáp server (n·∫øu c√≥)
      // S·ª≠ d·ª•ng xu·ªëng d√≤ng ƒë·ªÉ gi·ªØ ƒë·ªãnh d·∫°ng trong th·∫ª <p> c√≥ whitespace-pre-line
      let content = '';
      content += 'HO√ÄN TH√ÄNH B√ÄI! ü•≥\n';
      content += 'ƒê√∫ng: ' + correct + '/' + total + '\n';
      if(serverMsg){
        content += serverMsg;
      }
      popupContent.innerText = content;
    }
    if(popup) popup.classList.remove('hidden');

    // ·∫®n ph·∫£n h·ªìi v√† n√∫t c√¢u ti·∫øp theo ƒë·ªÉ tr√°nh nh·∫•n th√™m
    if(feedbackEl) feedbackEl.classList.add('hidden');
    if(nextBtn) nextBtn.classList.add('hidden');
  }catch(e){
    // fallback c≈© n·∫øu c√≥ l·ªói: hi·ªÉn th·ªã popup ti√™u chu·∫©n
    const popup = document.getElementById('summary-popup');
    if(popup) popup.classList.remove('hidden');
  }finally{
    // reset run
    lessonRunId = null;
    lessonQuizId = null;
  }
}

// ====== GAME (an to√†n) ======
const playerBear=document.getElementById('player-bear');
const playerRabbit=document.getElementById('player-rabbit');
const gameQuestionText=document.getElementById('game-question-text');
const gameOptions=document.querySelectorAll('.game-option');
const gameFeedback=document.getElementById('game-feedback');
let raceTrackWidth=300, bearPosition=0, rabbitPosition=0, gameStep=0;
function updateRaceTrackWidth(){ const t=document.getElementById('race-track'); if(t){ raceTrackWidth = t.offsetWidth - 60; } }
function resetGame(){
  updateRaceTrackWidth(); gameStep = raceTrackWidth / 5;
  bearPosition=0; rabbitPosition=0;
  if(playerBear) playerBear.style.transform='translateX(0px)';
  if(playerRabbit) playerRabbit.style.transform='translateX(0px)';
  loadNewGameQuestion();
}
window.addEventListener('resize', ()=>{
  const pg = document.getElementById('page-game');
  if(pg && !pg.classList.contains('hidden')){
    updateRaceTrackWidth(); gameStep=raceTrackWidth/5;
    if(playerBear) playerBear.style.transform='translateX('+bearPosition+'px)';
    if(playerRabbit) playerRabbit.style.transform='translateX('+rabbitPosition+'px)';
  }
});
gameOptions.forEach(btn=> btn.addEventListener('click', ()=>handleGameAnswer(btn)));
function handleGameAnswer(btn){
  const isCorrect = btn.dataset.correct==='true';
  gameOptions.forEach(b=>b.disabled=true);
  if(isCorrect){
    playCorrect(); btn.classList.add('bg-green-500','text-white');
    gameFeedback.innerText='ƒê√∫ng r·ªìi! G·∫•u ti·∫øn l√™n! üêª'; gameFeedback.className='mt-6 text-xl font-medium p-4 rounded-xl bg-green-100 text-green-800';
    bearPosition += gameStep; if(playerBear) playerBear.style.transform='translateX('+Math.min(bearPosition, raceTrackWidth)+'px)';
  } else {
    playIncorrect(); btn.classList.add('bg-red-500','text-white');
    gameFeedback.innerText='Sai r·ªìi! Th·ªè ch·∫°y m·∫•t! üê∞'; gameFeedback.className='mt-6 text-xl font-medium p-4 rounded-xl bg-red-100 text-red-800';
    rabbitPosition += gameStep; if(playerRabbit) playerRabbit.style.transform='translateX('+Math.min(rabbitPosition, raceTrackWidth)+'px)';
  }
  gameFeedback.classList.remove('hidden');
  if(bearPosition>=raceTrackWidth){
    gameFeedback.innerText='G·∫•u th·∫Øng r·ªìi! Hoan h√¥! ü•≥'; gameFeedback.className='mt-6 text-xl font-medium p-4 rounded-xl bg-blue-100 text-blue-800';
  } else if(rabbitPosition>=raceTrackWidth){
    gameFeedback.innerText='Th·ªè th·∫Øng m·∫•t r·ªìi! C·ªë l√™n l·∫ßn sau! üò•'; gameFeedback.className='mt-6 text-xl font-medium p-4 rounded-xl bg-yellow-100 text-yellow-800';
  } else {
    setTimeout(loadNewGameQuestion, 1600);
  }
}
function loadNewGameQuestion(){
  if(!gameOptions.length) return;
  gameFeedback.classList.add('hidden');
  gameOptions.forEach((b)=>{
    b.disabled=false;
    b.className='game-option btn-hover text-left text-lg p-5 bg-white rounded-2xl shadow border-2 border-transparent hover:border-blue-500';
  });
  if(gameQuestionText) gameQuestionText.innerText='C√¢u 2: ƒê√¢u l√† m·ªôt thi·∫øt b·ªã L∆ØU TR·ªÆ?';
  const trueOpt = document.querySelector('.game-option[data-correct="true"]');
  if(trueOpt) trueOpt.dataset.correct='false';
  const opts = document.querySelectorAll('.game-option');
  if(opts[2]) opts[2].dataset.correct='true';
}


// === v2.5.7-stable wrappers ===
try{
  if (typeof updatePageContent === 'function'){
    const __u = updatePageContent;
    window.updatePageContent = function(){ return safeCall(__u, ...arguments); };
  }
}catch(e){ if(window.__gauPanic) __gauPanic(e); }
try{
  if (typeof startLesson === 'function'){
    const __s = startLesson;
    window.startLesson = function(){ return safeCall(__s, ...arguments); };
  }
}catch(e){ if(window.__gauPanic) __gauPanic(e); }
try{
  if (typeof showPage === 'function'){
    const __p = showPage;
    window.showPage = function(){ return safeCall(__p, ...arguments); };
  }
}catch(e){ if(window.__gauPanic) __gauPanic(e); }</script>



<script>

/* ===============================
   v2.5.3 ‚Äî Vietnamese-only TTS override
   =============================== */
(function(){
  // Graceful stop helper (kept global for modules)
  window.stopSpeak = function(){
    try{ speechSynthesis && speechSynthesis.cancel(); }catch(e){}
    var a = document.getElementById('tts-audio');
    if(a){ try{ a.pause(); a.currentTime = 0; }catch(e){} }
  };

  // Load voices reliably
  function getVoicesAsync(){
    return new Promise(function(resolve){
      try{
        var voices = window.speechSynthesis ? speechSynthesis.getVoices() : [];
        if(voices && voices.length){ return resolve(voices); }
        var tries = 0;
        var iv = setInterval(function(){
          tries += 1;
          try{
            voices = speechSynthesis.getVoices();
            if(voices && voices.length){
              clearInterval(iv);
              return resolve(voices);
            }
          }catch(e){}
          if(tries >= 15){ // ~1.5s
            clearInterval(iv);
            return resolve([]);
          }
        }, 100);
      }catch(e){
        resolve([]);
      }
    });
  }

  // Hoisted function declaration to override any previous definitions cleanly
  // (Later-in-file function declarations take precedence in most browsers.)
  window.speakText = function(text){
    try{
      if(!text || !String(text).trim()){
        window.stopSpeak();
        return;
      }

      var hasSpeech = (typeof window.speechSynthesis !== 'undefined');
      if(hasSpeech){
        // Try Web Speech API with Vietnamese voice first
        getVoicesAsync().then(function(voices){
          var used = false;
          try{
            var viVoices = (voices||[]).filter(function(v){
              return v && v.lang && v.lang.toLowerCase().indexOf('vi') === 0;
            });
            if(viVoices.length){
              var u = new SpeechSynthesisUtterance(String(text));
              u.lang  = viVoices[0].lang || 'vi-VN';
              u.voice = viVoices[0];
              u.rate  = 1.0;
              u.pitch = 1.0;
              try{ speechSynthesis.cancel(); }catch(e){}
              speechSynthesis.speak(u);
              used = true;
            }
          }catch(e){ /* fallback below */ }

          if(!used){
            // Fallback: Google TTS Vietnamese
            try{
              var a = document.getElementById('tts-audio');
              if(!a) return;
              var shortText = String(text).slice(0, 200);
              var url = 'https://translate.google.com/translate_tts?ie=UTF-8&q='
                        + encodeURIComponent(shortText)
                        + '&tl=vi-VN&client=tw-ob';
              a.src = url;
              a.play().then(function(){
                setTimeout(function(){ try{ a.pause(); a.currentTime = 0; }catch(e){} }, 8000);
              }).catch(function(){});
            }catch(e){}
          }
        });
        return;
      }

      // No Web Speech ‚Üí Play fallback immediately
      try{
        var a = document.getElementById('tts-audio');
        if(!a) return;
        var shortText = String(text).slice(0, 200);
        var url = 'https://translate.google.com/translate_tts?ie=UTF-8&q='
                  + encodeURIComponent(shortText)
                  + '&tl=vi-VN&client=tw-ob';
        a.src = url;
        a.play().then(function(){
          setTimeout(function(){ try{ a.pause(); a.currentTime = 0; }catch(e){} }, 8000);
        }).catch(function(){});
      }catch(e){}
    }catch(e){
      // As a last resort, just stop silently
      window.stopSpeak();
    }
  };
})();

</script>

<!-- Removed legacy leaderboard script to prevent duplicate definitions -->

<script>

/* === v2.5.3: helper to spawn green ‚úì tick at click position === */
(function(){
  window.__spawnGreenTick = function(containerEl, clientX, clientY){
    try{
      if(!containerEl) return;
      var rect = containerEl.getBoundingClientRect();
      var x = clientX - rect.left;
      var y = clientY - rect.top;
      var tick = document.createElement('div');
      tick.className = 'click-tick';
      tick.textContent = '‚úì';
      tick.style.left = x + 'px';
      tick.style.top = y + 'px';
      tick.style.position = 'absolute';
      tick.style.zIndex = 30;
      // containerEl must be positioned; ensure relative without breaking layout
      var prevPos = getComputedStyle(containerEl).position;
      var restore = false;
      if(prevPos === 'static' || !prevPos){
        containerEl.style.position = 'relative';
        restore = true;
      }
      containerEl.appendChild(tick);
      setTimeout(function(){
        try{ tick.remove(); if(restore){ containerEl.style.position = ''; } }catch(e){}
      }, 900);
    }catch(e){}
  };
})();

</script>

<script>

/* v2.5.3c: persistent tick setter */
(function(){
  window.__setPermanentTick = function(containerEl, clientX, clientY){
    try{
      if(!containerEl) return;
      // remove any old permanent tick
      var old = containerEl.querySelector('.click-tick-fixed');
      if(old){ try{ old.remove(); }catch(e){} }
      var rect = containerEl.getBoundingClientRect();
      var x = clientX - rect.left;
      var y = clientY - rect.top;
      var tick = document.createElement('div');
      tick.className = 'click-tick-fixed';
      tick.textContent = '‚úì';
      tick.style.left = x + 'px';
      tick.style.top = y + 'px';
      tick.style.position = 'absolute';
      tick.style.zIndex = 30;
      // ensure relative positioning
      var prevPos = getComputedStyle(containerEl).position;
      if(prevPos === 'static' || !prevPos){
        containerEl.dataset.tempRel = '1';
        containerEl.style.position = 'relative';
      }
      containerEl.appendChild(tick);
    }catch(e){}
  };
})();

</script>

<script>

/* === v2.5.4: override renderMatching with animated connector lines === */
(function(){
  function _centerRight(el, container){
    const r=el.getBoundingClientRect(), p=container.getBoundingClientRect();
    return {x:r.left-p.left+r.width, y:r.top-p.top+r.height/2};
  }
  function _centerLeft(el, container){
    const r=el.getBoundingClientRect(), p=container.getBoundingClientRect();
    return {x:r.left-p.left, y:r.top-p.top+r.height/2};
  }

  window.renderMatching = function(q){
    const container=document.createElement('div'); container.className='relative bg-white rounded-2xl shadow p-4 md:p-6';
    const grid=document.createElement('div'); grid.className='grid grid-cols-2 gap-12 md:gap-16';
    const colA=document.createElement('div'); const colB=document.createElement('div');
    colA.innerHTML='<div class="font-bold text-blue-700 mb-2">C·ªôt A</div>'; 
    colB.innerHTML='<div class="font-bold text-blue-700 mb-2">C·ªôt B</div>';
    const listA=document.createElement('div'); listA.className='space-y-4';
    const listB=document.createElement('div'); listB.className='space-y-4';

    (q.columnA||[]).forEach(txt=>{
      const it=document.createElement('button');
      it.className='btn-answer w-full text-left p-3 bg-sky-50 hover:bg-sky-100 rounded-xl border border-sky-200';
      it.innerText=(typeof txt==='string')?txt:(txt.text||''); 
      it.dataset.key=(typeof txt==='string')?txt:(txt.text||'');
      listA.appendChild(it);
    });
    (q.columnB||[]).forEach(txt=>{
      const it=document.createElement('button');
      it.className='btn-answer w-full text-left p-3 bg-rose-50 hover:bg-rose-100 rounded-xl border border-rose-200';
      it.innerText=txt; it.dataset.key=txt; listB.appendChild(it);
    });

    colA.appendChild(listA); colB.appendChild(listB); grid.appendChild(colA); grid.appendChild(colB); container.appendChild(grid);

    // SVG overlay for connector lines & dots
    const svg=document.createElementNS('http://www.w3.org/2000/svg','svg');
    svg.setAttribute('class','absolute inset-0 pointer-events-none'); 
    svg.setAttribute('width','100%'); svg.setAttribute('height','100%');
    container.appendChild(svg);

    // State
    let selectedA=null, selectedB=null;
    const links=[]; // {aKey,bKey,new:true?}

    function redraw(){
      while(svg.firstChild) svg.removeChild(svg.firstChild);
      links.forEach(link=>{
        const aEl=[...listA.children].find(n=>n.dataset.key===link.aKey);
        const bEl=[...listB.children].find(n=>n.dataset.key===link.bKey);
        if(!aEl||!bEl) return;
        const p1=_centerRight(aEl, container), p2=_centerLeft(bEl, container);

        // path
        const path=document.createElementNS('http://www.w3.org/2000/svg','path');
        const d='M '+p1.x+' '+p1.y+' C '+(p1.x+60)+' '+p1.y+', '+(p2.x-60)+' '+p2.y+', '+p2.x+' '+p2.y;
        path.setAttribute('d', d); 
        path.setAttribute('fill','none'); 
        path.setAttribute('class','match-line'+(link.new?' match-line-new':''));
        svg.appendChild(path);

        // dots
        const c1=document.createElementNS('http://www.w3.org/2000/svg','circle');
        c1.setAttribute('cx', p1.x); c1.setAttribute('cy', p1.y); c1.setAttribute('r','6'); c1.setAttribute('class','match-dot');
        const c2=document.createElementNS('http://www.w3.org/2000/svg','circle');
        c2.setAttribute('cx', p2.x); c2.setAttribute('cy', p2.y); c2.setAttribute('r','6'); c2.setAttribute('class','match-dot');
        svg.appendChild(c1); svg.appendChild(c2);

        link.new=false;
      });
    }

    function chooseA(key, btn){
      // remove previous mapping of A (if any)
      const idx=links.findIndex(l=>l.aKey===key);
      if(idx!==-1) links.splice(idx,1);
      if(selectedA===key){
        selectedA=null; btn.classList.remove('ring','ring-4','ring-blue-400','bg-sky-200'); redraw(); return;
      }
      selectedA=key;
      [...listA.children].forEach(b=>b.classList.remove('ring','ring-4','ring-blue-400','bg-sky-200'));
      btn.classList.add('ring','ring-4','ring-blue-400','bg-sky-200');
      if(selectedB){
        // remove mapping of this B
        const idb=links.findIndex(l=>l.bKey===selectedB);
        if(idb!==-1) links.splice(idb,1);
        links.push({aKey:selectedA,bKey:selectedB,new:true});
        selectedA=null; selectedB=null;
        [...listA.children].forEach(b=>b.classList.remove('ring','ring-4','ring-blue-400','bg-sky-200'));
        [...listB.children].forEach(b=>b.classList.remove('ring','ring-4','ring-red-400','bg-rose-200'));
        redraw();
      }
    }
    function chooseB(key, btn){
      // remove previous mapping of B (if any)
      const idx=links.findIndex(l=>l.bKey===key);
      if(idx!==-1) links.splice(idx,1);
      if(selectedB===key){
        selectedB=null; btn.classList.remove('ring','ring-4','ring-red-400','bg-rose-200'); redraw(); return;
      }
      selectedB=key;
      [...listB.children].forEach(b=>b.classList.remove('ring','ring-4','ring-red-400','bg-rose-200'));
      btn.classList.add('ring','ring-4','ring-red-400','bg-rose-200');
      if(selectedA){
        const ida=links.findIndex(l=>l.aKey===selectedA);
        if(ida!==-1) links.splice(ida,1);
        links.push({aKey:selectedA,bKey:selectedB,new:true});
        selectedA=null; selectedB=null;
        [...listA.children].forEach(b=>b.classList.remove('ring','ring-4','ring-blue-400','bg-sky-200'));
        [...listB.children].forEach(b=>b.classList.remove('ring','ring-4','ring-red-400','bg-rose-200'));
        redraw();
      }
    }

    // Bind events
    [...listA.children].forEach(btn=> btn.addEventListener('click', ()=>chooseA(btn.dataset.key, btn)));
    [...listB.children].forEach(btn=> btn.addEventListener('click', ()=>chooseB(btn.dataset.key, btn)));

    // Clear & Check
    const clearBtn=document.createElement('button');
    clearBtn.className='btn-hover mt-4 w-full p-2 bg-gray-300 text-gray-800 rounded-xl font-bold text-sm';
    clearBtn.innerText='X√≥a t·∫•t c·∫£ c√°c n·ªëi';
    clearBtn.addEventListener('click', ()=>{
      links.length=0; selectedA=null; selectedB=null; 
      [...listA.children].forEach(b=>b.classList.remove('ring','ring-4','ring-blue-400','bg-sky-200'));
      [...listB.children].forEach(b=>b.classList.remove('ring','ring-4','ring-red-400','bg-rose-200'));
      redraw();
    });
    container.appendChild(clearBtn);

    const check=document.createElement('button');
    check.className='btn-hover mt-6 w-full p-4 bg-blue-600 text-white rounded-xl font-bold text-lg';
    check.innerText='Ki·ªÉm tra ƒë√°p √°n';
    check.addEventListener('click', ()=>{
      const ok = Object.keys(q.correctMatches||{}).every(k=>{
        const t=q.correctMatches[k]; const found=links.find(l=>l.aKey===k && l.bKey===t);
        return !!found;
      });
      handleResult(ok, check);
    });
    container.appendChild(check);

    answerArea().appendChild(container);
    setTimeout(redraw, 60);
    window.addEventListener('resize', ()=>{
      if(!document.getElementById('page-quiz').classList.contains('hidden')) redraw();
    });
  };
})();

</script>
<!-- v2.5.7-stable: runtime error overlay -->
<div id="app-error" class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/50">
  <div class="bg-white rounded-2xl p-6 w-96 text-center">
    <div class="text-2xl font-bold text-red-600 mb-2">ƒê√£ x·∫£y ra l·ªói</div>
    <div class="msg text-gray-700 break-words text-sm">ƒê√£ c√≥ l·ªói trong qu√° tr√¨nh ch·∫°y. B·∫°n h√£y b·∫•m "T·∫£i l·∫°i trang".</div>
    <button class="mt-4 px-4 py-2 rounded-xl bg-blue-600 text-white" onclick="location.reload()">T·∫£i l·∫°i trang</button>
  </div>
</div>

<script>
window.MINIGAME_CFG = {
  "version": "1.0",
  "generated_at": "2025-11-01 16:47:36.631485+07:00",
  "scoring": {
    "per_correct": 10,
    "per_wrong": -2,
    "time_bonus_per_sec_left": 0.2,
    "streak_bonus": [
      0,
      0,
      2,
      4,
      6,
      8
    ],
    "three_star_threshold": 85,
    "two_star_threshold": 70,
    "one_star_threshold": 50,
    "combo_window_sec": 6,
    "lives": 3
  },
  "game_types": {
    "flash_tap": "Ch·ªçn ƒë√°p √°n ƒë√∫ng trong th·ªùi gian gi·ªõi h·∫°n.",
    "line_match": "N·ªëi c·∫∑p ƒë√∫ng b·∫±ng k√©o th·∫£ d√¢y.",
    "drag_sort": "K√©o th·∫£ s·∫Øp x·∫øp ƒë√∫ng th·ª© t·ª± c√°c b∆∞·ªõc.",
    "folder_maze": "ƒêi theo ƒë∆∞·ªùng d·∫´n ƒë√∫ng ƒë·ªÉ m·ªü t·ªáp.",
    "typing_sprint": "G√µ ph√≠m/t·ªï h·ª£p ph√≠m ho·∫∑c t·ª´ kho√° ƒë√∫ng.",
    "ui_place": "ƒê·∫∑t nh√£n v√†o ƒë√∫ng v·ªã tr√≠ n√∫t/bi·ªÉu t∆∞·ª£ng tr√™n giao di·ªán.",
    "keyword_racer": "Ch·ªçn t·ª´ kho√° t·ªët nh·∫•t ƒë·ªÉ 'tƒÉng t·ªëc' xe.",
    "copyright_guard": "Ch·ªçn h√†nh ƒë·ªông ƒë√∫ng v·ªÅ b·∫£n quy·ªÅn/an to√†n."
  },
  "games": {
    "lop3": [
      {
        "id": "l3_flash_tap_hardware_software",
        "type": "flash_tap",
        "topic": "Ph·∫ßn c·ª©ng vs. ph·∫ßn m·ªÅm",
        "time_limit_sec": 60,
        "questions": [
          {
            "q": "Chu·ªôt m√°y t√≠nh l√† ph·∫ßn‚Ä¶",
            "options": [
              {
                "text": "c·ª©ng",
                "correct": true
              },
              {
                "text": "m·ªÅm",
                "correct": false
              }
            ]
          },
          {
            "q": "Word l√† ph·∫ßn‚Ä¶",
            "options": [
              {
                "text": "m·ªÅm",
                "correct": true
              },
              {
                "text": "c·ª©ng",
                "correct": false
              }
            ]
          },
          {
            "q": "M√†n h√¨nh thu·ªôc:",
            "options": [
              {
                "text": "Ph·∫ßn c·ª©ng",
                "correct": true
              },
              {
                "text": "Ph·∫ßn m·ªÅm",
                "correct": false
              }
            ]
          },
          {
            "q": "Paint d√πng ƒë·ªÉ:",
            "options": [
              {
                "text": "V·∫Ω h√¨nh",
                "correct": true
              },
              {
                "text": "Nghe nh·∫°c",
                "correct": false
              }
            ]
          },
          {
            "q": "Tr√¨nh duy·ªát web d√πng ƒë·ªÉ:",
            "options": [
              {
                "text": "Truy c·∫≠p trang web",
                "correct": true
              },
              {
                "text": "In gi·∫•y",
                "correct": false
              }
            ]
          }
        ]
      },
      {
        "id": "l3_typing_sprint_basics",
        "type": "typing_sprint",
        "topic": "G√µ ph√≠m ƒë√∫ng c√°ch",
        "time_limit_sec": 70,
        "questions": [
          {
            "prompt": "G√µ t·ªï h·ª£p ƒë·ªÉ vi·∫øt hoa nhanh: gi·ªØ ‚Ä¶ + ch·ªØ",
            "expected": "Shift"
          },
          {
            "prompt": "G√µ t·ª´ kho√°: 'hoc tin hoc'",
            "expected": "hoc tin hoc"
          },
          {
            "prompt": "Ph√≠m t·∫°o d√≤ng m·ªõi",
            "expected": "Enter"
          },
          {
            "prompt": "Xo√° b√™n tr√°i con tr·ªè (t√™n ph√≠m)",
            "expected": "Backspace"
          }
        ]
      },
      {
        "id": "l3_keyword_racer_safe_search",
        "type": "keyword_racer",
        "topic": "T·ª´ kho√° & an to√†n Internet",
        "time_limit_sec": 75,
        "questions": [
          {
            "q": "Mu·ªën t√¨m h√¨nh ·∫£nh con m√®o, t·ª´ kho√° t·ªët nh·∫•t l√†?",
            "options": [
              {
                "text": "H√¨nh ·∫£nh con m√®o",
                "correct": true
              },
              {
                "text": "T√¥i y√™u m√®o l·∫Øm",
                "correct": false
              },
              {
                "text": "·∫¢nh ƒë·∫πp",
                "correct": false
              }
            ]
          },
          {
            "q": "Th·∫•y trang kh√¥ng ph√π h·ª£p v·ªõi l·ª©a tu·ªïi, em n√™n:",
            "options": [
              {
                "text": "ƒê√≥ng trang v√† b√°o ng∆∞·ªùi l·ªõn",
                "correct": true
              },
              {
                "text": "Ti·∫øp t·ª•c xem",
                "correct": false
              },
              {
                "text": "Chia s·∫ª cho b·∫°n",
                "correct": false
              }
            ]
          },
          {
            "q": "Bi·ªÉu t∆∞·ª£ng tr√¨nh duy·ªát web:",
            "options": [
              {
                "text": "üåê",
                "correct": true
              },
              {
                "text": "üéÆ",
                "correct": false
              },
              {
                "text": "üìé",
                "correct": false
              }
            ]
          }
        ]
      }
    ],
    "lop4": [
      {
        "id": "l4_folder_maze_paths",
        "type": "folder_maze",
        "topic": "C√¢y th∆∞ m·ª•c & thao t√°c t·ªáp",
        "time_limit_sec": 90,
        "questions": [
          {
            "start": "This PC",
            "target": "D:/HocTap/TinHoc/Bai4.docx",
            "choices": [
              "C:/",
              "D:/",
              "HocTap",
              "TinHoc",
              "Bai4.docx"
            ],
            "correct_path": [
              "D:/",
              "HocTap",
              "TinHoc",
              "Bai4.docx"
            ]
          },
          {
            "start": "This PC",
            "target": "D:/Lop4A/Nhom1/Anh/hoahong.jpg",
            "choices": [
              "C:/",
              "D:/",
              "Lop4A",
              "Nhom1",
              "Anh",
              "hoahong.jpg"
            ],
            "correct_path": [
              "D:/",
              "Lop4A",
              "Nhom1",
              "Anh",
              "hoahong.jpg"
            ]
          }
        ]
      },
      {
        "id": "l4_drag_sort_ppt_flow",
        "type": "drag_sort",
        "topic": "Tr√¨nh chi·∫øu: quy tr√¨nh t·∫°o file",
        "time_limit_sec": 80,
        "sequence_title": "S·∫Øp x·∫øp quy tr√¨nh ƒë√∫ng",
        "items": [
          "Insert ‚Üí Pictures",
          "Ch·ªçn ·∫£nh",
          "Save As ƒë·∫∑t t√™n",
          "M·ªü PowerPoint",
          "Th√™m ti√™u ƒë·ªÅ trang chi·∫øu"
        ],
        "correct_order": [
          "M·ªü PowerPoint",
          "Th√™m ti√™u ƒë·ªÅ trang chi·∫øu",
          "Insert ‚Üí Pictures",
          "Ch·ªçn ·∫£nh",
          "Save As ƒë·∫∑t t√™n"
        ]
      },
      {
        "id": "l4_line_match_web_info",
        "type": "line_match",
        "topic": "Th√¥ng tin tr√™n trang web",
        "time_limit_sec": 70,
        "pairs": {
          "VƒÉn b·∫£n": "Ch·ªØ vi·∫øt tr√™n trang",
          "H√¨nh ·∫£nh": "·∫¢nh minh ho·∫°",
          "√Çm thanh": "File nghe ƒë∆∞·ª£c",
          "Si√™u li√™n k·∫øt": "Nh√°y ƒë·ªÉ chuy·ªÉn trang"
        }
      }
    ],
    "lop5": [
      {
        "id": "l5_ui_place_word_ribbon",
        "type": "ui_place",
        "topic": "Word: B/I/U & Wrap Text",
        "time_limit_sec": 90,
        "background_hint": "·∫¢nh thanh Ribbon (Home/Insert)",
        "targets": [
          "B (Bold)",
          "I (Italic)",
          "U (Underline)",
          "Insert ‚Üí Pictures",
          "Wrap Text ‚Üí Square"
        ],
        "items": [
          "L√†m ƒë·∫≠m ti√™u ƒë·ªÅ",
          "L√†m nghi√™ng ch·ªØ",
          "G·∫°ch ch√¢n",
          "Ch√®n ·∫£nh t·ª´ m√°y",
          "VƒÉn b·∫£n bao quanh h√¨nh"
        ],
        "correct_map": {
          "L√†m ƒë·∫≠m ti√™u ƒë·ªÅ": "B (Bold)",
          "L√†m nghi√™ng ch·ªØ": "I (Italic)",
          "G·∫°ch ch√¢n": "U (Underline)",
          "Ch√®n ·∫£nh t·ª´ m√°y": "Insert ‚Üí Pictures",
          "VƒÉn b·∫£n bao quanh h√¨nh": "Wrap Text ‚Üí Square"
        }
      },
      {
        "id": "l5_copyright_guard",
        "type": "copyright_guard",
        "topic": "B·∫£n quy·ªÅn & tr√≠ch d·∫´n",
        "time_limit_sec": 80,
        "questions": [
          {
            "q": "Mu·ªën d√πng ·∫£nh tr√™n m·∫°ng cho b√†i thuy·∫øt tr√¨nh, em n√™n:",
            "options": [
              {
                "text": "Xin ph√©p & ghi ngu·ªìn",
                "correct": true
              },
              {
                "text": "T·∫£i v·ªÅ d√πng lu√¥n",
                "correct": false
              },
              {
                "text": "S·ª≠a m√†u l√† d√πng ƒë∆∞·ª£c",
                "correct": false
              }
            ]
          },
          {
            "q": "K√≠ hi·ªáu b·∫£n quy·ªÅn th∆∞·ªùng g·∫∑p:",
            "options": [
              {
                "text": "¬©",
                "correct": true
              },
              {
                "text": "‚Ñ¢",
                "correct": false
              },
              {
                "text": "‚ÑπÔ∏è",
                "correct": false
              }
            ]
          },
          {
            "q": "B·∫°n chia s·∫ª phim c√≥ b·∫£n quy·ªÅn, em n√™n:",
            "options": [
              {
                "text": "Nh·∫Øc b·∫°n d·ª´ng & b√°o ng∆∞·ªùi l·ªõn",
                "correct": true
              },
              {
                "text": "Chia s·∫ª ti·∫øp",
                "correct": false
              },
              {
                "text": "L·ªù ƒëi",
                "correct": false
              }
            ]
          }
        ]
      },
      {
        "id": "l5_keyword_racer_advanced",
        "type": "keyword_racer",
        "topic": "T·ª´ kho√° n√¢ng cao",
        "time_limit_sec": 75,
        "questions": [
          {
            "q": "T√¨m c√°ch b·∫£o v·ªá m√¥i tr∆∞·ªùng: ch·ªçn t·ª´ kho√° t·ªët nh·∫•t",
            "options": [
              {
                "text": "C√°ch b·∫£o v·ªá m√¥i tr∆∞·ªùng",
                "correct": true
              },
              {
                "text": "M√¥i tr∆∞·ªùng",
                "correct": false
              },
              {
                "text": "T√¥i y√™u m√¥i tr∆∞·ªùng",
                "correct": false
              }
            ]
          },
          {
            "q": "Mu·ªën t√¨m ·∫£nh: n√™n v√†o th·∫ª n√†o c·ªßa c√¥ng c·ª• t√¨m ki·∫øm?",
            "options": [
              {
                "text": "H√¨nh ·∫£nh (Images)",
                "correct": true
              },
              {
                "text": "Video",
                "correct": false
              },
              {
                "text": "Tin t·ª©c",
                "correct": false
              }
            ]
          }
        ]
      }
    ]
  }
};

(function(){
  const cfg = window.MINIGAME_CFG || {};
  const scoring = cfg.scoring || { per_correct:10, per_wrong:-2, time_bonus_per_sec_left:0.2, streak_bonus:[0,0,2,4,6,8], three_star_threshold:85, two_star_threshold:70, one_star_threshold:50, combo_window_sec:6, lives:3 };

  const state = {
    grade: 'L·ªõp 3',
    current: null,
    qIndex: 0,
    score: 0,
    lives: scoring.lives,
    streak: 0,
    timer: null,
    timeLeft: null,
    correctCount: 0,
    totalCount: 0
  };

  const $ = sel => document.querySelector(sel);
  const el = id => document.getElementById(id);
  function setRaceVisible(v){ el('race-wrap').classList.toggle('hidden', !v); }
  function resetRace(){ ['player-bear','player-rabbit'].forEach(id=>{ const n=el(id); if(n) n.style.transform='translateX(0px)'; }); }
  function moveBear(px){ const n=el('player-bear'); if(n) n.style.transform = `translateX(${px}px)`; }
  function moveRabbit(px){ const n=el('player-rabbit'); if(n) n.style.transform = `translateX(${px}px)`; }
  function updateHUD(){
    el('game-score').innerText = state.score;
    el('game-lives').innerText = state.lives;
    el('game-timer').innerText = state.timeLeft !== null ? state.timeLeft + 's' : '--';
  }
  function addScore(baseBonus=0){
    const streakBonus = scoring.streak_bonus[Math.min(state.streak, scoring.streak_bonus.length-1)] || 0;
    state.score += scoring.per_correct + baseBonus + streakBonus;
    state.streak = Math.min(state.streak+1, scoring.streak_bonus.length-1);
  }
  function addWrong(){
    state.score += scoring.per_wrong;
    state.lives -= 1;
    state.streak = 0;
  }
  function starsFromScore(){
    const s = Math.max(0, Math.round(state.score));
    if (s >= scoring.three_star_threshold) return 3;
    if (s >= scoring.two_star_threshold) return 2;
    if (s >= scoring.one_star_threshold) return 1;
    return 0;
  }
  function endGame(){
    try {
      const s = window.userScores && window.userScores[state.grade];
      if (s) {
        const st = starsFromScore();
        s.totalStars = (s.totalStars||0) + st;
        s.completedCount = (s.completedCount||0) + 1;
        s.correctAnswers = (s.correctAnswers||0) + state.correctCount;
        s.totalAnswers = (s.totalAnswers||0) + state.totalCount;
        window.saveScores && window.saveScores();
      }
    }catch(e){}

    const st = starsFromScore();
    const msg = [
      `ƒêi·ªÉm: ${Math.max(0, Math.round(state.score))}`,
      `Sao: ${'‚≠ê'.repeat(st) || '0'}`,
      `ƒê√∫ng/ T·ªïng: ${state.correctCount} / ${state.totalCount}`
    ].join('\n');
    el('game-summary-text').innerText = msg;
    el('game-summary').classList.remove('hidden');
  }

  function startTimer(sec){
    state.timeLeft = sec;
    updateHUD();
    if (state.timer) clearInterval(state.timer);
    state.timer = setInterval(()=>{
      state.timeLeft -= 1;
      if (state.timeLeft <= 0) {
        clearInterval(state.timer); state.timer=null;
        addWrong();
        updateHUD();
        nextQuestion();
      } else updateHUD();
    }, 1000);
  }
  function stopTimer(){ if(state.timer){ clearInterval(state.timer); state.timer=null; }}

  function renderFlashTap(q){
    setRaceVisible(true);
    const stage = el('game-stage'); stage.innerHTML='';
    const wrap = document.createElement('div'); wrap.className='grid grid-cols-1 md:grid-cols-2 gap-4';
    (q.options||[]).forEach(opt=>{
      const btn = document.createElement('button');
      btn.className='game-option btn-hover text-left text-lg p-5 bg-white rounded-2xl shadow border-2 border-transparent hover:border-blue-500';
      btn.textContent = opt.text || opt;
      btn.addEventListener('click', ()=>{
        state.totalCount += 1;
        if (opt.correct) {
          state.correctCount += 1;
          addScore(Math.floor((state.timeLeft||0)*scoring.time_bonus_per_sec_left));
          moveBear((state.qIndex+1)*40);
          showFeedback(true);
        } else {
          addWrong();
          moveRabbit((state.qIndex+1)*40);
          showFeedback(false);
        }
        updateHUD(); el('game-next').classList.remove('hidden'); disableAll(wrap);
      });
      wrap.appendChild(btn);
    });
    stage.appendChild(wrap);
  }

  function renderKeywordRacer(q){
    setRaceVisible(false);
    const stage = el('game-stage'); stage.innerHTML='';
    const wrap = document.createElement('div'); wrap.className='grid grid-cols-1 md:grid-cols-2 gap-4';
    (q.options||[]).forEach(opt=>{
      const btn = document.createElement('button');
      btn.className='btn-hover text-left text-lg p-5 bg-white rounded-2xl shadow border border-gray-200 hover:border-blue-500';
      btn.textContent = opt.text || opt;
      btn.addEventListener('click', ()=>{
        state.totalCount += 1;
        if (opt.correct) { state.correctCount += 1; addScore(); showFeedback(true); }
        else { addWrong(); showFeedback(false); }
        updateHUD(); el('game-next').classList.remove('hidden'); disableAll(wrap);
      });
      wrap.appendChild(btn);
    });
    stage.appendChild(wrap);
  }

  function renderTypingSprint(q){
    setRaceVisible(false);
    const stage = el('game-stage'); stage.innerHTML='';
    const input = document.createElement('input');
    input.className='w-full p-4 rounded-xl border';
    input.placeholder='Nh·∫≠p c√¢u tr·∫£ l·ªùi...';
    const btn = document.createElement('button');
    btn.className='mt-3 w-full p-3 rounded-xl bg-blue-600 text-white font-bold';
    btn.textContent='Ki·ªÉm tra';
    btn.addEventListener('click', ()=>{
      const lower = s => (s||'').toString().trim().toLowerCase();
      const val = lower(input.value);
      state.totalCount += 1;
      let ok = false;
      if (Array.isArray(q.expected)) ok = q.expected.some(x=>lower(x)===val);
      else ok = lower(q.expected)===val;
      if (ok) { state.correctCount += 1; addScore(); showFeedback(true); }
      else { addWrong(); showFeedback(false); }
      updateHUD(); el('game-next').classList.remove('hidden'); input.disabled=true; btn.disabled=true;
    });
    stage.appendChild(input); stage.appendChild(btn);
  }

  function renderLineMatch(q){
    setRaceVisible(false);
    const stage = el('game-stage'); stage.innerHTML='';
    const left = document.createElement('div'); const right = document.createElement('div');
    left.className='space-y-2'; right.className='space-y-2';
    const wrap = document.createElement('div'); wrap.className='grid grid-cols-2 gap-6';
    const aItems = Object.keys(q.pairs || {});
    const bItems = aItems.map(k => q.pairs[k]);
    for (let i = bItems.length-1; i>0; i--) { const j = Math.floor(Math.random()*(i+1)); [bItems[i],bItems[j]]=[bItems[j],bItems[i]]; }
    let selectedA = null; let matched = 0;
    const makeBtn = (txt) => { const b=document.createElement('button'); b.className='w-full text-left p-3 rounded-xl border bg-white hover:border-blue-500'; b.textContent=txt; return b; };
    const aBtns = aItems.map(k=>{ const b=makeBtn(k); b.dataset.key=k; b.addEventListener('click',()=>{ aBtns.forEach(x=>x.classList.remove('row-selected')); b.classList.add('row-selected'); selectedA = k; }); return b; });
    const bBtns = bItems.map(txt=>{ const b=makeBtn(txt); b.addEventListener('click',()=>{
      if(!selectedA) return;
      const correct = (q.pairs[selectedA]===txt);
      state.totalCount += 1;
      if(correct){ state.correctCount+=1; addScore(); b.classList.add('row-glow'); b.disabled=true; const ab=aBtns.find(x=>x.dataset.key===selectedA); if(ab) ab.disabled=true; matched++; showFeedback(true, 'ƒê√£ n·ªëi ƒë√∫ng 1 c·∫∑p'); }
      else { addWrong(); showFeedback(false, 'Ch∆∞a ƒë√∫ng, th·ª≠ l·∫°i c·∫∑p kh√°c'); }
      updateHUD(); if(matched===aItems.length) el('game-next').classList.remove('hidden');
    }); return b; });
    aBtns.forEach(b=>left.appendChild(b)); bBtns.forEach(b=>right.appendChild(b));
    wrap.appendChild(left); wrap.appendChild(right); stage.appendChild(wrap);
  }

  function renderDragSort(game){
    setRaceVisible(false);
    const stage = el('game-stage'); stage.innerHTML='';
    const list = document.createElement('ul'); list.className='space-y-2';
    (game.items||[]).forEach((txt,i)=>{
      const li = document.createElement('li');
      li.className='p-3 rounded-xl border bg-white flex items-center justify-between gap-2';
      li.draggable=true;
      li.dataset.idx=i;
      const span=document.createElement('span'); span.textContent=txt;
      li.appendChild(span);
      list.appendChild(li);
    });
    let dragEl=null;
    list.addEventListener('dragstart', e=>{ dragEl=e.target; e.dataTransfer.effectAllowed='move'; });
    list.addEventListener('dragover', e=>{ e.preventDefault(); const t=e.target.closest('li'); if(!t||t===dragEl) return; const rect=t.getBoundingClientRect(); const next=(e.clientY-rect.top)/(rect.height) > 0.5; list.insertBefore(dragEl, next?t.nextSibling:t); });
    list.addEventListener('drop', e=>{ e.preventDefault(); });
    const btn = document.createElement('button');
    btn.className='mt-3 w-full p-3 rounded-xl bg-blue-600 text-white font-bold';
    btn.textContent='N·ªôp th·ª© t·ª±';
    btn.addEventListener('click', ()=>{
      const cur = Array.from(list.querySelectorAll('li')).map(li=>li.querySelector('span').textContent);
      const ok = JSON.stringify(cur) === JSON.stringify(game.correct_order||[]);
      state.totalCount += 1;
      if (ok) { state.correctCount+=1; addScore(); showFeedback(true); }
      else { addWrong(); showFeedback(false); }
      updateHUD(); el('game-next').classList.remove('hidden'); btn.disabled=true;
    });
    stage.appendChild(list); stage.appendChild(btn);
  }

  function renderFolderMaze(q){
    setRaceVisible(false);
    const stage = el('game-stage'); stage.innerHTML='';
    const path = document.createElement('div'); path.className='text-sm text-gray-600 mb-2';
    path.textContent='ƒê√≠ch: '+(q.target||'');
    const wrap = document.createElement('div'); wrap.className='flex flex-wrap gap-2';
    let progress = [];
    (q.choices||[]).forEach(ch=>{
      const b=document.createElement('button'); b.className='px-3 py-2 rounded-lg border bg-white hover:border-blue-500'; b.textContent=ch;
      b.addEventListener('click',()=>{
        progress.push(ch);
        const ok = JSON.stringify(progress)===JSON.stringify((q.correct_path||[]).slice(0,progress.length));
        if(!ok){
          addWrong(); showFeedback(false,'Sai nh√°nh, quay l·∫°i ƒë·∫ßu!'); progress=[];
        } else {
          showFeedback(true,'ƒê√∫ng b∆∞·ªõc');
          if(progress.length===(q.correct_path||[]).length){
            state.totalCount += 1; state.correctCount += 1; addScore(); el('game-next').classList.remove('hidden');
          }
        }
        updateHUD();
      });
      wrap.appendChild(b);
    });
    stage.appendChild(path); stage.appendChild(wrap);
  }

  function renderCopyrightGuard(q){ return renderKeywordRacer(q); }
  function disableAll(container){ container.querySelectorAll('button').forEach(b=>b.disabled=true); }
  function showFeedback(isCorrect, msg){
    const box = el('game-feedback');
    box.classList.remove('hidden');
    box.textContent = msg || (isCorrect ? 'Ch√≠nh x√°c! üéâ' : 'Ch∆∞a ƒë√∫ng, c·ªë l√™n!');
    box.className = 'mt-4 text-lg font-medium p-4 rounded-xl ' + (isCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800');
  }

  function renderQuestion(){
    if(!state.current) return;
    const game = state.current;
    if (!game._flatQ) {
      if (Array.isArray(game.questions)) game._flatQ = game.questions;
      else if (game.type==='drag_sort') game._flatQ = [game];
      else if (game.type==='line_match') game._flatQ = [{ question: game.sequence_title || 'N·ªëi ƒë√∫ng', pairs: game.pairs }];
      else if (game.type==='folder_maze') game._flatQ = [game];
      else game._flatQ = [];
    }
    if (state.qIndex >= (game._flatQ||[]).length) { stopTimer(); return endGame(); }
    const q = game._flatQ[state.qIndex];
    el('game-question-text').textContent = q.q || q.question || game.sequence_title || game.topic || 'C√¢u h·ªèi';
    el('game-feedback').classList.add('hidden');
    el('game-next').classList.add('hidden');
    stopTimer();
    if (game.time_limit_sec) startTimer(game.time_limit_sec);

    const t = game.type;
    if (t==='flash_tap') renderFlashTap(q);
    else if (t==='keyword_racer') renderKeywordRacer(q);
    else if (t==='typing_sprint') renderTypingSprint(q);
    else if (t==='line_match') renderLineMatch(q);
    else if (t==='drag_sort') renderDragSort(game);
    else if (t==='folder_maze') renderFolderMaze(q);
    else if (t==='ui_place') renderKeywordRacer(q);
    else if (t==='copyright_guard') renderCopyrightGuard(q);
    else renderKeywordRacer(q);
  }

  function nextQuestion(){ state.qIndex += 1; renderQuestion(); }

  function renderGameList(){
    const label = el('game-grade-label');
    if (label) label.textContent = state.grade;
    const list = el('game-list'); list.innerHTML='';
    const group = (state.grade==='L·ªõp 3') ? cfg.games.lop3 : (state.grade==='L·ªõp 4') ? cfg.games.lop4 : cfg.games.lop5;
    if (!group || !group.length){
      list.innerHTML = '<div class="col-span-full text-center text-gray-600">Ch∆∞a c√≥ game. Vui l√≤ng th√™m v√†o c·∫•u h√¨nh.</div>';
      return;
    }
    group.forEach(g=>{
      const card = document.createElement('button');
      card.className='btn-hover text-left p-4 rounded-2xl bg-white border shadow hover:border-blue-500';
      card.innerHTML = `<div class="font-bold text-lg mb-1">${g.topic || 'Mini game'}</div>
                        <div class="text-sm text-gray-600">Lo·∫°i: <b>${g.type}</b> ‚Ä¢ Gi·ªõi h·∫°n: ${g.time_limit_sec||'‚Äî'}s</div>`;
      card.addEventListener('click', ()=> startGame(g));
      list.appendChild(card);
    });
    el('game-play').classList.add('hidden');
    el('game-list').classList.remove('hidden');
  }

  function startGame(g){
    state.current = JSON.parse(JSON.stringify(g));
    state.qIndex = 0; state.score = 0; state.lives = scoring.lives; state.streak = 0;
    state.correctCount = 0; state.totalCount = 0; resetRace(); updateHUD();
    el('game-list').classList.add('hidden'); el('game-play').classList.remove('hidden');
    setRaceVisible(g.type==='flash_tap');
    renderQuestion();
  }

  window.addEventListener('DOMContentLoaded', ()=>{
    try{ if(window.currentGrade) state.grade = window.currentGrade; }catch(e){}
    document.querySelectorAll('.game-grade-btn').forEach(b=>b.addEventListener('click', ()=>{ state.grade = b.dataset.grade; renderGameList(); }));
    const backBtn = el('game-back-list'); if(backBtn) backBtn.addEventListener('click', ()=>{ stopTimer(); renderGameList(); });
    const nextBtn = el('game-next'); if(nextBtn) nextBtn.addEventListener('click', nextQuestion);
    const closeSum = el('game-summary-close'); if(closeSum) closeSum.addEventListener('click', ()=>{ el('game-summary').classList.add('hidden'); renderGameList(); });
  });

  const _showPage = window.showPage;
  window.showPage = function(id){ _showPage && _showPage(id); if (id==='page-game') renderGameList(); };
})();
</script>

  <!-- ===== Chatbot toggle & panel (added by ChatGPT) ===== -->
  <button id="gau-chat-toggle" class="kids-font rounded-full shadow-xl p-0 border-0" title="Chat v·ªõi G·∫•u Con">
    <img alt="G·∫•u Chat" src="data/images/logo.jpg" style="width:64px;height:64px;border-radius:50%;border:3px solid white;box-shadow:0 8px 24px rgba(2,6,23,.18)">
  </button>

  <section id="gau-chat-panel" class="kids-font">
    <div id="gau-chat-header">
      <div id="gau-chat-title">
        <span style="font-size:22px">üêª</span>
        <div>
          <div>G·∫•u Con Chatbot</div>
          <div class="gau-tip">Tr·∫£ l·ªùi ki·∫øn th·ª©c Tin h·ªçc l·ªõp 3‚Äì5 (c√≥ SGK/RAG)</div>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <label class="gau-tip">L·ªõp:</label>
        <select id="gau-grade" class="gau-select">
          <option value="auto">T·ª± nh·∫≠n di·ªán</option>
          <option value="current">Theo l·ªõp ƒëang ch·ªçn</option>
          <option value="3">L·ªõp 3</option>
          <option value="4">L·ªõp 4</option>
          <option value="5">L·ªõp 5</option>
        </select>
        <button id="gau-chat-close" aria-label="ƒê√≥ng">‚úñ</button>
      </div>
    </div>
    <div id="gau-chat-stream"></div>
    <div id="gau-chat-inputbar">
      <input id="gau-input" placeholder="G√µ c√¢u h·ªèi, v√≠ d·ª•: ‚ÄúTrong Word, n√∫t B d√πng ƒë·ªÉ l√†m g√¨?‚Äù" />
      <button id="gau-send">G·ª¨I</button>
    </div>
  </section>


<script>
// ====== G·∫•u Con Chatbot - Frontend (v2.7) ======
(function(){
  // Updated to latest Apps Script deployment URL for all features
  const WEBAPP_URL='https://script.google.com/macros/s/AKfycbyNcfoWBHaKcvvZr7L2i3u62_AhZmC53w-wS1PaW3SULV3-iUMP6kKH-4I7AGjOawO1/exec';

  const $ = (sel)=>document.querySelector(sel);
  const panel = $('#gau-chat-panel');
  const toggleBtn = $('#gau-chat-toggle');
  const closeBtn = $('#gau-chat-close');
  const stream = $('#gau-chat-stream');
  const input = $('#gau-input');
  const sendBtn = $('#gau-send');
  const gradeSel = $('#gau-grade');

  // open/close
  function openPanel(){ panel.style.display='block'; setTimeout(()=>input.focus(), 50); }
  function closePanel(){ panel.style.display='none'; }
  toggleBtn.addEventListener('click', ()=>{
    if (panel.style.display === 'block') {
      // if input has value -> send, else close/open
      if((input.value||'').trim().length>0) submitQuestion();
      else closePanel();
    } else {
      openPanel();
    }
  });
  closeBtn.addEventListener('click', closePanel);

  function scrollBottom(){ stream.scrollTop = stream.scrollHeight; }

  function addMsg(role, text, meta){
    const wrap = document.createElement('div');
    wrap.className = 'gau-msg ' + (role==='me' ? 'me' : 'ai');
    const bubble = document.createElement('div');
    bubble.className = 'gau-bubble ' + (role==='me' ? 'me-bubble' : 'ai-bubble');
    bubble.textContent = text;
    wrap.appendChild(bubble);
    if (meta && role!=='me'){
      const metaEl = document.createElement('div');
      metaEl.className = 'gau-meta';
      metaEl.textContent = meta;
      bubble.appendChild(document.createElement('br'));
      bubble.appendChild(metaEl);
    }
    stream.appendChild(wrap);
    scrollBottom();
  }

  let typingEl = null;
  function showTyping(){
    typingEl = document.createElement('div');
    typingEl.className = 'gau-msg ai typing';
    const b = document.createElement('div');
    b.className = 'gau-bubble ai-bubble';
    b.textContent = 'G·∫•u ƒëang suy nghƒ©...';
    typingEl.appendChild(b);
    stream.appendChild(typingEl);
    scrollBottom();
  }
  function hideTyping(){
    if (typingEl) { typingEl.remove(); typingEl=null; }
  }

  function currentGradeNumber(){
    try {
      const gText = (window.currentGrade || 'L·ªõp 3') + '';
      if (gText.includes('3')) return '3';
      if (gText.includes('4')) return '4';
      if (gText.includes('5')) return '5';
    } catch(e){}
    return '3';
  }

  async function submitQuestion(){
    const q = (input.value || '').trim();
    if (!q) return;
    addMsg('me', q);
    input.value='';
    showTyping();

    // choose grade
    let gradeParam = undefined;
    const sel = gradeSel.value;
    if (sel === '3' || sel==='4' || sel==='5') gradeParam = sel;
    else if (sel === 'current') gradeParam = currentGradeNumber(); // map from UI's current grade
    // else auto: undefined

    const payload = gradeParam ? { question: q, grade: gradeParam } : { question: q };

    try {
      const res = await fetch(WEBAPP_URL, {
        method: 'POST',
        mode: 'cors',
      credentials: 'omit',
      headers: { 'Content-Type': 'text/plain;charset=UTF-8' },
        body: JSON.stringify(payload)
      });
      hideTyping();
      if (!res.ok) {
        addMsg('ai', 'L·ªói g·ªçi Web App ('+res.status+'). Vui l√≤ng th·ª≠ l·∫°i.');
        return;
      }
      const data = await res.json();
      const ans = (data && data.answer) ? data.answer : 'G·∫•u ch∆∞a c√≥ c√¢u tr·∫£ l·ªùi.';

      // citations rendering
      let citeTxt = '';
      try {
        const mode = data.mode || '';
        const cites = Array.isArray(data.citations) ? data.citations : [];
        if (mode && mode.startsWith('SGK') && cites.length) {
          const short = cites.slice(0,2).map(c=>`L${c.grade} ‚Ä¢ ${c.lesson||'B√†i ?'} ‚Ä¢ tr.${c.page||'?'}`).join(' | ');
          citeTxt = 'Ngu·ªìn: ' + short;
        }
      } catch(e){}

      addMsg('ai', ans, citeTxt);
      // optional: speak
      try { if (window.speakText) speakText(ans); } catch(_){}
    } catch (err){
      hideTyping();
      addMsg('ai', 'L·ªói k·∫øt n·ªëi: ' + (err && err.message ? err.message : String(err)));
    }
  }

  sendBtn.addEventListener('click', submitQuestion);
  input.addEventListener('keydown', (e)=>{
    if (e.key === 'Enter') submitQuestion();
  });

  // expose minimal API for existing code (if any old calls)
  window.askGau = submitQuestion; // backward compatibility
  window.__askGau = submitQuestion;
})();
</script>


  <!-- === Auth Modal (v2.7.3) === -->
  <div id="auth-modal" class="fixed inset-0 bg-black/40 hidden items-center justify-center z-[70]">
    <div class="bg-white w-full max-w-md rounded-2xl p-6 shadow-2xl">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-xl font-extrabold text-blue-700">ƒêƒÉng Nh·∫≠p / ƒêƒÉng K√Ω</h3>
        <button id="auth-close" class="text-2xl leading-none text-gray-500 hover:text-gray-700">√ó</button>
      </div>
      <div id="auth-alert" class="hidden mb-3 text-sm p-3 rounded-md"></div>

      <div class="flex gap-2 mb-4">
        <button id="tab-login" class="flex-1 py-2 rounded-xl bg-blue-100 font-bold">ƒêƒÉng nh·∫≠p</button>
        <button id="tab-register" class="flex-1 py-2 rounded-xl bg-gray-100">ƒêƒÉng k√Ω</button>
      </div>

      <form id="form-login" class="space-y-3">
        <input name="student_id" autocomplete="username" placeholder="M√£ ƒë·ªãnh danh (vd: SA-0001)" class="w-full border rounded-xl p-3" required>
        <input name="pin" type="password" autocomplete="current-password" placeholder="PIN" class="w-full border rounded-xl p-3" required>
        <div class="text-xs text-gray-500">Ho·∫∑c v√†o ch·∫ø ƒë·ªô gi√°o vi√™n: ƒëi·ªÅn m·∫≠t kh·∫©u b√™n d∆∞·ªõi.</div>
        <input name="teacher_pass" type="password" placeholder="M·∫≠t kh·∫©u gi√°o vi√™n (tu·ª≥ ch·ªçn - 122025)" class="w-full border rounded-xl p-3">
        <button class="w-full bg-blue-600 hover:bg-blue-700 text-white rounded-xl p-3 font-bold" type="submit">ƒêƒÉng nh·∫≠p</button>
      </form>

      <form id="form-register" class="space-y-3 hidden">
        <input name="name" placeholder="T√™n h·ªçc sinh" class="w-full border rounded-xl p-3" required>
        <div class="grid grid-cols-2 gap-3">
          <input name="grade" placeholder="Kh·ªëi (3/4/5)" class="border rounded-xl p-3" required>
          <input name="class" placeholder="L·ªõp (vd: 5A)" class="border rounded-xl p-3" required>
        </div>
        <input name="student_id" placeholder="M√£ ƒë·ªãnh danh (t·ª± ƒë·∫∑t, kh√¥ng tr√πng)" class="w-full border rounded-xl p-3" required>
        <input name="pin" type="password" placeholder="T·∫°o PIN (‚â•4 k√Ω t·ª±)" class="w-full border rounded-xl p-3" required>
        <button class="w-full bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl p-3 font-bold" type="submit">T·∫°o t√†i kho·∫£n</button>
      </form>
    </div>
  </div>

<script>
(function(){
// Updated API URL to the latest GAS deployment
const AUTH_API = "https://script.google.com/macros/s/AKfycbyNcfoWBHaKcvvZr7L2i3u62_AhZmC53w-wS1PaW3SULV3-iUMP6kKH-4I7AGjOawO1/exec";
  const $ = (sel) => document.querySelector(sel);
  const modal = $("#auth-modal");
  const btnOpen = $("#auth-open-btn");
  const btnClose = $("#auth-close");
  const formLogin = $("#form-login");
  const formRegister = $("#form-register");
  const tabLogin = $("#tab-login");
  const tabRegister = $("#tab-register");
  const alertBox = $("#auth-alert");

  function openModal(){
    if (!modal) return;
    modal.classList.remove("hidden");
    modal.classList.add("flex");
    showLogin();
    showAlert(""); // clear
  }
  function closeModal(){
    if (!modal) return;
    modal.classList.add("hidden");
    modal.classList.remove("flex");
  }
  function showAlert(msg, type){
    if (!alertBox) return;
    if (!msg){
      alertBox.classList.add("hidden");
      alertBox.textContent = "";
      return;
    }
    alertBox.classList.remove("hidden");
    alertBox.textContent = msg;
    alertBox.className = "mb-3 text-sm p-3 rounded-md " + (type==="ok" ? "bg-green-100 text-green-700" : "bg-red-100 text-red-700");
  }
  function showLogin(){
    tabLogin.classList.add("bg-blue-100","font-bold");
    tabRegister.classList.remove("bg-blue-100","font-bold");
    formLogin.classList.remove("hidden");
    formRegister.classList.add("hidden");
  }
  function showRegister(){
    tabRegister.classList.add("bg-blue-100","font-bold");
    tabLogin.classList.remove("bg-blue-100","font-bold");
    formRegister.classList.remove("hidden");
    formLogin.classList.add("hidden");
  }

  if (btnOpen) btnOpen.addEventListener("click", openModal);
  if (btnClose) btnClose.addEventListener("click", closeModal);
  if (modal) modal.addEventListener("click", (e)=>{ if(e.target===modal) closeModal(); });
  if (tabLogin) tabLogin.addEventListener("click", showLogin);
  if (tabRegister) tabRegister.addEventListener("click", showRegister);

  async function postJson(payload){
    const res = await fetch(AUTH_API, { method: "POST", credentials: "omit",
      headers: { "Content-Type": "text/plain;charset=UTF-8" },
      body: JSON.stringify(payload),
      mode: "cors"
    });
    if(!res.ok) throw new Error("HTTP " + res.status);
      return res.json();
  }

  formLogin && formLogin.addEventListener("submit", async (e)=>{
    e.preventDefault();
    const fd = new FormData(formLogin);
    const student_id = String(fd.get("student_id")||"").trim();
    const pin = String(fd.get("pin")||"").trim();
    const teacher_pass = String(fd.get("teacher_pass")||"").trim();
    try{
      showAlert("ƒêang ƒëƒÉng nh·∫≠p...");
      const payload = teacher_pass ? {action:"login", teacher_pass} : {action:"login", student_id, pin};
      const data = await postJson(payload);
      if (!data || data.ok!==true) throw new Error(data && data.error ? data.error : "ƒêƒÉng nh·∫≠p th·∫•t b·∫°i");
      localStorage.setItem("gau_auth", JSON.stringify(data));
      try{ renderAuthUI(); }catch(e){}
      showAlert("ƒêƒÉng nh·∫≠p th√†nh c√¥ng! Xin ch√†o " + (data.name || data.student_id), "ok");
      setTimeout(()=>{ closeModal(); }, 800);
    }catch(err){
      showAlert(err.message||String(err));
    }
  });

  formRegister && formRegister.addEventListener("submit", async (e)=>{
    e.preventDefault();
    const fd = new FormData(formRegister);
    const payload = {
      action: "register",
      name: String(fd.get("name")||"").trim(),
      grade: String(fd.get("grade")||"").trim(),
      class: String(fd.get("class")||"").trim(),
      student_id: String(fd.get("student_id")||"").trim(),
      pin: String(fd.get("pin")||"").trim()
    };
    try{
      showAlert("ƒêang t·∫°o t√†i kho·∫£n...");
      const data = await postJson(payload);
      if (!data || data.ok!==true) throw new Error(data && data.error ? data.error : "ƒêƒÉng k√Ω th·∫•t b·∫°i");
      localStorage.setItem("gau_auth", JSON.stringify(data));
      try{ renderAuthUI(); }catch(e){}
      showAlert("T·∫°o t√†i kho·∫£n th√†nh c√¥ng! Xin ch√†o " + (data.name || data.student_id), "ok");
      setTimeout(()=>{ closeModal(); }, 900);
    }catch(err){
      showAlert(err.message||String(err));
    }
  });
})();
</script>


<script>
(function(){
  const AUTH_KEY = "gau_auth";
  const $ = (s)=>document.querySelector(s);
  const authEntry = $("#auth-entry-wrap");
  const accArea = $("#account-area");
  const accName = $("#acc-name");
  const accMeta = $("#acc-meta");
  function readAuth(){
    try { return JSON.parse(localStorage.getItem(AUTH_KEY)||""); } catch(e){ return null; }
  }
  function renderAuthUI(){
    const a = readAuth();
    const logged = a && a.token;
    if(logged){
      authEntry && authEntry.classList.add("hidden");
      accArea && accArea.classList.remove("hidden");
      if (accName) accName.textContent = a.name || a.student_id || "H·ªçc sinh";
      const meta = [a.grade ? ("Kh·ªëi " + a.grade) : "", a.class ? ("L·ªõp " + a.class) : ""].filter(Boolean).join(" ‚Ä¢ ");
      accMeta && (accMeta.textContent = meta);
      // Sync info in modal
      const n1 = document.getElementById("acc-modal-name");
      const m1 = document.getElementById("acc-modal-meta");
      if (n1) n1.textContent = accName.textContent;
      if (m1) m1.textContent = meta;
    } else {
      accArea && accArea.classList.add("hidden");
      authEntry && authEntry.classList.remove("hidden");
    }
  }
  window.renderAuthUI = renderAuthUI;
  // Events
  const btnLogout = $("#acc-logout");
  btnLogout && btnLogout.addEventListener("click", ()=>{
    localStorage.removeItem(AUTH_KEY);
    renderAuthUI();
    alert("ƒê√£ ƒëƒÉng xu·∫•t!");
  });
  const btnSettings = $("#acc-settings");
  btnSettings && btnSettings.addEventListener("click", ()=>{
    const mm = document.getElementById("account-modal");
    mm && mm.classList.remove("hidden");
  });
  ["acc-close","acc-close2"].forEach(id=>{
    const b = document.getElementById(id);
    b && b.addEventListener("click", ()=>{
      document.getElementById("account-modal")?.classList.add("hidden");
    });
  });
  const modalLogout = document.getElementById("acc-modal-logout");
  modalLogout && modalLogout.addEventListener("click", ()=>{
    localStorage.removeItem(AUTH_KEY);
    document.getElementById("account-modal")?.classList.add("hidden");
    renderAuthUI();
    alert("ƒê√£ ƒëƒÉng xu·∫•t!");
  });
  // Initial
  document.addEventListener("DOMContentLoaded", renderAuthUI);
  window.addEventListener("load", renderAuthUI);
})();
</script>

<!-- Account Settings Modal -->
<div id="account-modal" class="fixed inset-0 z-[100] hidden">
  <div class="absolute inset-0 bg-black/40"></div>
  <div class="absolute inset-0 flex items-center justify-center p-4">
    <div class="w-full max-w-md bg-white rounded-2xl shadow-lg overflow-hidden">
      <div class="px-5 py-4 border-b flex items-center justify-between">
        <h3 class="font-bold text-gray-800">C√†i ƒë·∫∑t t√†i kho·∫£n</h3>
        <button id="acc-close" class="text-gray-500 hover:text-gray-700 text-xl leading-none">&times;</button>
      </div>
      <div class="p-5 space-y-4">
        <div class="flex items-center gap-3">
          <img id="acc-modal-avatar" src="data/images/logo-bear-64.png" class="w-10 h-10 rounded-full ring-2 ring-blue-100" alt="avatar">
          <div>
            <div id="acc-modal-name" class="font-semibold">H·ªçc sinh</div>
            <div id="acc-modal-meta" class="text-sm text-gray-600">Kh·ªëi ‚Ä¢ L·ªõp</div>
          </div>
        </div>
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800">
          <b>L∆∞u √Ω:</b> Thay ƒë·ªïi th√¥ng tin v√† ƒë·ªïi PIN s·∫Ω ƒë∆∞·ª£c b·∫≠t ·ªü giai ƒëo·∫°n P2 (backend). Hi·ªán t·∫°i b·∫°n c√≥ th·ªÉ ƒêƒÉng xu·∫•t b√¨nh th∆∞·ªùng.
        </div>
        <div class="grid grid-cols-2 gap-3">
          <button id="acc-change-pin" class="px-4 py-2 rounded-lg bg-gray-200 text-gray-600 cursor-not-allowed">ƒê·ªïi PIN (s·∫Øp b·∫≠t)</button>
          <button id="acc-change-info" class="px-4 py-2 rounded-lg bg-gray-200 text-gray-600 cursor-not-allowed">ƒê·ªïi th√¥ng tin (s·∫Øp b·∫≠t)</button>
        </div>
      </div>
      <div class="px-5 py-4 border-t flex justify-end gap-2">
        <button id="acc-modal-logout" class="px-4 py-2 rounded-lg bg-red-500 text-white">ƒêƒÉng xu·∫•t</button>
        <button id="acc-close2" class="px-4 py-2 rounded-lg bg-gray-200">ƒê√≥ng</button>
      </div>
    </div>
  </div>
</div>

<!-- === [AUTH UPGRADE v2.8.0] Account Settings Modal (inserted just before </body>) === -->
<div id="account-modal" class="fixed inset-0 hidden items-center justify-center z-50">
  <div class="absolute inset-0 bg-black/40"></div>
  <div class="relative bg-white rounded-3xl shadow-2xl w-[min(92vw,560px)] p-6">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-xl font-extrabold text-blue-700">C√†i ƒë·∫∑t t√†i kho·∫£n</h3>
      <button id="account-close" class="text-2xl leading-none">√ó</button>
    </div>

    <div class="flex items-center gap-3 mb-4">
      <img id="modal-avatar" class="w-12 h-12 rounded-full ring-2 ring-blue-100" src="data/images/logo-bear-64.png" alt="">
      <div>
        <div id="modal-name" class="font-bold">H·ªçc sinh</div>
        <div id="modal-grade-class" class="text-sm text-gray-600">Kh·ªëi ‚Ä¢ L·ªõp</div>
      </div>
    </div>

    <div class="space-y-3">
      <!-- PIN change button remains -->
      <button id="btnChangePin" class="w-full px-4 py-2 rounded-xl bg-white border">ƒê·ªïi PIN</button>

      <!-- Personal information form -->
      <div class="border-t pt-3 space-y-2">
        <label class="text-sm text-gray-600">C·∫≠p nh·∫≠t th√¥ng tin</label>
        <input type="text" id="inputName" class="w-full border rounded-xl p-3" placeholder="T√™n hi·ªÉn th·ªã">
        <div class="grid grid-cols-2 gap-3">
          <input type="text" id="inputGrade" class="border rounded-xl p-3" placeholder="Kh·ªëi (3/4/5)">
          <input type="text" id="inputClass" class="border rounded-xl p-3" placeholder="L·ªõp (vd: 5A)">
        </div>
        <button id="btnSaveInfo" class="w-full px-3 py-2 rounded-xl bg-blue-600 text-white">L∆∞u th√¥ng tin</button>
      </div>

      <!-- Avatar selection section -->
      <div class="border-t pt-3" id="avatar-select-section">
        <label class="text-sm text-gray-600">Ch·ªçn ·∫£nh ƒë·∫°i di·ªán</label>
        <!-- Grid of built‚Äëin avatars; populated by JS -->
        <div id="avatar-icon-grid" class="grid grid-cols-4 gap-3 mt-2"></div>
        <div class="mt-3">
          <button id="btnSaveAvatar" class="px-3 py-2 rounded-xl bg-blue-600 text-white">L∆∞u ·∫£nh ƒë·∫°i di·ªán</button>
        </div>
        <!-- Preview for the currently selected avatar -->
        <img id="avatarPreview" class="mt-3 w-16 h-16 rounded-full ring-2 ring-blue-100" src="data/images/logo-bear-64.png" alt="">
      </div>
    </div>

    <div class="mt-5 flex justify-end">
      <button id="account-close-2" class="px-4 py-2 rounded-xl bg-gray-100">ƒê√≥ng</button>
    </div>
  </div>
</div>


<!-- === [AUTH UPGRADE v2.8.0] Auth wiring appended before </body> (no existing IDs changed) === -->
<!-- Toast message for success notifications -->
<div id="success-toast" class="hidden fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-xl shadow-lg flex items-center gap-2 z-50">
  <span class="text-xl">‚úì</span>
  <span id="success-toast-msg"></span>
</div>

<!-- P2 Leaderboard Modal Overlay (hidden by default) -->
<div id="p2-lb-overlay" class="hidden fixed inset-0 z-50 items-center justify-center flex">
  <!-- backdrop -->
  <div class="absolute inset-0 bg-black/50"></div>
  <!-- modal -->
  <div class="relative bg-white rounded-2xl shadow-2xl p-6 max-w-3xl w-[92vw] max-h-[90vh] overflow-y-auto">
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center gap-2">
        <span class="text-3xl">üèÜ</span>
        <h3 class="text-xl font-extrabold text-blue-700">B·∫£ng x·∫øp h·∫°ng</h3>
      </div>
      <button id="p2-lb-close" class="text-3xl leading-none hover:text-red-500">&times;</button>
    </div>
    <!-- My Stats section -->
    <div id="p2-my-stats" class="mb-5">
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
        <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-xl text-center">
          <div class="text-sm text-gray-600 mb-1">ƒêi·ªÉm h√¥m nay</div>
          <div class="relative h-3 bg-yellow-100 rounded-full overflow-hidden">
            <div id="p2-lb-progress-bar" class="absolute top-0 left-0 h-full bg-yellow-400 rounded-full" style="width:0%"></div>
          </div>
          <div id="p2-lb-progress-text" class="text-xs mt-1">0 / 0</div>
        </div>
        <div class="p-3 bg-green-50 border border-green-200 rounded-xl text-center">
          <div class="text-sm text-gray-600 mb-1">ƒêi·ªÉm cao nh·∫•t</div>
          <div id="p2-lb-best-score" class="text-lg font-bold">‚Äî</div>
          <div id="p2-lb-best-quiz" class="text-xs text-gray-500">‚Äî</div>
        </div>
        <div class="p-3 bg-blue-50 border border-blue-200 rounded-xl text-center">
          <div class="text-sm text-gray-600 mb-1">Th·ªùi gian t·ªët nh·∫•t</div>
          <div id="p2-lb-best-time" class="text-lg font-bold">‚Äî</div>
          <div class="text-xs text-gray-500">ms</div>
        </div>
      </div>
    </div>
    <!-- Tabs for scopes -->
    <div class="flex mb-3">
      <button class="p2-lb-tab px-4 py-1 text-sm font-medium rounded-full mr-2 bg-blue-600 text-white" data-scope="daily">H√¥m nay</button>
      <button class="p2-lb-tab px-4 py-1 text-sm font-medium rounded-full mr-2 bg-gray-200 text-gray-700" data-scope="weekly">Tu·∫ßn n√†y</button>
      <button class="p2-lb-tab px-4 py-1 text-sm font-medium rounded-full bg-gray-200 text-gray-700" data-scope="all">All-time</button>
    </div>
    <!-- Leaderboard table -->
    <div class="overflow-auto">
      <table class="min-w-full text-sm">
        <thead class="sticky top-0 bg-white">
          <tr class="border-b">
            <th class="px-2 py-2">H·∫°ng</th>
            <th class="px-2 py-2">H·ªç & t√™n</th>
            <th class="px-2 py-2">L·ªõp</th>
            <th class="px-2 py-2">ƒêi·ªÉm</th>
            <th class="px-2 py-2">Th·ªùi gian</th>
          </tr>
        </thead>
        <tbody id="p2-lb-list">
          <tr><td colspan="5" class="text-center p-3 text-gray-500">ƒêang t·∫£i‚Ä¶</td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

    <!-- scoreboard script: defines functions for leaderboard & my stats and binds events -->
    <script>
      // scoreboard module executed after DOM is ready
      document.addEventListener('DOMContentLoaded', () => {
        const lbOverlay = document.getElementById('p2-lb-overlay');
        if(!lbOverlay) return;
        // helper: call whoami via existing apiPost
        async function p2Whoami(){
          const auth = getAuth();
          if(!auth || !auth.token) return null;
          try{
            const r = await apiPost('whoami', { token: auth.token });
            return (r && r.ok) ? r : null;
          }catch(e){ return null; }
        }
        // load my stats: progress bar, best score, best time
        async function p2LoadMyStats(){
          const me = await p2Whoami();
          const progBar  = document.getElementById('p2-lb-progress-bar');
          const progText = document.getElementById('p2-lb-progress-text');
          const bestScoreEl = document.getElementById('p2-lb-best-score');
          const bestQuizEl  = document.getElementById('p2-lb-best-quiz');
          const bestTimeEl  = document.getElementById('p2-lb-best-time');
          if(!me){
            if(progBar) progBar.style.width = '0%';
            if(progText) progText.textContent = '0 / 0';
            if(bestScoreEl) bestScoreEl.textContent = '‚Äî';
            if(bestQuizEl) bestQuizEl.textContent = '‚Äî';
            if(bestTimeEl) bestTimeEl.textContent = '‚Äî';
            return;
          }
          let today = 0; let bestScore = '‚Äî', bestQuiz = '‚Äî', bestTime = '‚Äî';
          const token = me.token;
          // fetch daily leaderboard to get today's points
          try{
            const daily = await apiPost('leaderboard', { token, scope:'daily', limit:50 });
            const rows = daily.rows || daily.data || daily.items || [];
            const mine = rows.find(r => r.student_id === me.student_id);
            if(mine) today = Number(mine.points || mine.score || mine.best_score_final || 0);
          }catch(e){}
          // fetch all-time leaderboard to get best-of
          try{
            const all = await apiPost('leaderboard', { token, scope:'all', limit:50 });
            const rows = all.rows || all.data || all.items || [];
            const mine = rows.find(r => r.student_id === me.student_id);
            if(mine){
              bestScore = mine.best_score_final || mine.score || mine.points || '‚Äî';
              bestTime  = mine.best_duration_ms || mine.duration_ms || '‚Äî';
              bestQuiz  = mine.quiz_id || mine.best_quiz_id || '‚Äî';
            }
          }catch(e){}
          // progress bar
          if(progBar){
            // determine daily cap per grade; fallback to grade 4
            const capMap = { '3': 200, '4': 250, '5': 300 };
            const cap = capMap[String(me.grade) || ''] || capMap['4'];
            const pct = cap ? Math.min(100, Math.round((today / cap) * 100)) : 0;
            progBar.style.width = pct + '%';
            if(progText) progText.textContent = `${today} / ${cap}`;
          }
          if(bestScoreEl) bestScoreEl.textContent = bestScore;
          if(bestQuizEl) bestQuizEl.textContent  = bestQuiz;
          if(bestTimeEl) bestTimeEl.textContent  = bestTime;
        }
        // load leaderboard for given scope
        async function p2LoadLeaderboard(scope){
          // Use the table body with id 'p2-lb-list' (defined in markup)
          const tbody = document.getElementById('p2-lb-list');
          if(!tbody) return;
          tbody.innerHTML = '<tr><td colspan="5" class="text-center p-3 text-gray-500">ƒêang t·∫£i‚Ä¶</td></tr>';
          const me = await p2Whoami();
          const token = me?.token || null;
          try{
            const res = await apiPost('leaderboard', { token, scope, limit:50 });
            const rows = res.rows || res.data || res.items || [];
            if(!rows.length){
              tbody.innerHTML = '<tr><td colspan="5" class="text-center p-3 text-gray-500">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>';
              return;
            }
            let html = '';
            rows.forEach((row, idx) => {
              const rank = idx + 1;
              let rankDisplay;
              if(rank === 1) rankDisplay = '<span class="p2-trophy">ü•á</span>';
              else if(rank === 2) rankDisplay = '<span class="p2-trophy">ü•à</span>';
              else if(rank === 3) rankDisplay = '<span class="p2-trophy">ü•â</span>';
              else rankDisplay = rank;
              const name = row.name || row.student_name || '‚Äî';
              const cls  = row.class || row.cls || row.grade_class || '‚Äî';
              const pts  = row.points || row.score || row.best_score_final || 0;
              const time = row.best_duration_ms || row.duration_ms || '‚Äî';
              const classes = [];
              if(me && row.student_id === me.student_id) classes.push('p2-lb-row-me');
              if(rank === 1) classes.push('p2-lb-row-top1');
              else if(rank === 2) classes.push('p2-lb-row-top2');
              else if(rank === 3) classes.push('p2-lb-row-top3');
              html += `<tr class="${classes.join(' ')}"><td class="px-2 py-1">${rankDisplay}</td><td class="px-2 py-1">${name}</td><td class="px-2 py-1">${cls}</td><td class="px-2 py-1 font-bold">${pts}</td><td class="px-2 py-1">${time}</td></tr>`;
            });
            tbody.innerHTML = html;
          }catch(err){
            tbody.innerHTML = '<tr><td colspan="5" class="text-center p-3 text-red-500">L·ªói t·∫£i BXH</td></tr>';
          }
        }
        // define global function to open leaderboard
        window.p2ShowLeaderboard = function(){
          lbOverlay.classList.remove('hidden');
          // activate daily tab
          const tabs = document.querySelectorAll('.p2-lb-tab');
          tabs.forEach(tab => {
            const scope = tab.getAttribute('data-scope');
            tab.classList.toggle('p2-lb-tab-active', scope === 'daily');
            tab.classList.toggle('p2-lb-tab-inactive', scope !== 'daily');
          });
          p2LoadMyStats();
          p2LoadLeaderboard('daily');
        };
        // close overlay
        const closeBtn = document.getElementById('p2-lb-close');
        if(closeBtn) closeBtn.addEventListener('click', () => lbOverlay.classList.add('hidden'));
        // handle tab clicks
        const tabs = document.querySelectorAll('.p2-lb-tab');
        tabs.forEach(tab => {
          tab.addEventListener('click', () => {
            const scope = tab.getAttribute('data-scope');
            tabs.forEach(t => {
              t.classList.remove('p2-lb-tab-active');
              t.classList.add('p2-lb-tab-inactive');
            });
            tab.classList.add('p2-lb-tab-active');
            tab.classList.remove('p2-lb-tab-inactive');
            p2LoadLeaderboard(scope);
          });
        });
      });
    </script>

<!-- Scoped styles for the leaderboard & stats modal -->
<style id="p2-lb-styles">
  /* Tab states */
  .p2-lb-tab {
    cursor: pointer;
    transition: background-color 0.2s, color 0.2s;
  }
  .p2-lb-tab-active {
    background-color: #2563eb; /* blue-600 */
    color: #ffffff;
  }
  .p2-lb-tab-inactive {
    background-color: #e5e7eb; /* gray-200 */
    color: #374151; /* gray-700 */
  }
  /* Highlight current user's row */
  .p2-lb-row-me {
    background-color: #DCFCE7; /* light green */
  }
  /* Highlight top ranks with playful pastel colors */
  .p2-lb-row-top1 {
    background-color: #FEF3C7; /* gold-ish */
  }
  .p2-lb-row-top2 {
    background-color: #F3F4F6; /* silver-ish (light gray) */
  }
  .p2-lb-row-top3 {
    background-color: #F3E8FF; /* bronze-ish (light purple) */
  }
  /* Trophy column width */
  .p2-trophy {
    font-size: 1.4rem;
    display: inline-block;
    width: 1.6rem;
  }
</style>
  <!-- Override and rebind leaderboard JS to avoid init errors -->
<script>
    // Custom leaderboard handler: run after full page load to ensure apiPost & helpers are defined
    window.addEventListener('load', function(){
      // Disabled legacy leaderboard script to avoid conflicts. The new leaderboard logic is defined elsewhere.
      return;
      // daily caps based on grade; adjust if needed
      const DAILY_CAPS = { '3': 200, '4': 250, '5': 300 };
      let meCache = null;

      // Helper to call backend (reuse global apiPost & getAuth)
      async function whoami(){
        const auth = (typeof getAuth === 'function') ? getAuth() : null;
        if(!auth || !auth.token) return null;
        try {
          const r = await apiPost('whoami', { token: auth.token });
          return (r && r.ok) ? r : null;
        }catch(e){ return null; }
      }

      async function loadMyStats(){
        const bar  = document.getElementById('p2-lb-progress-bar');
        const txt  = document.getElementById('p2-lb-progress-text');
        const bestScoreEl = document.getElementById('p2-lb-best-score');
        const bestQuizEl  = document.getElementById('p2-lb-best-quiz');
        const bestTimeEl  = document.getElementById('p2-lb-best-time');
        // reset
        if(bar) bar.style.width = '0%';
        if(txt) txt.textContent = '0 / 0';
        if(bestScoreEl) bestScoreEl.textContent = '‚Äî';
        if(bestQuizEl)  bestQuizEl.textContent  = '‚Äî';
        if(bestTimeEl)  bestTimeEl.textContent  = '‚Äî';
        if(!meCache || !meCache.student_id) return;
        const token = meCache.token;
        const grade = meCache.grade || '';
        const cap   = DAILY_CAPS[grade] || 0;
        let todayPts = 0;
        // fetch daily leaderboard to get current points
        try{
          const r = await apiPost('leaderboard', { token, scope:'daily', limit: 50 });
          const rows = r && r.rows ? r.rows : [];
          const found = rows.find(x => x.student_id === meCache.student_id);
          if(found){ todayPts = Number(found.points || found.score || 0); }
        }catch(err){}
        if(cap > 0){ const pct = Math.max(0, Math.min(100, Math.round((todayPts/cap)*100))); bar.style.width = pct + '%'; txt.textContent = `${todayPts} / ${cap}`; }
        else { txt.textContent = `${todayPts}`; bar.style.width = '0%'; }
        // best-of via all-time
        let totalPts = 0;
        try{
          const r = await apiPost('leaderboard', { token, scope:'all', limit: 50 });
          const rows = r && r.rows ? r.rows : [];
          const found = rows.find(x => x.student_id === meCache.student_id);
          if(found){ totalPts = Number(found.points || found.score || 0); }
        }catch(err){}
        if(bestScoreEl) bestScoreEl.textContent = totalPts;
      }

      async function loadLeaderboard(scope){
        const tbody = document.getElementById('p2-lb-list');
        if(!tbody) return;
        tbody.innerHTML = '<tr><td colspan="5" class="text-center p-3 text-gray-500">ƒêang t·∫£i‚Ä¶</td></tr>';
        const auth = (typeof getAuth === 'function') ? getAuth() : null;
        const token = auth && auth.token ? auth.token : null;
        try{
          const r = await apiPost('leaderboard', { token, scope, limit: 50 });
          const rows = (r && r.rows) ? r.rows : [];
          if(!rows.length){ tbody.innerHTML = '<tr><td colspan="5" class="text-center p-3 text-gray-500">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>'; return; }
          let html='';
          rows.forEach((row, idx) => {
            const rank = idx+1;
            let rankDisplay;
            if(rank===1) rankDisplay='<span class="p2-trophy">ü•á</span>';
            else if(rank===2) rankDisplay='<span class="p2-trophy">ü•à</span>';
            else if(rank===3) rankDisplay='<span class="p2-trophy">ü•â</span>';
            else rankDisplay = rank;
            const name = row.name || row.student_name || '‚Äî';
            const cls  = row.class || row.cls || row.grade_class || '‚Äî';
            const pts  = row.points || row.score || row.best_score_final || 0;
            const time = row.best_duration_ms || row.duration_ms || '‚Äî';
            const classes = [];
            if(meCache && row.student_id === meCache.student_id) classes.push('p2-lb-row-me');
            if(rank===1) classes.push('p2-lb-row-top1');
            else if(rank===2) classes.push('p2-lb-row-top2');
            else if(rank===3) classes.push('p2-lb-row-top3');
            html += `<tr class="${classes.join(' ')}"><td class="px-2 py-1">${rankDisplay}</td><td class="px-2 py-1">${name}</td><td class="px-2 py-1">${cls}</td><td class="px-2 py-1 font-bold">${pts}</td><td class="px-2 py-1">${time}</td></tr>`;
          });
          tbody.innerHTML = html;
        }catch(err){ tbody.innerHTML = '<tr><td colspan="5" class="text-center p-3 text-red-500">L·ªói t·∫£i BXH</td></tr>'; }
      }

      async function initLeaderboard(){
        meCache = await whoami();
        await loadMyStats();
        await loadLeaderboard('daily');
      }

      // Expose global function
      window.p2ShowLeaderboard = function(){
        const overlay = document.getElementById('p2-lb-overlay');
        if(!overlay) return;
        overlay.classList.remove('hidden');
        // activate daily tab
        const tabs = document.querySelectorAll('.p2-lb-tab');
        tabs.forEach(tab => {
          const scope = tab.getAttribute('data-scope');
          tab.classList.toggle('p2-lb-tab-active', scope === 'daily');
        });
        initLeaderboard();
      };

      // Add close & tab listeners after DOM content loaded
      document.addEventListener('DOMContentLoaded', () => {
        const closeBtn = document.getElementById('p2-lb-close');
        if(closeBtn) closeBtn.addEventListener('click', () => {
          const ov = document.getElementById('p2-lb-overlay');
          if(ov) ov.classList.add('hidden');
        });
        const tabs = document.querySelectorAll('.p2-lb-tab');
        tabs.forEach(tab => {
          tab.addEventListener('click', () => {
            const scope = tab.getAttribute('data-scope');
            tabs.forEach(t => t.classList.remove('p2-lb-tab-active'));
            tab.classList.add('p2-lb-tab-active');
            loadLeaderboard(scope);
          });
        });
      });
    });
  </script>
<script>
// 2) Constants & helpers
// Updated API URL to the latest GAS deployment
const AUTH_API = 'https://script.google.com/macros/s/AKfycbyNcfoWBHaKcvvZr7L2i3u62_AhZmC53w-wS1PaW3SULV3-iUMP6kKH-4I7AGjOawO1/exec';  // ‚Üê GAS /exec URL
const AUTH_KEY = "gau_auth";

function getAuth(){ try { return JSON.parse(localStorage.getItem(AUTH_KEY) || "{}"); } catch(e){ return {}; } }
function setAuth(x){ localStorage.setItem(AUTH_KEY, JSON.stringify(x || {})); }
function clearAuth(){ localStorage.removeItem(AUTH_KEY); }

async function apiPost(action, payload){
  // Use a plain text content type to avoid CORS preflight issues when
  // sending JSON from a file:// origin. Apps Script accepts JSON
  // encoded bodies even with this header.
  const res = await fetch(AUTH_API, {
    method: 'POST',
    headers: { 'Content-Type': 'text/plain;charset=UTF-8' },
    body: JSON.stringify(Object.assign({ action }, payload || {})),
    mode: 'cors'
  });
  return res.json();
}

// 3) Profile bar show/hide
function renderLoggedInUI(auth){
  // Always read the latest auth from localStorage if not provided
  if (!auth) {
    auth = getAuth() || {};
  }
  const entry = document.getElementById('auth-entry-wrap');
  const bar   = document.getElementById('account-area');
  if(entry) entry.classList.add('hidden');
  if(bar)   bar.classList.remove('hidden');

  // Update display name
  const nameEl = document.getElementById('acc-name');
  if(nameEl) {
    nameEl.textContent = auth.name || 'H·ªçc sinh';
  }
  // Update avatar; prefer proxy URLs with cache-busting, then fallback to normal URL or stored values
  const avatarEl = document.getElementById('acc-avatar');
  if(avatarEl){
    const stored = getAuth() || {};
    // Prefer any custom avatar (emoji or built-in icon) saved locally
    avatarEl.src =
      auth.avatar_custom ||
      auth.avatar_proxy_url_busted ||
      auth.avatar_proxy_url ||
      auth.avatar_url_busted ||
      auth.avatar_url ||
      stored.avatar_custom ||
      stored.avatar_proxy_url_busted ||
      stored.avatar_proxy_url ||
      stored.avatar_url_busted ||
      stored.avatar_url ||
      'data/images/logo-bear-64.png';
  }
  // Update grade/class meta
  const metaEl = document.getElementById('acc-meta');
  if(metaEl){
    const grade = auth.grade ? `Kh·ªëi ${auth.grade}` : 'Kh·ªëi';
    const cls   = auth.class ? `L·ªõp ${auth.class}` : 'L·ªõp';
    metaEl.textContent = `${grade} ‚Ä¢ ${cls}`;
  }
}

function renderLoggedOutUI(){
  const entry = document.getElementById('auth-entry-wrap');
  const bar   = document.getElementById('account-area');
  if(entry) entry.classList.remove('hidden');
  if(bar)   bar.classList.add('hidden');
}

// 4) Bootstrap version
async function bootstrapAuth(){
  const auth = getAuth();
  if(!auth || !auth.token){ renderLoggedOutUI(); return; }

  try{
    const me = await apiPost('whoami', { token: auth.token });
    if(!me || me.ok === false){
      clearAuth();
      renderLoggedOutUI();
      return;
    }
    // Merge server data with local auth while preserving locally stored fields
    const merged = Object.assign({}, auth, me);
    // Prefer proxy avatar URL (cache-busted) from server
    if (me.avatar_proxy_url_busted) {
      merged.avatar_proxy_url = me.avatar_proxy_url_busted;
    } else if (me.avatar_proxy_url) {
      merged.avatar_proxy_url = me.avatar_proxy_url;
    }
    // Fallback to local proxy URL if server doesn't supply
    if (!me.avatar_proxy_url && !me.avatar_proxy_url_busted && auth.avatar_proxy_url) {
      merged.avatar_proxy_url = auth.avatar_proxy_url;
    }
    // Handle normal avatar URL
    if (me.avatar_url_busted) {
      merged.avatar_url = me.avatar_url_busted;
    } else if (me.avatar_url) {
      merged.avatar_url = me.avatar_url;
    }
    // Preserve avatar_url if server does not supply any avatar URL
    if (!me.avatar_url && !me.avatar_url_busted && auth.avatar_url) merged.avatar_url = auth.avatar_url;
    // Preserve name/grade/class if not supplied by server
    if (!me.name && auth.name) merged.name = auth.name;
    if (!me.grade && auth.grade) merged.grade = auth.grade;
    if (!me.class && auth.class) merged.class = auth.class;
    setAuth(merged);
    renderLoggedInUI(merged);
  }catch(e){
    // network issue: fall back to local
    renderLoggedInUI(auth);
  }
}
document.addEventListener('DOMContentLoaded', bootstrapAuth);

// 6) UI events (bind after DOMContentLoaded with null-guards)
document.addEventListener('DOMContentLoaded', () => {
  const btnLogin = document.getElementById('auth-open-btn');
  // Disable the custom prompt-based login handler. We leave the legacy
  // login/register modal intact so users can register and log in as
  // originally implemented in v2.7.4_officail.
  if(false && btnLogin){
    btnLogin.addEventListener('click', async (e) => {
      // Prevent other click listeners on the login button (e.g. the legacy
      // auth modal) from firing. This ensures our prompt-based login
      // handler runs exclusively.
      if(e){
        if(typeof e.stopImmediatePropagation === 'function') e.stopImmediatePropagation();
        if(typeof e.preventDefault === 'function') e.preventDefault();
      }

      // Hide the legacy auth modal (if present) to avoid overlap with the
      // upgraded prompt-based flow. This modal has the id `auth-modal` and
      // would otherwise display a login/register form.
      const legacyAuthModal = document.getElementById('auth-modal');
      if(legacyAuthModal){
        legacyAuthModal.classList.add('hidden');
        legacyAuthModal.classList.remove('flex');
      }
      const student_id = prompt('Nh·∫≠p M√£ ƒë·ªãnh danh (student_id):');
      if(student_id === null) return;
      const pin = prompt('Nh·∫≠p PIN:');
      if(pin === null) return;

      let res;
      try {
        res = await apiPost('login', { student_id, pin });
      } catch(err) {
        // Network or fetch error. Inform the user and gracefully fall back to
        // a local session so the UI can still be explored offline. The
        // fallback record stores the entered student_id and a dummy token.
        alert('Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß. Vui l√≤ng th·ª≠ l·∫°i sau. B·∫°n s·∫Ω ƒë∆∞·ª£c ƒëƒÉng nh·∫≠p t·∫°m th·ªùi.');
        const fallback = { token: '__local__', name: student_id || 'H·ªçc sinh', student_id: student_id || '', grade: '', class: '' };
        setAuth(fallback);
        renderLoggedInUI(fallback);
        hydrateModalHeader(fallback);
        return;
      }
      if(!res || res.ok === false){
        alert(res && res.error ? res.error : 'ƒêƒÉng nh·∫≠p l·ªói');
        return;
      }

      setAuth(res);
      renderLoggedInUI(res);
      hydrateModalHeader(res);
    });
  }

  const btnSettings = document.getElementById('acc-settings');
  const btnLogout   = document.getElementById('acc-logout');
  // Select the upgraded account settings modal (the last occurrence). If
  // multiple elements share the same id, the browser returns the first
  // match by default. We need the last one for the upgraded UI.
  const modalNodes = document.querySelectorAll('#account-modal');
  const modal = modalNodes.length > 0 ? modalNodes[modalNodes.length - 1] : null;

  if(btnSettings && modal){
    btnSettings.addEventListener('click', (e) => {
      // Prevent legacy handlers on the settings button from showing the old modal
      if(e){
        if(typeof e.stopImmediatePropagation === 'function') e.stopImmediatePropagation();
        if(typeof e.preventDefault === 'function') e.preventDefault();
      }
      hydrateModalHeader(getAuth());
      // Hide any legacy account settings modal before showing the upgraded one
      document.querySelectorAll('#account-modal').forEach((el) => {
        if(el !== modal){
          el.classList.add('hidden');
          el.classList.remove('flex');
        }
      });
      modal.classList.remove('hidden');
      modal.classList.add('flex');
    });
  }

  const close1 = document.getElementById('account-close');
  const close2 = document.getElementById('account-close-2');
  [close1, close2].forEach(el=>{
    if(el) el.addEventListener('click', () => {
      if(modal){ modal.classList.add('hidden'); modal.classList.remove('flex'); }
    });
  });

  if(btnLogout){
    btnLogout.addEventListener('click', async (e) => {
      // Prevent legacy handlers from firing on logout by stopping propagation
      if(e){
        if(typeof e.stopImmediatePropagation === 'function') e.stopImmediatePropagation();
        if(typeof e.preventDefault === 'function') e.preventDefault();
      }
      const auth = getAuth();
      if(auth && auth.token){ try { await apiPost('logout', { token: auth.token }); } catch(e){} }
      clearAuth();
      renderLoggedOutUI();
      if(modal){ modal.classList.add('hidden'); modal.classList.remove('flex'); }
    });
  }

  // Change PIN
  const btnChangePin = document.getElementById('btnChangePin');
  if(btnChangePin){
    btnChangePin.addEventListener('click', async () => {
      const auth = getAuth();
      if(!auth.token) return alert('B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p');
      const old_pin = prompt('PIN c≈©:'); if(old_pin === null) return;
      const new_pin = prompt('PIN m·ªõi (>=4):'); if(new_pin === null) return;
      if(!new_pin || new_pin.length < 4) return alert('PIN m·ªõi t·ªëi thi·ªÉu 4 k√Ω t·ª±');

      let r;
      try {
        r = await apiPost('change_pin', { token: auth.token, old_pin, new_pin });
      } catch(err) {
        alert('Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß. Vui l√≤ng th·ª≠ l·∫°i sau.');
        return;
      }
      if(!r || r.ok === false) return alert(r && r.error ? r.error : 'L·ªói ƒë·ªïi PIN');
      alert('ƒê·ªïi PIN th√†nh c√¥ng!');
    });
  }

  // Save updated profile information via form inputs
  const btnSaveInfo = document.getElementById('btnSaveInfo');
  if (btnSaveInfo) {
    btnSaveInfo.addEventListener('click', async () => {
      const auth = getAuth();
      if (!auth || !auth.token) {
        alert('B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p');
        return;
      }

      const nameInput  = document.getElementById('inputName');
      const gradeInput = document.getElementById('inputGrade');
      const classInput = document.getElementById('inputClass');
      const name  = nameInput  ? nameInput.value.trim()  : '';
      const grade = gradeInput ? gradeInput.value.trim() : '';
      const cls   = classInput ? classInput.value.trim()  : '';

      // Require at least one field to be non-empty
      if (!name && !grade && !cls) {
        alert('Vui l√≤ng nh·∫≠p √≠t nh·∫•t m·ªôt tr∆∞·ªùng ƒë·ªÉ c·∫≠p nh·∫≠t');
        return;
      }
      // Validate grade if provided
      if (grade && !/^[345]$/.test(grade)) {
        alert('Kh·ªëi ch·ªâ nh·∫≠n 3/4/5');
        return;
      }

      // Build payload only with fields provided
      const payload = { token: auth.token };
      if (name)  payload.name  = name;
      if (grade) payload.grade = grade;
      if (cls)   payload['class'] = cls;

      let r;
      try {
        r = await apiPost('update_profile', payload);
      } catch (err) {
        alert('Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß. Vui l√≤ng th·ª≠ l·∫°i sau.');
        return;
      }
      if (!r || r.ok === false) {
        alert(r && r.error ? r.error : 'L·ªói c·∫≠p nh·∫≠t');
        return;
      }
      // Merge updated fields from response or fallback to the submitted fields
      const updated = Object.assign({}, auth, r.data || payload);
      setAuth(updated);
      renderLoggedInUI(updated);
      hydrateModalHeader(updated);
      // Display a success toast instead of a browser alert
      showSuccessToast('ƒê√£ c·∫≠p nh·∫≠t th√¥ng tin!');
    });
  }

  // Upload avatar
  async function handleAvatarUpload() {
    const auth = getAuth() || {};
    if (!auth.token) {
      alert('B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p');
      return;
    }
    const fileInput = document.getElementById('avatarFile');
    const f = fileInput && fileInput.files && fileInput.files[0];
    if (!f) {
      alert('Ch·ªçn ·∫£nh tr∆∞·ªõc ƒë√£');
      return;
    }
    if (f.size > 400000) {
      alert('·∫¢nh l·ªõn > 400KB, vui l√≤ng n√©n nh·ªè h∆°n');
      return;
    }
    // Use a blob URL for instant preview. This avoids potential
    // FileReader or CORS issues when reading large files from
    // file:// origins.
    const blobUrl = URL.createObjectURL(f);
    const previewEl = document.getElementById('avatarPreview');
    const modalAvtEl = document.getElementById('modal-avatar');
    const accAvtEl = document.getElementById('acc-avatar');
    if (previewEl) previewEl.src = blobUrl;
    if (modalAvtEl) modalAvtEl.src = blobUrl;
    if (accAvtEl) accAvtEl.src = blobUrl;
    // Persist temporary local avatar via blob URL. We store this
    // under avatar_url so the UI uses it on page reload. Note: this
    // blob URL is only valid in the current session. If you reload
    // the page, the avatar will fall back to the server URL once
    // uploaded successfully.
    setAuth(Object.assign({}, auth, { avatar_url: blobUrl }));
    renderLoggedInUI(getAuth());
    hydrateModalHeader(getAuth());
    // Convert to base64 for server upload. We wrap this in try/catch
    // so that a failure to read the file doesn't prevent local
    // preview. If conversion fails, we simply abort the upload and
    // leave the preview as-is.
    let dataUrl;
    try {
      dataUrl = await fileToDataURL(f);
    } catch (err) {
      console.warn('Failed to convert file to DataURL', err);
      alert('Kh√¥ng th·ªÉ ƒë·ªçc t·ªáp ·∫£nh. Vui l√≤ng th·ª≠ ·∫£nh kh√°c.');
      return;
    }
    // Attempt to upload to the server. If the request fails (for
    // example due to CORS or missing script properties), we leave
    // the local preview unchanged and show an error. A successful
    // upload returns avatar URLs; we use those to update local
    // storage and reload the UI accordingly.
    let r;
    try {
      r = await apiPost('upload_avatar', { token: auth.token, data_url: dataUrl, file_name: f.name });
    } catch (err) {
      alert('Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß. Vui l√≤ng th·ª≠ l·∫°i sau.');
      return;
    }
    if (!r || r.ok === false) {
      alert(r && r.error ? r.error : 'Upload l·ªói');
      return;
    }
    // Use returned URL for persistent avatar. Prefer proxy (with
    // cache-busting) then normal URL. If none are provided, we keep
    // using the blob URL from above. Note: Apps Script may omit
    // avatar_proxy_url fields if the script properties are missing.
    const url = r.avatar_proxy_url_busted || r.avatar_proxy_url || r.avatar_url_busted || r.avatar_url || blobUrl;
    if (previewEl) previewEl.src = url;
    if (modalAvtEl) modalAvtEl.src = url;
    if (accAvtEl) accAvtEl.src = url;
    // Persist the new avatar URLs and update UI. We store both the
    // proxy and normal URLs when provided so subsequent sessions
    // prefer the server-hosted image instead of the local blob URL.
    const updatedAuth = Object.assign({}, getAuth());
    if (r.avatar_proxy_url_busted) {
      updatedAuth.avatar_proxy_url = r.avatar_proxy_url_busted;
    } else if (r.avatar_proxy_url) {
      updatedAuth.avatar_proxy_url = r.avatar_proxy_url;
    }
    if (r.avatar_url_busted) {
      updatedAuth.avatar_url = r.avatar_url_busted;
    } else if (r.avatar_url) {
      updatedAuth.avatar_url = r.avatar_url;
    } else {
      // Fallback: use blobUrl so UI persists across reloads until
      // another successful upload occurs.
      updatedAuth.avatar_url = blobUrl;
    }
    setAuth(updatedAuth);
    renderLoggedInUI(getAuth());
    hydrateModalHeader(getAuth());
    showSuccessToast('ƒê√£ c·∫≠p nh·∫≠t avatar!');
  }
  // Attach click handler to the upload button. We use the named
  // function so it can be reused for the file input change event as
  // well. If there are multiple elements with id btnUploadAvatar
  // because of legacy modals, we attach to all of them.
  document.querySelectorAll('#btnUploadAvatar').forEach(btn => {
    btn.addEventListener('click', handleAvatarUpload);
  });
  // Also trigger upload automatically when the user selects a file.
  const fileEl = document.getElementById('avatarFile');
  if (fileEl) {
    fileEl.addEventListener('change', () => {
      // Only auto-upload if a file is selected. This also
      // immediately previews the image.
      handleAvatarUpload();
    });
  }
});

// Helpers
function hydrateModalHeader(auth){
  if(!auth) return;
  const name = auth.name || 'H·ªçc sinh';
  const grade = auth.grade ? `Kh·ªëi ${auth.grade}` : 'Kh·ªëi';
  const cls   = auth.class ? `L·ªõp ${auth.class}` : 'L·ªõp';
  if(document.getElementById('modal-name')) document.getElementById('modal-name').textContent = name;
  if(document.getElementById('modal-grade-class')) document.getElementById('modal-grade-class').textContent = `${grade} ‚Ä¢ ${cls}`;
  // Prefer proxy avatar URLs with cache-busting for modal and preview
  // Prefer custom avatar saved locally, then fall back to proxy or URL
  const avt = auth.avatar_custom || auth.avatar_proxy_url_busted || auth.avatar_proxy_url || auth.avatar_url_busted || auth.avatar_url || 'data/images/logo-bear-64.png';
  if(document.getElementById('modal-avatar'))  document.getElementById('modal-avatar').src  = avt;
  if(document.getElementById('avatarPreview')) document.getElementById('avatarPreview').src = avt;

  // Populate input fields for editing profile
  const inputNameEl = document.getElementById('inputName');
  const inputGradeEl = document.getElementById('inputGrade');
  const inputClassEl = document.getElementById('inputClass');
  if(inputNameEl)  inputNameEl.value  = auth.name  || '';
  if(inputGradeEl) inputGradeEl.value = auth.grade || '';
  if(inputClassEl) inputClassEl.value = auth.class || '';
}

// Show a temporary toast notification with a green check and message
function showSuccessToast(message) {
  const toast = document.getElementById('success-toast');
  const msgEl = document.getElementById('success-toast-msg');
  if (!toast || !msgEl) return;
  msgEl.textContent = message || '';
  toast.classList.remove('hidden');
  // Hide after 2 seconds
  setTimeout(() => {
    toast.classList.add('hidden');
  }, 2000);
}

function fileToDataURL(file){
  return new Promise((res, rej) => {
    const fr = new FileReader();
    fr.onload = () => res(fr.result);
    fr.onerror = rej;
    fr.readAsDataURL(file);
  });
}

// ================= Avatar selection (built-in icons) ==================
// Predefined list of emojis for students to choose. Each emoji will be
// rendered into a canvas when saving so it can be uploaded to the server as
// a PNG. Feel free to expand or modify this list for more variety.
const ICON_EMOJIS = [
  'üêª','üê±','üê∂','‚≠ê','‚ù§Ô∏è','üåû','üìö','‚úèÔ∏è','üöÄ','üéà',
  'üß∏','üêº','ü¶ä','ü¶Å','üê∞','üèÄ','üåà','üçÄ','üêß','üêµ'
];

// Convert an image at a given src into a DataURL by drawing it to a canvas.
// This is used when saving the selected avatar to the server. If the image
// fails to load (which shouldn't happen for local file paths), the promise
// will reject.
function dataURLFromImageSrc(src) {
  return new Promise((resolve, reject) => {
    const img = new Image();
    // Setting crossOrigin is not strictly necessary for file:// origins but
    // included for completeness in case the icons are served from http.
    img.crossOrigin = 'anonymous';
    img.onload = function() {
      const canvas = document.createElement('canvas');
      canvas.width  = img.naturalWidth  || img.width;
      canvas.height = img.naturalHeight || img.height;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0);
      resolve(canvas.toDataURL('image/png'));
    };
    img.onerror = reject;
    img.src = src;
  });
}

document.addEventListener('DOMContentLoaded', () => {
  // Populate built-in avatar icons into the grid.
  const grid = document.getElementById('avatar-icon-grid');
  const previewEl = document.getElementById('avatarPreview');
  // Track the currently selected avatar. If an emoji is selected, we store
  // its character and a generated DataURL separately. If a file-based
  // avatar is used (legacy support), selectedIconPath will be non-null.
  let selectedIconPath = null;
  let selectedEmoji = null;
  let selectedEmojiDataUrl = null;
  if (grid) {
    ICON_EMOJIS.forEach((emoji, index) => {
      // Create a container for each emoji so we can style it like an avatar
      const div = document.createElement('div');
      div.classList.add('w-12','h-12','rounded-full','cursor-pointer','border-2','border-transparent','flex','items-center','justify-center','text-2xl','select-none','hover:border-blue-400');
      div.dataset.emoji = emoji;
      div.textContent = emoji;
      div.addEventListener('click', () => {
        // Highlight the selected emoji
        document.querySelectorAll('#avatar-icon-grid div').forEach(el => {
          el.classList.remove('border-blue-500');
        });
        div.classList.add('border-blue-500');
        selectedIconPath = null;
        selectedEmoji = emoji;
        // Generate a preview on the fly by drawing the emoji to a canvas
        const canvas = document.createElement('canvas');
        canvas.width = 128;
        canvas.height = 128;
        const ctx = canvas.getContext('2d');
        ctx.font = '96px sans-serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.clearRect(0,0,128,128);
        ctx.fillText(emoji, 64, 64);
        const dataUrl = canvas.toDataURL('image/png');
        if (previewEl) previewEl.src = dataUrl;
        const modalAvtEl = document.getElementById('modal-avatar');
        const accAvtEl   = document.getElementById('acc-avatar');
        if (modalAvtEl) modalAvtEl.src = dataUrl;
        if (accAvtEl)   accAvtEl.src   = dataUrl;
        // Store the temporary preview DataURL in a variable for later upload
        selectedEmojiDataUrl = dataUrl;
      });
      grid.appendChild(div);
    });
  }
  // Attach handler to the save avatar button.
  const saveBtn = document.getElementById('btnSaveAvatar');
  if (saveBtn) {
    saveBtn.addEventListener('click', async () => {
      const auth = getAuth() || {};
      if (!auth.token) {
        alert('B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p');
        return;
      }
      // Require a selection: either an emoji (with DataURL) or a legacy file path
      if (!selectedEmojiDataUrl && !selectedIconPath) {
        alert('Vui l√≤ng ch·ªçn m·ªôt ·∫£nh ƒë·∫°i di·ªán');
        return;
      }
      // Determine the DataURL and a filename for the avatar. If the user
      // selected an emoji, we use the pre-generated DataURL. If a file-based
      // avatar is selected (for backward compatibility), we read it from disk.
      let dataUrl;
      let fileName;
      if (selectedEmojiDataUrl) {
        dataUrl = selectedEmojiDataUrl;
        fileName = `${selectedEmoji || 'avatar'}.png`;
      } else if (selectedIconPath) {
        try {
          dataUrl = await dataURLFromImageSrc(selectedIconPath);
        } catch (err) {
          alert('Kh√¥ng th·ªÉ ƒë·ªçc ·∫£nh. Vui l√≤ng th·ª≠ l·∫°i.');
          return;
        }
        fileName = selectedIconPath.split('/').pop();
      } else {
        alert('Vui l√≤ng ch·ªçn m·ªôt ·∫£nh ƒë·∫°i di·ªán');
        return;
      }
      // Use the DataURL or path depending on selection. Persist this
      // locally under a custom avatar field so it remains across reloads.
      const url = selectedEmojiDataUrl || selectedIconPath;
      if (previewEl) previewEl.src = url;
      const modalAvtEl = document.getElementById('modal-avatar');
      const accAvtEl   = document.getElementById('acc-avatar');
      if (modalAvtEl) modalAvtEl.src = url;
      if (accAvtEl)   accAvtEl.src   = url;
      const updatedAuth = Object.assign({}, getAuth());
      // Save the custom avatar so it is preferred over any server-provided avatar
      updatedAuth.avatar_custom = url;
      updatedAuth.avatar_url = url;
      // Remove any previous proxy URLs to avoid overriding the custom avatar
      delete updatedAuth.avatar_proxy_url;
      delete updatedAuth.avatar_proxy_url_busted;
      delete updatedAuth.avatar_url_busted;
      setAuth(updatedAuth);
      renderLoggedInUI(getAuth());
      hydrateModalHeader(getAuth());
      showSuccessToast('ƒê√£ c·∫≠p nh·∫≠t avatar!');
    });
  }
});
</script>

</body>
</html>
